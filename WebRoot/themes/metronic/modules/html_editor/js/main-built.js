/**
 * @license AngularJS v1.2.0rc1
 * (c) 2010-2012 Google, Inc. http://angularjs.org
 * License: MIT
 */

//     Underscore.js 1.5.2
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

//  Underscore.string
//  (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
//  Underscore.string is freely distributable under the terms of the MIT license.
//  Documentation: https://github.com/epeli/underscore.string
//  Some code is borrowed from MooTools and Alexandru Marasteanu.
//  Version '2.3.0'

// Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>

!function(window,document,undefined){function minErr(module){return function(){var message,prefix="["+(module?module+":":"")+arguments[0]+"] ",template=arguments[1],templateArgs=arguments;return message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],isFunction(arg)?arg.toString().replace(/ ?\{[\s\S]*$/,""):isUndefined(arg)?"undefined":isString(arg)?arg:toJson(arg)):match}),new Error(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return 1===obj.nodeType&&length?!0:isArray(obj)||!isFunction(obj)&&(0===length||"number"==typeof length&&length>0&&length-1 in obj)}function forEach(obj,iterator,context){var key;if(obj)if(isFunction(obj))for(key in obj)"prototype"!=key&&"length"!=key&&"name"!=key&&obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context);else if(isArrayLike(obj))for(key=0;key<obj.length;key++)iterator.call(context,obj[key],key);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);return obj}function sortedKeys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys.sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){for(var digit,index=uid.length;index;){if(index--,digit=uid[index].charCodeAt(0),57==digit)return uid[index]="A",uid.join("");if(90!=digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){var h=dst.$$hashKey;return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst[key]=value})}),setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!=value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"==toString.apply(value)}function isArray(value){return"[object Array]"==toString.apply(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"==toString.apply(value)}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.apply(obj)}function isElement(node){return node&&(node.nodeName||node.on&&node.find)}function map(obj,iterator,context){var results=[];return forEach(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results}function includes(array,obj){return-1!=indexOf(array,obj)}function indexOf(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1}function arrayRemove(array,value){var index=indexOf(array,value);return index>=0&&array.splice(index,1),value}function copy(source,destination){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)destination.push(copy(source[i]))}else{var h=destination.$$hashKey;forEach(destination,function(value,key){delete destination[key]});for(var key in source)destination[key]=copy(source[key]);setHashKey(destination,h)}}else destination=source,source&&(isArray(source)?destination=copy(source,[]):isDate(source)?destination=new Date(source.getTime()):isRegExp(source)?destination=new RegExp(source.source):isObject(source)&&(destination=copy(source,{})));return destination}function shallowCopy(src,dst){dst=dst||{};for(var key in src)src.hasOwnProperty(key)&&"$$"!==key.substr(0,2)&&(dst[key]=src[key]);return dst}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)&&o1.getTime()==o2.getTime();if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,curryArgs.concat(slice.call(arguments,0))):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return/^\$+/.test(key)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function toBoolean(value){if(value&&0!==value.length){var v=lowercase(""+value);value=!("f"==v||"0"==v||"false"==v||"no"==v||"n"==v||"[]"==v)}else value=!1;return value}function startingTag(element){element=jqLite(element).clone();try{element.html("")}catch(e){}var TEXT_NODE=3,elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===TEXT_NODE?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;obj[key]?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function angularInit(element,bootstrap){function append(element){element&&elements.push(element)}var appElement,module,elements=[element],names=["ng:app","ng-app","x-ng-app","data-ng-app"],NG_APP_CLASS_REGEXP=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;forEach(names,function(name){names[name]=!0,append(document.getElementById(name)),name=name.replace(":","\\:"),element.querySelectorAll&&(forEach(element.querySelectorAll("."+name),append),forEach(element.querySelectorAll("."+name+"\\:"),append),forEach(element.querySelectorAll("["+name+"]"),append))}),forEach(elements,function(element){if(!appElement){var className=" "+element.className+" ",match=NG_APP_CLASS_REGEXP.exec(className);match?(appElement=element,module=(match[2]||"").replace(/\s+/g,",")):forEach(element.attributes,function(attr){!appElement&&names[attr.name]&&(appElement=element,module=attr.value)})}}),appElement&&bootstrap(appElement,module?[module]:[])}function bootstrap(element,modules){var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag)}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),modules.unshift("ng");var injector=createInjector(modules);return injector.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(scope,element,compile,injector,animate){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)}),animate.enabled(!0)}]),injector},NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),void(angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),doBootstrap()}))}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){jQuery=window.jQuery,jQuery?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),JQLitePatchJQueryRemove("remove",!0,!0,!1),JQLitePatchJQueryRemove("empty",!1,!1,!1),JQLitePatchJQueryRemove("html",!1,!1,!0)):jqLite=JQLite,angular.element=jqLite}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}return ensure(ensure(window,"angular",Object),"module",function(){var modules={};return function(name,requires,configFn){return requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod){return function(){return invokeQueue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw minErr("$injector")("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],runBlocks=[],config=invokeLater("$injector","invoke"),moduleInstance={_invokeQueue:invokeQueue,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,$$minErr:minErr,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0}}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCsp:ngCspDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,required:requiredDirective,ngRequired:requiredDirective,ngValue:ngValueDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$urlUtils:$$UrlUtilsProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function JQLitePatchJQueryRemove(name,dispatchThis,filterElems,getterIfNoArguments){function removePatch(param){var set,setIndex,setLength,element,childIndex,childLength,children,list=filterElems&&param?[this.filter(param)]:[this],fireEvent=dispatchThis;if(!getterIfNoArguments||null!=param)for(;list.length;)for(set=list.shift(),setIndex=0,setLength=set.length;setLength>setIndex;setIndex++)for(element=jqLite(set[setIndex]),fireEvent?element.triggerHandler("$destroy"):fireEvent=!fireEvent,childIndex=0,childLength=(children=element.children()).length;childLength>childIndex;childIndex++)list.push(jQuery(children[childIndex]));return originalJqFn.apply(this,arguments)}var originalJqFn=jQuery.fn[name];originalJqFn=originalJqFn.$original||originalJqFn,removePatch.$original=originalJqFn,jQuery.fn[name]=removePatch}function JQLite(element){if(element instanceof JQLite)return element;if(!(this instanceof JQLite)){if(isString(element)&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}if(isString(element)){var div=document.createElement("div");div.innerHTML="<div>&#160;</div>"+element,div.removeChild(div.firstChild),JQLiteAddNodes(this,div.childNodes);var fragment=jqLite(document.createDocumentFragment());fragment.append(this)}else JQLiteAddNodes(this,element)}function JQLiteClone(element){return element.cloneNode(!0)}function JQLiteDealoc(element){JQLiteRemoveData(element);for(var i=0,children=element.childNodes||[];i<children.length;i++)JQLiteDealoc(children[i])}function JQLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var events=JQLiteExpandoStore(element,"events"),handle=JQLiteExpandoStore(element,"handle");handle&&(isUndefined(type)?forEach(events,function(eventHandler,type){removeEventListenerFn(element,type,eventHandler),delete events[type]}):forEach(type.split(" "),function(type){isUndefined(fn)?(removeEventListenerFn(element,type,events[type]),delete events[type]):arrayRemove(events[type]||[],fn)}))}function JQLiteRemoveData(element,name){var expandoId=element[jqName],expandoStore=jqCache[expandoId];if(expandoStore){if(name)return void delete jqCache[expandoId].data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),JQLiteOff(element)),delete jqCache[expandoId],element[jqName]=undefined}}function JQLiteExpandoStore(element,key,value){var expandoId=element[jqName],expandoStore=jqCache[expandoId||-1];return isDefined(value)?(expandoStore||(element[jqName]=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={}),void(expandoStore[key]=value)):expandoStore&&expandoStore[key]}function JQLiteData(element,key,value){var data=JQLiteExpandoStore(element,"data"),isSetter=isDefined(value),keyDefined=!isSetter&&isDefined(key),isSimpleGetter=keyDefined&&!isObject(key);if(data||isSimpleGetter||JQLiteExpandoStore(element,"data",data={}),isSetter)data[key]=value;else{if(!keyDefined)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}function JQLiteHasClass(element,selector){return(" "+element.className+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1}function JQLiteRemoveClass(element,cssClasses){cssClasses&&forEach(cssClasses.split(" "),function(cssClass){element.className=trim((" "+element.className+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," "))})}function JQLiteAddClass(element,cssClasses){cssClasses&&forEach(cssClasses.split(" "),function(cssClass){JQLiteHasClass(element,cssClass)||(element.className=trim(element.className+" "+trim(cssClass)))})}function JQLiteAddNodes(root,elements){if(elements){elements=elements.nodeName||!isDefined(elements.length)||isWindow(elements)?[elements]:elements;for(var i=0;i<elements.length;i++)root.push(elements[i])}}function JQLiteController(element,name){return JQLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function JQLiteInheritedData(element,name,value){for(element=jqLite(element),9==element[0].nodeType&&(element=element.find("html"));element.length;){if((value=element.data(name))!==undefined)return value;element=element.parent()}}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[element.nodeName]&&booleanAttr}function createEventHandler(element,events){var eventHandler=function(event,type){if(event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target||(event.target=event.srcElement||document),isUndefined(event.defaultPrevented)){var prevent=event.preventDefault;event.preventDefault=function(){event.defaultPrevented=!0,prevent.call(event)},event.defaultPrevented=!1}event.isDefaultPrevented=function(){return event.defaultPrevented||0==event.returnValue},forEach(events[type||event.type],function(fn){fn.call(element,event)}),8>=msie?(event.preventDefault=null,event.stopPropagation=null,event.isDefaultPrevented=null):(delete event.preventDefault,delete event.stopPropagation,delete event.isDefaultPrevented)};return eventHandler.elem=element,eventHandler}function hashKey(obj){var key,objType=typeof obj;return"object"==objType&&null!==obj?"function"==typeof(key=obj.$$hashKey)?key=obj.$$hashKey():key===undefined&&(key=obj.$$hashKey=nextUid()):key=obj,objType+":"+key}function HashMap(array){forEach(array,this.put,this)}function annotate(fn){var $inject,fnText,argDecl,last;return"function"==typeof fn?($inject=fn.$inject)||($inject=[],fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})}),fn.$inject=$inject):isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0),$inject}function createInjector(modulesToLoad){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if((isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn){return provider(name,{$get:factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,value){return factory(name,valueFn(value))}function constant(name,value){providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var runBlocks=[];return forEach(modulesToLoad,function(module){if(!loadedModules.get(module)){loadedModules.put(module,!0);try{if(isString(module)){var moduleFn=angularModule(module);runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks);for(var invokeQueue=moduleFn._invokeQueue,i=0,ii=invokeQueue.length;ii>i;i++){var invokeArgs=invokeQueue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}else isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}finally{path.shift()}}function invoke(fn,self,locals){var length,i,key,args=[],$inject=annotate(fn);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key))}switch(fn.$inject||(fn=fn[length]),self?-1:args.length){case 0:return fn();case 1:return fn(args[0]);case 2:return fn(args[0],args[1]);case 3:return fn(args[0],args[1],args[2]);case 4:return fn(args[0],args[1],args[2],args[3]);case 5:return fn(args[0],args[1],args[2],args[3],args[4]);case 6:return fn(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6]);case 8:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);case 9:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8]);case 10:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9]);default:return fn.apply(self,args)}}function instantiate(Type,locals){var instance,returnedValue,Constructor=function(){};return Constructor.prototype=(isArray(Type)?Type[Type.length-1]:Type).prototype,instance=new Constructor,returnedValue=invoke(Type,instance,locals),isObject(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap,providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(){throw $injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return forEach(list,function(element){result||"a"!==lowercase(element.nodeName)||(result=element)}),result}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?elm.scrollIntoView():(elm=getFirstAnchor(document.getElementsByName(hash)))?elm.scrollIntoView():"top"===hash&&$window.scrollTo(0,0):$window.scrollTo(0,0)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(){$rootScope.$evalAsync(scroll)}),scroll}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function fireUrlChange(){lastBrowserUrl!=self.url()&&(lastBrowserUrl=self.url(),forEach(urlChangeListeners,function(listener){listener(self.url())}))}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var lastBrowserUrl=location.href,baseElement=document.find("base"),replacedUrl=null;self.url=function(url,replace){if(url){if(lastBrowserUrl==url)return;return lastBrowserUrl=url,$sniffer.history?replace?history.replaceState(null,"",url):(history.pushState(null,"",url),baseElement.attr("href",baseElement.attr("href"))):replace?(location.replace(url),replacedUrl=url):(location.href=url,replacedUrl=null),self}return replacedUrl||location.href.replace(/%27/g,"'")};var urlChangeListeners=[],urlChangeInit=!1;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",fireUrlChange),$sniffer.hashchange?jqLite(window).on("hashchange",fireUrlChange):self.addPollFn(fireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^https?\:\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)if(cookie=cookieArray[i],index=cookie.indexOf("="),index>0){var name=unescape(cookie.substring(0,index));lastCookies[name]===undefined&&(lastCookies[name]=unescape(cookie.substring(index+1)))}return lastCookies}value===undefined?rawDocument.cookie=escape(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=escape(name)+"="+escape(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){var lruEntry=lruHash[key]||(lruHash[key]={key:key});return refresh(lruEntry),isUndefined(value)?void 0:(key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value)},get:function(key){var lruEntry=lruHash[key];if(lruEntry)return refresh(lruEntry),data[key]},remove:function(key){var lruEntry=lruHash[key];lruEntry&&(lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key],delete data[key],size--)},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")
}]}function $CompileProvider($provide){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|file):/,imgSrcSanitizationWhitelist=/^\s*(https?|ftp|file):|data:image\//,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]*|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"A",directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$$urlUtils","$animate",function($injector,$interpolate,$exceptionHandler,$http,$templateCache,$parse,$controller,$rootScope,$document,$sce,$$urlUtils,$animate){function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){3==node.nodeType&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=node=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective);return function(scope,cloneConnectFn){assertArg(scope,"scope");for(var $linkNode=cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,i=0,ii=$linkNode.length;ii>i;i++){var node=$linkNode[i];(1==node.nodeType||9==node.nodeType)&&$linkNode.eq(i).data("$scope",scope)}return safeAddClass($linkNode,"ng-scope"),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode),$linkNode}}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective){function compositeLinkFn(scope,nodeList,$rootElement,boundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,childTranscludeFn,i,ii,n,stableNodeList=[];for(i=0,ii=nodeList.length;ii>i;i++)stableNodeList.push(nodeList[i]);for(i=0,n=0,ii=linkFns.length;ii>i;n++)node=stableNodeList[n],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(isObject(nodeLinkFn.scope)),jqLite(node).data("$scope",childScope)):childScope=scope,childTranscludeFn=nodeLinkFn.transclude,childTranscludeFn||!boundTranscludeFn&&transcludeFn?nodeLinkFn(childLinkFn,childScope,node,$rootElement,function(transcludeFn){return function(cloneFn){var transcludeScope=scope.$new();return transcludeScope.$$transcluded=!0,transcludeFn(transcludeScope,cloneFn).on("$destroy",bind(transcludeScope,transcludeScope.$destroy))}}(childTranscludeFn||transcludeFn)):nodeLinkFn(childLinkFn,childScope,node,undefined,boundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,boundTranscludeFn)}for(var nodeLinkFn,childLinkFn,directives,attrs,linkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0==i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement):null,childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!nodeList[i].childNodes||!nodeList[i].childNodes.length?null:compileNodes(nodeList[i].childNodes,nodeLinkFn?nodeLinkFn.transclude:transcludeFn),linkFns.push(nodeLinkFn),linkFns.push(childLinkFn),linkFnFound=linkFnFound||nodeLinkFn||childLinkFn;return linkFnFound?compositeLinkFn:null}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case 1:addDirective(directives,directiveNormalize(nodeName_(node).toLowerCase()),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName,attrEndName,index;attr=nAttrs[j],(!msie||msie>=8||attr.specified)&&(name=attr.name,ngAttrName=directiveNormalize(name),NG_ATTR_BINDING.test(ngAttrName)&&(name=ngAttrName.substr(6).toLowerCase()),-1!=(index=ngAttrName.lastIndexOf("Start"))&&index==ngAttrName.length-5&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,attrs[nName]=value=trim(msie&&"href"==name?decodeURIComponent(node.getAttribute(name,2)):attr.value),getBooleanAttrName(node,nName)&&(attrs[nName]=!0),addAttrInterpolateDirective(node,directives,value,nName),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName))}if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case 3:addTextInterpolateDirective(directives,node.nodeValue);break;case 8:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);1==node.nodeType&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,postLinkFns.push(post))}function getControllers(require,$element){var value,retrievalMethod="data",optional=!1;if(isString(require)){for(;"^"==(value=require.charAt(0))||"?"==value;)require=require.substr(1),"^"==value&&(retrievalMethod="inheritedData"),optional=optional||"?"==value;if(value=$element[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(require,$element))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){var attrs,$element,i,ii,linkFn,controller;if(attrs=compileNode===linkNode?templateAttrs:shallowCopy(templateAttrs,new Attributes(jqLite(linkNode),templateAttrs.$attr)),$element=attrs.$$element,newIsolateScopeDirective){var LOCAL_REGEXP=/^\s*([@=&])(\??)\s*(\w*)\s*$/,parentScope=scope.$parent||scope;forEach(newIsolateScopeDirective.scope,function(definition,scopeName){var lastValue,parentGet,parentSet,match=definition.match(LOCAL_REGEXP)||[],attrName=match[3]||scopeName,optional="?"==match[2],mode=match[1];switch(scope.$$isolateBindings[scopeName]=mode+attrName,mode){case"@":attrs.$observe(attrName,function(value){scope[scopeName]=value}),attrs.$$observers[attrName].$$scope=parentScope,attrs[attrName]&&(scope[scopeName]=$interpolate(attrs[attrName])(parentScope));break;case"=":if(optional&&!attrs[attrName])return;parentGet=$parse(attrs[attrName]),parentSet=parentGet.assign||function(){throw lastValue=scope[scopeName]=parentGet(parentScope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=scope[scopeName]=parentGet(parentScope),scope.$watch(function(){var parentValue=parentGet(parentScope);return parentValue!==scope[scopeName]&&(parentValue!==lastValue?lastValue=scope[scopeName]=parentValue:parentSet(parentScope,parentValue=lastValue=scope[scopeName])),parentValue});break;case"&":parentGet=$parse(attrs[attrName]),scope[scopeName]=function(locals){return parentGet(parentScope,locals)};break;default:throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",newIsolateScopeDirective.name,scopeName,definition)}})}for(controllerDirectives&&forEach(controllerDirectives,function(directive){var controllerInstance,locals={$scope:scope,$element:$element,$attrs:attrs,$transclude:boundTranscludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals),$element.data("$"+directive.name+"Controller",controllerInstance),directive.controllerAs&&(locals.$scope[directive.controllerAs]=controllerInstance)}),i=0,ii=preLinkFns.length;ii>i;i++)try{linkFn=preLinkFns[i],linkFn(scope,$element,attrs,linkFn.require&&getControllers(linkFn.require,$element))}catch(e){$exceptionHandler(e,startingTag($element))}for(childLinkFn&&childLinkFn(scope,linkNode.childNodes,undefined,boundTranscludeFn),i=0,ii=postLinkFns.length;ii>i;i++)try{linkFn=postLinkFns[i],linkFn(scope,$element,attrs,linkFn.require&&getControllers(linkFn.require,$element))}catch(e){$exceptionHandler(e,startingTag($element))}}for(var directive,directiveName,$template,transcludeDirective,controllerDirectives,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,preLinkFns=[],postLinkFns=[],newScopeDirective=null,newIsolateScopeDirective=null,templateDirective=null,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(assertNoDuplicate("isolated scope",newIsolateScopeDirective,directive,$compileNode),isObject(directiveValue)&&(safeAddClass($compileNode,"ng-isolate-scope"),newIsolateScopeDirective=directive),safeAddClass($compileNode,"ng-scope"),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,(directiveValue=directive.controller)&&(controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(assertNoDuplicate("transclusion",transcludeDirective,directive,$compileNode),transcludeDirective=directive,terminalPriority=directive.priority,"element"==directiveValue?($template=groupScan(compileNode,attrStart,attrEnd),$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,jqLite(sliceArgs($template)),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name)):($template=jqLite(JQLiteClone(compileNode)).contents(),$compileNode.html(""),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLite("<div>"+trim(directiveValue)+"</div>").contents(),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}};directives=directives.concat(collectDirectives(compileNode,directives.splice(i+1,directives.length-(i+1)),newTemplateAttrs)),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),nodeLinkFn,$compileNode,templateAttrs,jqCollection,childTranscludeFn),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope,nodeLinkFn.transclude=transcludeDirective&&childTranscludeFn,nodeLinkFn}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&(value=src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?$element.attr("style",$element.attr("style")+";"+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,beforeTemplateNodeLinkFn,$compileNode,tAttrs,$rootElement,childTranscludeFn){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{controller:null,templateUrl:null,transclude:null,scope:null,replace:null}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl;return $compileNode.html(""),$http.get($sce.getTrustedResourceUrl(templateUrl),{cache:$templateCache}).success(function(content){var compileNode,tempTemplateAttrs,$template;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLite("<div>"+trim(content)+"</div>").contents(),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode),collectDirectives(compileNode,directives,tempTemplateAttrs),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),controller=linkQueue.shift(),linkNode=$compileNode[0];beforeTemplateLinkNode!==beforeTemplateCompileNode&&(linkNode=JQLiteClone(compileNode),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode)),afterTemplateNodeLinkFn(beforeTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,controller),scope,linkNode,$rootElement,controller)}linkQueue=null}).error(function(response,code,headers,config){throw $compileMinErr("tpload","Failed to load template: {0}",config.url)}),function(ignoreChildLinkFn,scope,node,rootElement,controller){linkQueue?(linkQueue.push(scope),linkQueue.push(node),linkQueue.push(rootElement),linkQueue.push(controller)):afterTemplateNodeLinkFn(function(){beforeTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,controller)},scope,node,rootElement,controller)}}function byPriority(a,b){return b.priority-a.priority}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:valueFn(function(scope,node){var parent=node.parent(),bindings=parent.data("$binding")||[];bindings.push(interpolateFn),safeAddClass(parent.data("$binding",bindings),"ng-binding"),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})})})}function getTrustedContext(node,attrNormalizedName){return"xlinkHref"==attrNormalizedName||"IMG"!=nodeName_(node)&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name){var interpolateFn=$interpolate(value,!0);if(interpolateFn){if("multiple"===name&&"SELECT"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:valueFn(function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");interpolateFn=$interpolate(attr[name],!0,getTrustedContext(node,name)),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(value){attr.$set(name,value)}))})})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1;break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),newNode[jqLite.expando]=firstElementToRemove[jqLite.expando];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}var Attributes=function(element,attr){this.$$element=element,this.$attr=attr||{}};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$set:function(key,value,writeAttr,attrName){function tokenDifference(str1,str2){var values=[],tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}if("class"==key){value=value||"";var current=this.$$element.attr("class")||"";this.$removeClass(tokenDifference(current,value).join(" ")),this.$addClass(tokenDifference(value,current).join(" "))}else{var normalizedVal,nodeName,booleanKey=getBooleanAttrName(this.$$element[0],key);booleanKey&&(this.$$element.prop(key,value),attrName=booleanKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),("A"===nodeName&&"href"===key||"IMG"===nodeName&&"src"===key)&&(!msie||msie>=8)&&(normalizedVal=$$urlUtils.resolve(value),""!==normalizedVal&&("href"===key&&!normalizedVal.match(aHrefSanitizationWhitelist)||"src"===key&&!normalizedVal.match(imgSrcSanitizationWhitelist))&&(this[key]=value="unsafe:"+normalizedVal)),writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value))}var $$observers=this.$$observers;$$observers&&forEach($$observers[key],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers={}),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||fn(attrs[key])}),fn}};var startSymbol=($document[0].createElement("a"),$interpolate.startSymbol()),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function $ControllerProvider(){var controllers={},CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector","$window",function($injector,$window){return function(expression,locals){var instance,match,constructor,identifier;if(isString(expression)&&(match=expression.match(CNTRL_REG),constructor=match[1],identifier=match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||getter($window,constructor,!0),assertArgFn(expression,constructor,!0)),instance=$injector.instantiate(expression,locals),identifier){if(!locals||"object"!=typeof locals.$scope)throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",constructor||expression.name,identifier);locals.$scope[identifier]=instance}return instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function parseHeaders(headers){var key,val,i,parsed={};return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]?parsed[key]+=", "+val:parsed[key]=val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){return headersObj||(headersObj=parseHeaders(headers)),name?headersObj[lowercase(name)]||null:headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,PROTECTION_PREFIX=/^\)\]\}',?\n/,CONTENT_TYPE_APPLICATION_JSON={"Content-Type":"application/json;charset=utf-8"},defaults=this.defaults={transformResponse:[function(data){return isString(data)&&(data=data.replace(PROTECTION_PREFIX,""),JSON_START.test(data)&&JSON_END.test(data)&&(data=fromJson(data,!0))),data}],transformRequest:[function(d){return isObject(d)&&!isFile(d)?toJson(d):d}],headers:{common:{Accept:"application/json, text/plain, */*"},post:CONTENT_TYPE_APPLICATION_JSON,put:CONTENT_TYPE_APPLICATION_JSON,patch:CONTENT_TYPE_APPLICATION_JSON},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},interceptorFactories=this.interceptors=[],responseInterceptorFactories=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector","$$urlUtils",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector,$$urlUtils){function $http(requestConfig){function transformResponse(response){var resp=extend({},response,{data:transformData(response.data,response.headers,config.transformResponse)});return isSuccess(response.status)?resp:$q.reject(resp)}function mergeHeaders(config){function execHeaders(headers){var headerContent;forEach(headers,function(headerFn,header){isFunction(headerFn)&&(headerContent=headerFn(),null!=headerContent?headers[header]=headerContent:delete headers[header])})}var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]),execHeaders(defHeaders),execHeaders(reqHeaders);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return reqHeaders}var config={transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},headers=mergeHeaders(requestConfig);extend(config,requestConfig),config.headers=headers,config.method=uppercase(config.method);var xsrfValue=$$urlUtils.isSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(headers[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue);var serverRequest=function(config){headers=config.headers;var reqData=transformData(config.data,headersGetter(headers),config.transformRequest);return isUndefined(config.data)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData,headers).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString)]):cache.remove(url)),resolvePromise(response,status,headersString),$rootScope.$$phase||$rootScope.$apply()}function resolvePromise(response,status,headers){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config})}function removePendingReq(){var idx=indexOf($http.pendingRequests,config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),(config.cache||defaults.cache)&&config.cache!==!1&&"GET"==config.method&&(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache)if(cachedResp=cache.get(url)){if(cachedResp.then)return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],copy(cachedResp[2])):resolvePromise(cachedResp,200,{})}else cache.put(url,promise);return cachedResp||$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType),promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null!=value&&value!=undefined&&(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),url+(-1==url.indexOf("?")?"?":"&")+parts.join("&")}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),forEach(responseInterceptorFactories,function(interceptorFactory,index){var responseFn=isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory);reversedInterceptors.splice(index,0,{response:function(response){return responseFn($q.when(response))},responseError:function(response){return responseFn($q.reject(response))}})}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put"),$http.defaults=defaults,$http}]}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,XHR,$browser.defer,$window.angular.callbacks,$document[0],$window.location.protocol.replace(":",""))}]}function createHttpBackend($browser,XHR,$browserDefer,callbacks,rawDocument,locationProtocol){function jsonpReq(url,done){var script=rawDocument.createElement("script"),doneWrapper=function(){rawDocument.body.removeChild(script),done&&done()
};return script.type="text/javascript",script.src=url,msie?script.onreadystatechange=function(){/loaded|complete/.test(script.readyState)&&doneWrapper()}:script.onload=script.onerror=doneWrapper,rawDocument.body.appendChild(script),doneWrapper}return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=-1,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString){var protocol=(url.match(SERVER_MATCH)||["",locationProtocol])[1];timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,status="file"==protocol?response?200:404:status,status=1223==status?204:status,callback(status,response,headersString),$browser.$$completeOutstandingRequest(noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),function(){callbacks[callbackId].data?completeRequest(callback,200,callbacks[callbackId].data):completeRequest(callback,status||-2),delete callbacks[callbackId]})}else{var xhr=new XHR;xhr.open(method,url,!0),forEach(headers,function(value,key){value&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(4==xhr.readyState){var responseHeaders=xhr.getAllResponseHeaders(),simpleHeaders=["Cache-Control","Content-Language","Content-Type","Expires","Last-Modified","Pragma"];responseHeaders||(responseHeaders="",forEach(simpleHeaders,function(header){var value=xhr.getResponseHeader(header);value&&(responseHeaders+=header+": "+value+"\n")})),completeRequest(callback,status||xhr.status,xhr.responseType?xhr.response:xhr.responseText,responseHeaders)}},withCredentials&&(xhr.withCredentials=!0),responseType&&(xhr.responseType=responseType),xhr.send(post||"")}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else timeout&&timeout.then&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function $interpolate(text,mustHaveExpression,trustedContext){for(var startIndex,endIndex,fn,exp,index=0,parts=[],length=text.length,hasInterpolation=!1,concat=[];length>index;)-1!=(startIndex=text.indexOf(startSymbol,index))&&-1!=(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))?(index!=startIndex&&parts.push(text.substring(index,startIndex)),parts.push(fn=$parse(exp=text.substring(startIndex+startSymbolLength,endIndex))),fn.exp=exp,index=endIndex+endSymbolLength,hasInterpolation=!0):(index!=length&&parts.push(text.substring(index)),index=length);if((length=parts.length)||(parts.push(""),length=1),trustedContext&&parts.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);return!mustHaveExpression||hasInterpolation?(concat.length=length,fn=function(context){try{for(var part,i=0,ii=length;ii>i;i++)"function"==typeof(part=parts[i])&&(part=part(context),part=trustedContext?$sce.getTrusted(trustedContext,part):$sce.valueOf(part),null==part||part==undefined?part="":"string"!=typeof part&&(part=toJson(part))),concat[i]=part;return concat.join("")}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}},fn.exp=text,fn.parts=parts,fn):void 0}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length;return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function matchUrl(url,obj){var match=SERVER_MATCH.exec(url);obj.$$protocol=match[1],obj.$$host=match[3],obj.$$port=int(match[5])||DEFAULT_PORTS[match[1]]||null}function matchAppUrl(url,obj){var match=PATH_MATCH.exec(url);obj.$$path=decodeURIComponent(match[1]),obj.$$search=parseKeyValue(match[3]),obj.$$hash=decodeURIComponent(match[5]||""),obj.$$path&&"/"!=obj.$$path.charAt(0)&&(obj.$$path="/"+obj.$$path)}function beginsWith(begin,whole,otherwise){return 0==whole.indexOf(begin)?whole.substr(begin.length):otherwise}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);this.$$parse=function(url){var parsed={};matchUrl(url,parsed);var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);matchAppUrl(pathUrl,parsed),extend(this,parsed),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$rewrite=function(url){var appUrl,prevAppUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?appBaseNoFile+appUrl:appBaseNoFile==url+"/"?appBaseNoFile:void 0}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);matchUrl(appBase,this),this.$$parse=function(url){var withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url),withoutHashUrl="#"==withoutBaseUrl.charAt(0)?beginsWith(hashPrefix,withoutBaseUrl):this.$$html5?withoutBaseUrl:"";if(!isString(withoutHashUrl))throw $locationMinErr("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',url,hashPrefix);matchAppUrl(withoutHashUrl,this),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$rewrite=function(url){return stripHash(appBase)==stripHash(url)?url:void 0}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$rewrite=function(url){var appUrl;return appBase==stripHash(url)?url:(appUrl=beginsWith(appBaseNoFile,url))?appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"?appBaseNoFile:void 0}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode=!1;this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isDefined(mode)?(html5Mode=mode,this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function afterLocationChange(oldUrl){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();html5Mode?(appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url):(appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl),$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parse($location.$$rewrite(initialUrl)),$rootElement.on("click",function(event){if(!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==lowercase(elm[0].nodeName);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),rewrittenUrl=$location.$$rewrite(absHref);absHref&&!elm.attr("target")&&rewrittenUrl&&!event.isDefaultPrevented()&&(event.preventDefault(),rewrittenUrl!=$browser.url()&&($location.$$parse(rewrittenUrl),$rootScope.$apply(),window.angular["ff-684208-preventDefault"]=!0))}}),$location.absUrl()!=initialUrl&&$browser.url($location.absUrl(),!0),$browser.onUrlChange(function(newUrl){if($location.absUrl()!=newUrl){if($rootScope.$broadcast("$locationChangeStart",newUrl,$location.absUrl()).defaultPrevented)return void $browser.url($location.absUrl());$rootScope.$evalAsync(function(){var oldUrl=$location.absUrl();$location.$$parse(newUrl),afterLocationChange(oldUrl)}),$rootScope.$$phase||$rootScope.$digest()}});var changeCounter=0;return $rootScope.$watch(function(){var oldUrl=$browser.url(),currentReplace=$location.$$replace;return changeCounter&&oldUrl==$location.absUrl()||(changeCounter++,$rootScope.$evalAsync(function(){$rootScope.$broadcast("$locationChangeStart",$location.absUrl(),oldUrl).defaultPrevented?$location.$$parse(oldUrl):($browser.url($location.absUrl(),currentReplace),afterLocationChange(oldUrl))})),$location.$$replace=!1,changeCounter}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop;return logFn.apply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("constructor"===name)throw $parseMinErr("isecfld",'Referencing "constructor" field in Angular expressions is disallowed! Expression: {0}',fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj&&obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);return obj}function lex(text,csp){function is(chars){return-1!=chars.indexOf(ch)}function was(chars){return-1!=chars.indexOf(lastCh)}function peek(i){var num=i||1;return index+num<text.length?text.charAt(index+num):!1}function isNumber(ch){return ch>="0"&&"9">=ch}function isWhitespace(ch){return" "==ch||"\r"==ch||"	"==ch||"\n"==ch||""==ch||" "==ch}function isIdent(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"==ch||"$"==ch}function isExpOperator(ch){return"-"==ch||"+"==ch||isNumber(ch)}function throwError(error,start,end){end=end||index;var colStr=isDefined(start)?"s "+start+"-"+index+" ["+text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,text)}function readNumber(){for(var number="",start=index;index<text.length;){var ch=lowercase(text.charAt(index));if("."==ch||isNumber(ch))number+=ch;else{var peekCh=peek();if("e"==ch&&isExpOperator(peekCh))number+=ch;else if(isExpOperator(ch)&&peekCh&&isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!isExpOperator(ch)||peekCh&&isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;throwError("Invalid exponent")}}index++}number=1*number,tokens.push({index:start,text:number,json:!0,fn:function(){return number}})}function readIdent(){for(var lastDot,peekIndex,methodName,ch,ident="",start=index;index<text.length&&(ch=text.charAt(index),"."==ch||isIdent(ch)||isNumber(ch));)"."==ch&&(lastDot=index),ident+=ch,index++;if(lastDot)for(peekIndex=index;peekIndex<text.length;){if(ch=text.charAt(peekIndex),"("==ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),index=peekIndex;break}if(!isWhitespace(ch))break;peekIndex++}var token={index:start,text:ident};if(OPERATORS.hasOwnProperty(ident))token.fn=token.json=OPERATORS[ident];else{var getter=getterFn(ident,csp,text);token.fn=extend(function(self,locals){return getter(self,locals)},{assign:function(self,value){return setter(self,ident,value,text)}})}tokens.push(token),methodName&&(tokens.push({index:lastDot,text:".",json:!1}),tokens.push({index:lastDot+1,text:methodName,json:!1}))}function readString(quote){var start=index;index++;for(var string="",rawString=quote,escape=!1;index<text.length;){var ch=text.charAt(index);if(rawString+=ch,escape){if("u"==ch){var hex=text.substring(index+1,index+5);hex.match(/[\da-f]{4}/i)||throwError("Invalid unicode escape [\\u"+hex+"]"),index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep?rep:ch}escape=!1}else if("\\"==ch)escape=!0;else{if(ch==quote)return index++,void tokens.push({index:start,text:rawString,string:string,json:!0,fn:function(){return string}});string+=ch}index++}throwError("Unterminated quote",start)}for(var token,ch,tokens=[],index=0,json=[],lastCh=":";index<text.length;){if(ch=text.charAt(index),is("\"'"))readString(ch);else if(isNumber(ch)||is(".")&&isNumber(peek()))readNumber();else if(isIdent(ch))readIdent(),was("{,")&&"{"==json[0]&&(token=tokens[tokens.length-1])&&(token.json=-1==token.text.indexOf("."));else if(is("(){}[].,;:?"))tokens.push({index:index,text:ch,json:was(":[,")&&is("{[")||is("}]:,")}),is("{[")&&json.unshift(ch),is("}]")&&json.shift(),index++;else{if(isWhitespace(ch)){index++;continue}var ch2=ch+peek(),ch3=ch2+peek(2),fn=OPERATORS[ch],fn2=OPERATORS[ch2],fn3=OPERATORS[ch3];fn3?(tokens.push({index:index,text:ch3,fn:fn3}),index+=3):fn2?(tokens.push({index:index,text:ch2,fn:fn2}),index+=2):fn?(tokens.push({index:index,text:ch,fn:fn,json:was("[,:")&&is("+-")}),index+=1):throwError("Unexpected next character ",index,index+1)}lastCh=ch}return tokens}function parser(text,json,$filter,csp){function throwError(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,text,text.substring(token.index))}function peekToken(){if(0===tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",text);return tokens[0]}function peek(e1,e2,e3,e4){if(tokens.length>0){var token=tokens[0],t=token.text;if(t==e1||t==e2||t==e3||t==e4||!e1&&!e2&&!e3&&!e4)return token}return!1}function expect(e1,e2,e3,e4){var token=peek(e1,e2,e3,e4);return token?(json&&!token.json&&throwError("is not valid json",token),tokens.shift(),token):!1}function consume(e1){expect(e1)||throwError("is unexpected, expecting ["+e1+"]",peek())}function unaryFn(fn,right){return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant})}function ternaryFn(left,middle,right){return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})}function binaryFn(left,fn,right){return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant})}function statements(){for(var statements=[];;)if(tokens.length>0&&!peek("}",")",";","]")&&statements.push(filterChain()),!expect(";"))return 1==statements.length?statements[0]:function(self,locals){for(var value,i=0;i<statements.length;i++){var statement=statements[i];statement&&(value=statement(self,locals))}return value}}function _filterChain(){for(var token,left=expression();;){if(!(token=expect("|")))return left;left=binaryFn(left,token.fn,filter())}}function filter(){for(var token=expect(),fn=$filter(token.text),argsFn=[];;){if(!(token=expect(":"))){var fnInvoke=function(self,locals,input){for(var args=[input],i=0;i<argsFn.length;i++)args.push(argsFn[i](self,locals));return fn.apply(self,args)};return function(){return fnInvoke}}argsFn.push(expression())}}function expression(){return assignment()}function _assignment(){var right,token,left=ternary();return(token=expect("="))?(left.assign||throwError("implies assignment but ["+text.substring(0,token.index)+"] can not be assigned to",token),right=ternary(),function(scope,locals){return left.assign(scope,right(scope,locals),locals)}):left}function ternary(){var middle,token,left=logicalOR();return(token=expect("?"))?(middle=ternary(),(token=expect(":"))?ternaryFn(left,middle,ternary()):void throwError("expected :",token)):left}function logicalOR(){for(var token,left=logicalAND();;){if(!(token=expect("||")))return left;left=binaryFn(left,token.fn,logicalAND())}}function logicalAND(){var token,left=equality();return(token=expect("&&"))&&(left=binaryFn(left,token.fn,logicalAND())),left}function equality(){var token,left=relational();return(token=expect("==","!=","===","!=="))&&(left=binaryFn(left,token.fn,equality())),left}function relational(){var token,left=additive();return(token=expect("<",">","<=",">="))&&(left=binaryFn(left,token.fn,relational())),left}function additive(){for(var token,left=multiplicative();token=expect("+","-");)left=binaryFn(left,token.fn,multiplicative());return left}function multiplicative(){for(var token,left=unary();token=expect("*","/","%");)left=binaryFn(left,token.fn,unary());return left}function unary(){var token;return expect("+")?primary():(token=expect("-"))?binaryFn(ZERO,token.fn,unary()):(token=expect("!"))?unaryFn(token.fn,unary()):primary()}function primary(){var primary;if(expect("("))primary=filterChain(),consume(")");else if(expect("["))primary=arrayDeclaration();else if(expect("{"))primary=object();else{var token=expect();primary=token.fn,primary||throwError("not a primary expression",token),token.json&&(primary.constant=primary.literal=!0)}for(var next,context;next=expect("(","[",".");)"("===next.text?(primary=functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=objectIndex(primary)):"."===next.text?(context=primary,primary=fieldAccess(primary)):throwError("IMPOSSIBLE");return primary}function _fieldAccess(object){var field=expect().text,getter=getterFn(field,csp,text);return extend(function(scope,locals,self){return getter(self||object(scope,locals),locals)},{assign:function(scope,value,locals){return setter(object(scope,locals),field,value,text)}})}function _objectIndex(obj){var indexFn=expression();return consume("]"),extend(function(self,locals){var v,p,o=obj(self,locals),i=indexFn(self,locals);return o?(v=ensureSafeObject(o[i],text),v&&v.then&&(p=v,"$$v"in v||(p.$$v=undefined,p.then(function(val){p.$$v=val})),v=v.$$v),v):undefined},{assign:function(self,value,locals){var key=indexFn(self,locals);return ensureSafeObject(obj(self,locals),text)[key]=value}})}function _functionCall(fn,contextGetter){var argsFn=[];if(")"!=peekToken().text)do argsFn.push(expression());while(expect(","));return consume(")"),function(scope,locals){for(var args=[],context=contextGetter?contextGetter(scope,locals):scope,i=0;i<argsFn.length;i++)args.push(argsFn[i](scope,locals));var fnPtr=fn(scope,locals,context)||noop;return fnPtr.apply?fnPtr.apply(context,args):fnPtr(args[0],args[1],args[2],args[3],args[4])}}function arrayDeclaration(){var elementFns=[],allConstant=!0;if("]"!=peekToken().text)do{var elementFn=expression();elementFns.push(elementFn),elementFn.constant||(allConstant=!1)}while(expect(","));return consume("]"),extend(function(self,locals){for(var array=[],i=0;i<elementFns.length;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:allConstant})}function object(){var keyValues=[],allConstant=!0;if("}"!=peekToken().text)do{var token=expect(),key=token.string||token.text;consume(":");var value=expression();keyValues.push({key:key,value:value}),value.constant||(allConstant=!1)}while(expect(","));return consume("}"),extend(function(self,locals){for(var object={},i=0;i<keyValues.length;i++){var keyValue=keyValues[i];object[keyValue.key]=keyValue.value(self,locals)}return object},{literal:!0,constant:allConstant})}var value,ZERO=valueFn(0),tokens=lex(text,csp),assignment=_assignment,functionCall=_functionCall,fieldAccess=_fieldAccess,objectIndex=_objectIndex,filterChain=_filterChain;return json?(assignment=logicalOR,functionCall=fieldAccess=objectIndex=filterChain=function(){throwError("is not valid json",{text:text,index:0})},value=primary()):value=statements(),0!==tokens.length&&throwError("is an unexpected token",tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value}function setter(obj,path,setValue,fullExp){for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=obj[key];propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj,obj.then&&("$$v"in obj||!function(promise){promise.then(function(val){promise.$$v=val})}(obj),obj.$$v===undefined&&(obj.$$v={}),obj=obj.$$v)}return key=ensureSafeMemberName(element.shift(),fullExp),obj[key]=setValue,setValue}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp){return ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp),function(scope,locals){var promise,pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null===pathVal||pathVal===undefined?pathVal:(pathVal=pathVal[key0],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key1&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key1],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key2&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key2],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key3&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key3],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key4&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key4],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),pathVal):pathVal):pathVal):pathVal):pathVal)}}function getterFn(path,csp,fullExp){if(getterFnCache.hasOwnProperty(path))return getterFnCache[path];var fn,pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp)(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="var l, fn, p;\n";forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp),code+="if(s === null || s === undefined) return s;\nl=s;\ns="+(index?"s":'((k&&k.hasOwnProperty("'+key+'"))?k:s)')+'["'+key+'"];\nif (s && s.then) {\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n'}),code+="return s;",fn=Function("s","k",code),fn.toString=function(){return code}}return getterFnCache[path]=fn}function $ParseProvider(){var cache={};this.$get=["$filter","$sniffer",function($filter,$sniffer){return function(exp){switch(typeof exp){case"string":return cache.hasOwnProperty(exp)?cache[exp]:cache[exp]=parser(exp,!1,$filter,$sniffer.csp);case"function":return exp;default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function defaultCallback(value){return value}function defaultErrback(reason){return reject(reason)}function all(promises){var deferred=defer(),counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,ref(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var defer=function(){var value,deferred,pending=[];return deferred={resolve:function(val){if(pending){var callbacks=pending;pending=undefined,value=ref(val),callbacks.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],value.then(callback[0],callback[1],callback[2])})}},reject:function(reason){deferred.resolve(reject(reason))},notify:function(progress){if(pending){var callbacks=pending;pending.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],callback[2](progress)})}},promise:{then:function(callback,errback,progressback){var result=defer(),wrappedCallback=function(value){try{result.resolve((callback||defaultCallback)(value))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedErrback=function(reason){try{result.resolve((errback||defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedProgressback=function(progress){try{result.notify((progressback||defaultCallback)(progress))}catch(e){exceptionHandler(e)}};return pending?pending.push([wrappedCallback,wrappedErrback,wrappedProgressback]):value.then(wrappedCallback,wrappedErrback,wrappedProgressback),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback){function makePromise(value,resolved){var result=defer();return resolved?result.resolve(value):result.reject(value),result.promise}function handleCallback(value,isResolved){var callbackOutput=null;try{callbackOutput=(callback||defaultCallback)()}catch(e){return makePromise(e,!1)}return callbackOutput&&callbackOutput.then?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)}return this.then(function(value){return handleCallback(value,!0)},function(error){return handleCallback(error,!1)})}}}},ref=function(value){return value&&value.then?value:{then:function(callback){var result=defer();return nextTick(function(){result.resolve(callback(value))}),result.promise}}},reject=function(reason){return{then:function(callback,errback){var result=defer();return nextTick(function(){result.resolve((errback||defaultErrback)(reason))}),result.promise}}},when=function(value,callback,errback,progressback){var done,result=defer(),wrappedCallback=function(value){try{return(callback||defaultCallback)(value)}catch(e){return exceptionHandler(e),reject(e)}},wrappedErrback=function(reason){try{return(errback||defaultErrback)(reason)}catch(e){return exceptionHandler(e),reject(e)}},wrappedProgressback=function(progress){try{return(progressback||defaultCallback)(progress)}catch(e){exceptionHandler(e)}};return nextTick(function(){ref(value).then(function(value){done||(done=!0,result.resolve(ref(value).then(wrappedCallback,wrappedErrback,wrappedProgressback)))},function(reason){done||(done=!0,result.resolve(wrappedErrback(reason)))},function(progress){done||result.notify(wrappedProgressback(progress))})}),result.promise};return{defer:defer,reject:reject,when:when,all:all}}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope");this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse",function($injector,$exceptionHandler,$parse){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$listeners={},this.$$isolateBindings={}}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function compileToFn(exp,name){var fn=$parse(exp);return assertArgFn(fn,name),fn}function initWatchVal(){}Scope.prototype={$new:function(isolate){var Child,child;return isolate?(child=new Scope,child.$root=this.$root,child.$$asyncQueue=this.$$asyncQueue):(Child=function(){},Child.prototype=this,child=new Child,child.$id=nextUid()),child["this"]=child,child.$$listeners={},child.$parent=this,child.$$watchers=child.$$nextSibling=child.$$childHead=child.$$childTail=null,child.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=child,this.$$childTail=child):this.$$childHead=this.$$childTail=child,child},$watch:function(watchExp,listener,objectEquality){var scope=this,get=compileToFn(watchExp,"watch"),array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};if(!isFunction(listener)){var listenFn=compileToFn(listener||noop,"listener");watcher.fn=function(newVal,oldVal,scope){listenFn(scope)}}if("string"==typeof watchExp&&get.constant){var originalFn=watcher.fn;watcher.fn=function(newVal,oldVal,scope){originalFn.call(this,newVal,oldVal,scope),arrayRemove(array,watcher)}}return array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher)}},$watchCollection:function(obj,listener){function $watchCollectionWatch(){newValue=objGetter(self);var newLength,key;if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)oldValue[i]!==newValue[i]&&(changeDetected++,oldValue[i]=newValue[i])}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,oldValue.hasOwnProperty(key)?oldValue[key]!==newValue[key]&&(changeDetected++,oldValue[key]=newValue[key]):(oldLength++,oldValue[key]=newValue[key],changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)oldValue.hasOwnProperty(key)&&!newValue.hasOwnProperty(key)&&(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);
return changeDetected}function $watchCollectionAction(){listener(newValue,oldValue,self)}var oldValue,newValue,self=this,changeDetected=0,objGetter=$parse(obj),internalArray=[],internalObject={},oldLength=0;return this.$watch($watchCollectionWatch,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,logMsg,asyncQueue=this.$$asyncQueue,ttl=TTL,target=this,watchLog=[];beginPhase("$digest");do{for(dirty=!1,current=target;asyncQueue.length;)try{current.$eval(asyncQueue.shift())}catch(e){$exceptionHandler(e)}do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{watch=watchers[length],watch&&(value=watch.get(current))!==(last=watch.last)&&!(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))&&(dirty=!0,watch.last=watch.eq?copy(value):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),logMsg=isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,logMsg+="; newVal: "+toJson(value)+"; oldVal: "+toJson(last),watchLog[logIdx].push(logMsg)))}catch(e){$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if(dirty&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,toJson(watchLog))}while(dirty||asyncQueue.length);clearPhase()},$destroy:function(){if($rootScope!=this&&!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){this.$$asyncQueue.push(expr)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$on:function(name,listener){var namedListeners=this.$$listeners[name];return namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener),function(){namedListeners[indexOf(namedListeners,listener)]=null}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{if(namedListeners[i].apply(null,listenerArgs),stopPropagation)return event}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;scope=scope.$parent}while(scope);return event},$broadcast:function(name){var listeners,i,length,target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(current=next,event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);return event}};var $rootScope=new Scope;return $rootScope}]}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=value),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=value),resourceUrlBlacklist},this.$get=["$log","$document","$injector","$$urlUtils",function($log,$document,$injector,$$urlUtils){function matchUrl(matcher,parsedUrl){return"self"===matcher?$$urlUtils.isSameOrigin(parsedUrl):!!parsedUrl.href.match(matcher)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=$$urlUtils.resolve(url.toString(),!0),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return base&&(holderType.prototype=new base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$document","$sceDelegate",function($parse,$document,$sceDelegate){if(enabled&&msie){var documentMode=$document[0].documentMode;if(documentMode!==undefined&&8>documentMode)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.")}var sce=copy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:function(self,locals){return sce.getTrusted(type,parsed(self,locals))}};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return angular.forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),document=$document[0]||{},vendorRegex=/^(Moz|webkit|O|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android),hashchange:"onhashchange"in $window&&(!document.documentMode||document.documentMode>7),hasEvent:function(event){if("input"==event&&9==msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:document.securityPolicy?document.securityPolicy.isActive:!1,vendorPrefix:vendorPrefix,transitions:transitions,animations:animations}}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function($rootScope,$browser,$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,cleanup,deferred=$q.defer(),promise=deferred.promise,skipApply=isDefined(invokeApply)&&!invokeApply;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}skipApply||$rootScope.$apply()},delay),cleanup=function(){delete deferreds[promise.$$timeoutId]},promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise.then(cleanup,cleanup),promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function $$UrlUtilsProvider(){this.$get=[function(){function resolve(url,parse){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),parse?{href:urlParsingNode.href,protocol:urlParsingNode.protocol,host:urlParsingNode.host}:urlParsingNode.href}var urlParsingNode=document.createElement("a"),originUrl=resolve(window.location.href,!0);return{resolve:resolve,isSameOrigin:function(requestUrl){var parsed="string"==typeof requestUrl?resolve(requestUrl,!0):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}}}]}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comperator){if(!isArray(array))return array;var predicates=[];switch(predicates.check=function(value){for(var j=0;j<predicates.length;j++)if(!predicates[j](value))return!1;return!0},typeof comperator){case"function":break;case"boolean":if(1==comperator){comperator=function(obj,text){return angular.equals(obj,text)};break}default:comperator=function(obj,text){return text=(""+text).toLowerCase(),(""+obj).toLowerCase().indexOf(text)>-1}}var search=function(obj,text){if("string"==typeof text&&"!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return comperator(obj,text);case"object":switch(typeof text){case"object":return comperator(obj,text);default:for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0}return!1;case"array":for(var i=0;i<obj.length;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)"$"==key?!function(){if(expression[key]){var path=key;predicates.push(function(value){return search(value,expression[path])})}}():!function(){if(expression[key]){var path=key;predicates.push(function(value){return search(getter(value,path),expression[path])})}}();break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;j<array.length;j++){var value=array[j];predicates.check(value)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,2).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(isNaN(number)||!isFinite(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?numStr="0":(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&number>-1&&1>number&&(formatedText=number.toFixed(fractionSize));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac));var pow=Math.pow(10,fractionSize);number=Math.round(number*pow)/pow;var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group){pos=whole.length-lgroup;for(var i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i)}for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre),parts.push(formatedText),parts.push(isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(input,limit){if(!isArray(input)&&!isString(input))return input;if(limit=int(limit),isString(input))return limit?limit>=0?input.slice(0,limit):input.slice(limit,input.length):"";var i,n,out=[];for(limit>input.length?limit=input.length:limit<-input.length&&(limit=-input.length),limit>0?(i=0,n=limit):(i=input.length+limit,n=input.length);n>i;i++)out.push(input[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return toBoolean(descending)?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?("string"==t1&&(v1=v1.toLowerCase()),"string"==t1&&(v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}if(!isArray(array))return array;if(!sortPredicate)return array;sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],sortPredicate=map(sortPredicate,function(predicate){var descending=!1,get=predicate||identity;return isString(predicate)&&(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),get=$parse(predicate)),reverseComparator(function(a,b){return compare(get(a),get(b))},descending)});for(var arrayCopy=[],i=0;i<array.length;i++)arrayCopy.push(array[i]);return arrayCopy.sort(reverseComparator(comparator,reverseOrder))}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function FormController(element,attrs){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",element.removeClass((isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey).addClass((isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}var form=this,parentForm=element.parent().controller("form")||nullFormCtrl,invalidCount=0,errors=form.$error={},controls=[];form.$name=attrs.name||attrs.ngForm,form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,parentForm.$addControl(form),element.addClass(PRISTINE_CLASS),toggleValidCss(!0),form.$addControl=function(control){controls.push(control),control.$name&&!form.hasOwnProperty(control.$name)&&(form[control.$name]=control)},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(errors,function(queue,validationToken){form.$setValidity(validationToken,!0,control)}),arrayRemove(controls,control)},form.$setValidity=function(validationToken,isValid,control){var queue=errors[validationToken];if(isValid)queue&&(arrayRemove(queue,control),queue.length||(invalidCount--,invalidCount||(toggleValidCss(isValid),form.$valid=!0,form.$invalid=!1),errors[validationToken]=!1,toggleValidCss(!0,validationToken),parentForm.$setValidity(validationToken,!0,form)));else{if(invalidCount||toggleValidCss(isValid),queue){if(includes(queue,control))return}else errors[validationToken]=queue=[],invalidCount++,toggleValidCss(!1,validationToken),parentForm.$setValidity(validationToken,!1,form);queue.push(control),form.$valid=!1,form.$invalid=!0}},form.$setDirty=function(){element.removeClass(PRISTINE_CLASS).addClass(DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){element.removeClass(DIRTY_CLASS).addClass(PRISTINE_CLASS),form.$dirty=!1,form.$pristine=!0,forEach(controls,function(control){control.$setPristine()})}}function isEmpty(value){return isUndefined(value)||""===value||null===value||value!==value}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){var listener=function(){var value=element.val();toBoolean(attr.ngTrim||"T")&&(value=trim(value)),ctrl.$viewValue!==value&&scope.$apply(function(){ctrl.$setViewValue(value)})};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(){timeout||(timeout=$browser.defer(function(){listener(),timeout=null}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener()}),element.on("change",listener),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}ctrl.$render=function(){element.val(isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)};var patternValidator,match,pattern=attr.ngPattern,validate=function(regexp,value){return isEmpty(value)||regexp.test(value)?(ctrl.$setValidity("pattern",!0),value):(ctrl.$setValidity("pattern",!1),undefined)};if(pattern&&(match=pattern.match(/^\/(.*)\/([gim]*)$/),match?(pattern=new RegExp(match[1],match[2]),patternValidator=function(value){return validate(pattern,value)}):patternValidator=function(value){var patternObj=scope.$eval(pattern);if(!patternObj||!patternObj.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",pattern,patternObj,startingTag(element));return validate(patternObj,value)},ctrl.$formatters.push(patternValidator),ctrl.$parsers.push(patternValidator)),attr.ngMinlength){var minlength=int(attr.ngMinlength),minLengthValidator=function(value){return!isEmpty(value)&&value.length<minlength?(ctrl.$setValidity("minlength",!1),undefined):(ctrl.$setValidity("minlength",!0),value)};ctrl.$parsers.push(minLengthValidator),ctrl.$formatters.push(minLengthValidator)}if(attr.ngMaxlength){var maxlength=int(attr.ngMaxlength),maxLengthValidator=function(value){return!isEmpty(value)&&value.length>maxlength?(ctrl.$setValidity("maxlength",!1),undefined):(ctrl.$setValidity("maxlength",!0),value)};ctrl.$parsers.push(maxLengthValidator),ctrl.$formatters.push(maxLengthValidator)}}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(textInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$parsers.push(function(value){var empty=isEmpty(value);return empty||NUMBER_REGEXP.test(value)?(ctrl.$setValidity("number",!0),""===value?null:empty?value:parseFloat(value)):(ctrl.$setValidity("number",!1),undefined)}),ctrl.$formatters.push(function(value){return isEmpty(value)?"":""+value}),attr.min){var min=parseFloat(attr.min),minValidator=function(value){return!isEmpty(value)&&min>value?(ctrl.$setValidity("min",!1),undefined):(ctrl.$setValidity("min",!0),value)};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}if(attr.max){var max=parseFloat(attr.max),maxValidator=function(value){return!isEmpty(value)&&value>max?(ctrl.$setValidity("max",!1),undefined):(ctrl.$setValidity("max",!0),value)};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}ctrl.$formatters.push(function(value){return isEmpty(value)||isNumber(value)?(ctrl.$setValidity("number",!0),value):(ctrl.$setValidity("number",!1),undefined)})}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var urlValidator=function(value){return isEmpty(value)||URL_REGEXP.test(value)?(ctrl.$setValidity("url",!0),value):(ctrl.$setValidity("url",!1),undefined)};ctrl.$formatters.push(urlValidator),ctrl.$parsers.push(urlValidator)}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var emailValidator=function(value){return isEmpty(value)||EMAIL_REGEXP.test(value)?(ctrl.$setValidity("email",!0),value):(ctrl.$setValidity("email",!1),undefined)};ctrl.$formatters.push(emailValidator),ctrl.$parsers.push(emailValidator)}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid()),element.on("click",function(){element[0].checked&&scope.$apply(function(){ctrl.$setViewValue(attr.value)})}),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function checkboxInputType(scope,element,attr,ctrl){var trueValue=attr.ngTrueValue,falseValue=attr.ngFalseValue;isString(trueValue)||(trueValue=!0),isString(falseValue)||(falseValue=!1),element.on("click",function(){scope.$apply(function(){ctrl.$setViewValue(element[0].checked)})}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$formatters.push(function(value){return value===trueValue}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,function(){return{restrict:"AC",link:function(scope,element,attr){function ngClassWatchAction(newVal){(selector===!0||scope.$index%2===selector)&&(oldVal&&!equals(newVal,oldVal)&&removeClass(oldVal),addClass(newVal)),oldVal=copy(newVal)}function removeClass(classVal){attr.$removeClass(flattenClasses(classVal))}function addClass(classVal){attr.$addClass(flattenClasses(classVal))}function flattenClasses(classVal){if(isArray(classVal))return classVal.join(" ");if(isObject(classVal)){var classes=[];return forEach(classVal,function(v,k){v&&classes.push(k)}),classes.join(" ")}return classVal}var oldVal=undefined;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;mod!==old$index&1&&(mod===selector?addClass(scope.$eval(attr[name])):removeClass(scope.$eval(attr[name])))})}}}}var lowercase=(Object.prototype.hasOwnProperty,function(string){return isString(string)?string.toLowerCase():string}),uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var jqLite,jQuery,angularModule,nodeName_,msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),slice=[].slice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=(window.angular,window.angular||(window.angular={})),uid=["0","0","0"];noop.$inject=[],identity.$inject=[];var trim=function(){return String.prototype.trim?function(value){return isString(value)?value.trim():value}:function(value){return isString(value)?value.replace(/^\s*/,"").replace(/\s*$/,""):value}}();nodeName_=9>msie?function(element){return element=element.nodeName?element:element[0],element.scopeName&&"HTML"!=element.scopeName?uppercase(element.scopeName+":"+element.nodeName):element.nodeName}:function(element){return element.nodeName?element.nodeName:element[0].nodeName};var SNAKE_CASE_REGEXP=/[A-Z]/g,version={full:"1.2.0rc1",major:1,minor:2,dot:0,codeName:"spooky-giraffe"},jqCache=JQLite.cache={},jqName=JQLite.expando="ng-"+(new Date).getTime(),jqId=1,addEventListenerFn=window.document.addEventListener?function(element,type,fn){element.addEventListener(type,fn,!1)}:function(element,type,fn){element.attachEvent("on"+type,fn)},removeEventListenerFn=window.document.removeEventListener?function(element,type,fn){element.removeEventListener(type,fn,!1)}:function(element,type,fn){element.detachEvent("on"+type,fn)},SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,jqLiteMinErr=minErr("jqLite"),JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[uppercase(value)]=!0}),forEach({data:JQLiteData,inheritedData:JQLiteInheritedData,scope:function(element){return JQLiteInheritedData(element,"$scope")},controller:JQLiteController,injector:function(element){return JQLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:JQLiteHasClass,css:function(element,name,value){if(name=camelCase(name),!isDefined(value)){var val;return 8>=msie&&(val=element.currentStyle&&element.currentStyle[name],""===val&&(val="auto")),val=val||element.style[name],8>=msie&&(val=""===val?undefined:val),val}element.style[name]=value},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){var textProp=NODE_TYPE_TEXT_PROPERTY[element.nodeType];return isUndefined(value)?textProp?element[textProp]:"":void(element[textProp]=value)}var NODE_TYPE_TEXT_PROPERTY=[];return 9>msie?(NODE_TYPE_TEXT_PROPERTY[1]="innerText",NODE_TYPE_TEXT_PROPERTY[3]="nodeValue"):NODE_TYPE_TEXT_PROPERTY[1]=NODE_TYPE_TEXT_PROPERTY[3]="textContent",getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if("SELECT"===nodeName_(element)&&element.multiple){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){if(isUndefined(value))return element.innerHTML;for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)JQLiteDealoc(childNodes[i]);
element.innerHTML=value}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key;if((2==fn.length&&fn!==JQLiteHasClass&&fn!==JQLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;i<this.length;i++)if(fn===JQLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value==undefined?Math.min(this.length,1):this.length,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;i<this.length;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:JQLiteRemoveData,dealoc:JQLiteDealoc,on:function onFn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var events=JQLiteExpandoStore(element,"events"),handle=JQLiteExpandoStore(element,"handle");events||JQLiteExpandoStore(element,"events",events={}),handle||JQLiteExpandoStore(element,"handle",handle=createEventHandler(element,events)),forEach(type.split(" "),function(type){var eventFns=events[type];if(!eventFns){if("mouseenter"==type||"mouseleave"==type){var contains=document.body.contains||document.body.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};events[type]=[];var eventmap={mouseleave:"mouseout",mouseenter:"mouseover"};onFn(element,eventmap[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!contains(target,related))&&handle(event,type)})}else addEventListenerFn(element,type,handle),events[type]=[];eventFns=events[type]}eventFns.push(fn)})},off:JQLiteOff,replaceWith:function(element,replaceNode){var index,parent=element.parentNode;JQLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){1===element.nodeType&&children.push(element)}),children},contents:function(element){return element.childNodes||[]},append:function(element,node){forEach(new JQLite(node),function(child){(1===element.nodeType||11===element.nodeType)&&element.appendChild(child)})},prepend:function(element,node){if(1===element.nodeType){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode)[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:function(element){JQLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)},after:function(element,newElement){var index=element,parent=element.parentNode;forEach(new JQLite(newElement),function(node){parent.insertBefore(node,index.nextSibling),index=node})},addClass:JQLiteAddClass,removeClass:JQLiteRemoveClass,toggleClass:function(element,selector,condition){isUndefined(condition)&&(condition=!JQLiteHasClass(element,selector)),(condition?JQLiteAddClass:JQLiteRemoveClass)(element,selector)},parent:function(element){var parent=element.parentNode;return parent&&11!==parent.nodeType?parent:null},next:function(element){if(element.nextElementSibling)return element.nextElementSibling;for(var elm=element.nextSibling;null!=elm&&1!==elm.nodeType;)elm=elm.nextSibling;return elm},find:function(element,selector){return element.getElementsByTagName(selector)},clone:JQLiteClone,triggerHandler:function(element,eventName,eventData){var eventFns=(JQLiteExpandoStore(element,"events")||{})[eventName];eventData=eventData||{preventDefault:noop,stopPropagation:noop},forEach(eventFns,function(fn){fn.call(element,eventData)})}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0;i<this.length;i++)value==undefined?(value=fn(this[i],arg1,arg2,arg3),value!==undefined&&(value=jqLite(value))):JQLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return value==undefined?this:value},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key)]=value},get:function(key){return this[hashKey(key)]},remove:function(key){var value=this[key=hashKey(key)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector"),$animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.$get=["$timeout",function($timeout){return{enter:function(element,parent,after,done){var afterNode=after&&after[after.length-1],parentNode=parent&&parent[0]||afterNode&&afterNode.parentNode,afterNextSibling=afterNode&&afterNode.nextSibling||null;forEach(element,function(node){parentNode.insertBefore(node,afterNextSibling)}),$timeout(done||noop,0,!1)},leave:function(element,done){element.remove(),$timeout(done||noop,0,!1)},move:function(element,parent,after,done){this.enter(element,parent,after,done)},addClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",element.addClass(className),$timeout(done||noop,0,!1)},removeClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",element.removeClass(className),$timeout(done||noop,0,!1)},enabled:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide"];var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,XHR=window.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e1){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e2){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e3){}throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")},$interpolateMinErr=minErr("$interpolate"),SERVER_MATCH=/^([^:]+):\/\/(\w+:{0,1}\w*@)?(\{?[\w\.-]*\}?)(:([0-9]+))?(\/[^\?#]*)?(\?([^#]*))?(#(.*))?$/,PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location");LocationHashbangInHtml5Url.prototype=LocationHashbangUrl.prototype=LocationHtml5Url.prototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url,replace){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return match[1]&&this.path(decodeURIComponent(match[1])),(match[2]||match[1])&&this.search(match[3]||""),this.hash(match[5]||"",replace),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return"/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search))this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");this.$$search=search}break;default:paramValue==undefined||null==paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",identity),replace:function(){return this.$$replace=!0,this}};var $parseMinErr=minErr("$parse"),OPERATORS={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:noop,"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"^":function(self,locals,a,b){return a(self,locals)^b(self,locals)},"=":noop,"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"&":function(self,locals,a,b){return a(self,locals)&b(self,locals)},"|":function(self,locals,a,b){return b(self,locals)(self,locals,a(self,locals))},"!":function(self,locals,a){return!a(self,locals)}},ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},getterFnCache={},$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"};$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return 8>=msie&&(attr.href||attr.name||attr.$set("href",""),element.append(document.createComment("IE fix"))),function(scope,element){element.on("click",function(event){element.attr("href")||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:100,compile:function(){return function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){attr.$observe(normalized,function(value){value&&(attr.$set(attrName,value),msie&&element.prop(attrName,attr[attrName]))})}}}});var nullFormCtrl={$addControl:noop,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop};FormController.$inject=["$element","$attrs","$scope"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:"E",controller:FormController,compile:function(){return{pre:function(scope,formElement,attr,controller){if(!attr.action){var preventDefaultListener=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1};addEventListenerFn(formElement[0],"submit",preventDefaultListener),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",preventDefaultListener)},0,!1)})}var parentFormCtrl=formElement.parent().controller("form"),alias=attr.name||attr.ngForm;alias&&setter(scope,alias,controller,alias),parentFormCtrl&&formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return isNgForm?extend(copy(formDirective),{restrict:"EAC"}):formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}$/,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,inputType={text:textInputType,number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop},inputDirective=["$browser","$sniffer",function($browser,$sniffer){return{restrict:"E",require:"?ngModel",link:function(scope,element,attr,ctrl){ctrl&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrl,$sniffer,$browser)}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse",function($scope,$exceptionHandler,$attr,$element,$parse){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$element.removeClass((isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey).addClass((isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=$attr.name;var ngModelGet=$parse($attr.ngModel),ngModelSet=ngModelGet.assign;if(!ngModelSet)throw minErr("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element));this.$render=noop;var parentForm=$element.inheritedData("$formController")||nullFormCtrl,invalidCount=0,$error=this.$error={};$element.addClass(PRISTINE_CLASS),toggleValidCss(!0),this.$setValidity=function(validationErrorKey,isValid){$error[validationErrorKey]!==!isValid&&(isValid?($error[validationErrorKey]&&invalidCount--,invalidCount||(toggleValidCss(!0),this.$valid=!0,this.$invalid=!1)):(toggleValidCss(!1),this.$invalid=!0,this.$valid=!1,invalidCount++),$error[validationErrorKey]=!isValid,toggleValidCss(isValid,validationErrorKey),parentForm.$setValidity(validationErrorKey,isValid,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,$element.removeClass(DIRTY_CLASS).addClass(PRISTINE_CLASS)},this.$setViewValue=function(value){this.$viewValue=value,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,$element.removeClass(PRISTINE_CLASS).addClass(DIRTY_CLASS),parentForm.$setDirty()),forEach(this.$parsers,function(fn){value=fn(value)}),this.$modelValue!==value&&(this.$modelValue=value,ngModelSet($scope,value),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}}))};var ctrl=this;$scope.$watch(function(){var value=ngModelGet($scope);if(ctrl.$modelValue!==value){var formatters=ctrl.$formatters,idx=formatters.length;for(ctrl.$modelValue=value;idx--;)value=formatters[idx](value);ctrl.$viewValue!==value&&(ctrl.$viewValue=value,ctrl.$render())}})}],ngModelDirective=function(){return{require:["ngModel","^?form"],controller:NgModelController,link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;formCtrl.$addControl(modelCtrl),element.on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})}}},ngChangeDirective=valueFn({require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){attr.required=!0;var validator=function(value){return attr.required&&(isEmpty(value)||value===!1)?void ctrl.$setValidity("required",!1):(ctrl.$setValidity("required",!0),value)};ctrl.$formatters.push(validator),ctrl.$parsers.unshift(validator),attr.$observe("required",function(){validator(ctrl.$viewValue)})}}}},ngListDirective=function(){return{require:"ngModel",link:function(scope,element,attr,ctrl){var match=/\/(.*)\//.exec(attr.ngList),separator=match&&new RegExp(match[1])||attr.ngList||",",parse=function(viewValue){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trim(value))}),list};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(", "):undefined})}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=ngDirective(function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.ngBind),scope.$watch(attr.ngBind,function(value){element.text(value==undefined?"":value)})}),ngBindTemplateDirective=["$interpolate",function($interpolate){return function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));element.addClass("ng-binding").data("$binding",interpolateFn),attr.$observe("ngBindTemplate",function(value){element.text(value)})}}],ngBindHtmlDirective=["$sce",function($sce){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.ngBindHtml),scope.$watch($sce.parseAsHtml(attr.ngBindHtml),function(value){element.html(value||"")})}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{scope:!0,controller:"@"}}],ngCspDirective=["$sniffer",function($sniffer){return{priority:1e3,compile:function(){$sniffer.csp=!0}}}],ngEventDirectives={};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur".split(" "),function(name){var directiveName=directiveNormalize("ng-"+name);ngEventDirectives[directiveName]=["$parse",function($parse){return function(scope,element,attr){var fn=$parse(attr[directiveName]);element.on(lowercase(name),function(event){scope.$apply(function(){fn(scope,{$event:event})})})}}]});var ngIfDirective=["$animate",function($animate){return{transclude:"element",priority:1e3,terminal:!0,restrict:"A",compile:function(element,attr,transclude){return function($scope,$element,$attr){var childElement,childScope;$scope.$watch($attr.ngIf,function(value){childElement&&($animate.leave(childElement),childElement=undefined),childScope&&(childScope.$destroy(),childScope=undefined),toBoolean(value)&&(childScope=$scope.$new(),transclude(childScope,function(clone){childElement=clone,$animate.enter(clone,$element.parent(),$element)}))})}}}}],NG_INCLUDE_PRIORITY=500,ngIncludeDirective=["$http","$templateCache","$anchorScroll","$compile","$animate","$sce",function($http,$templateCache,$anchorScroll,$compile,$animate,$sce){return{restrict:"ECA",terminal:!0,priority:NG_INCLUDE_PRIORITY,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;element.html("");var anchor=jqLite(document.createComment(" ngInclude: "+srcExp+" "));return element.replaceWith(anchor),function(scope){var currentScope,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement),currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function(src){var thisChangeId=++changeCounter;src?($http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();cleanupLastIncludeContent(),currentScope=newScope,currentElement=element.clone(),currentElement.html(response),$animate.enter(currentElement,null,anchor),$compile(currentElement,!1,NG_INCLUDE_PRIORITY-1)(currentScope),!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll(),currentScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&cleanupLastIncludeContent()}),scope.$emit("$includeContentRequested")):cleanupLastIncludeContent()})}}}}],ngInitDirective=ngDirective({compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g;return{restrict:"EA",link:function(scope,element,attr){var numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),isWhen=/^when(Minus)?(.+)$/;forEach(attr,function(expression,attributeName){isWhen.test(attributeName)&&(whens[lowercase(attributeName.replace("when","").replace("Minus","-"))]=element.attr(attr.$attr[attributeName]))}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,startSymbol+numberExp+"-"+offset+endSymbol))}),scope.$watch(function(){var value=parseFloat(scope.$eval(numberExp));return isNaN(value)?"":(value in whens||(value=$locale.pluralCat(value-offset)),whensExpFns[value](scope,element,!0))},function(newVal){element.text(newVal)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,compile:function(element,attr,linker){return function($scope,$element,$attr){var trackByExp,trackByExpGetter,trackByIdFn,trackByIdArrayFn,trackByIdObjFn,lhs,rhs,valueIdentifier,keyIdentifier,expression=$attr.ngRepeat,match=expression.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),hashFnLocals={$id:hashKey};if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(lhs=match[1],rhs=match[2],trackByExp=match[4],trackByExp?(trackByExpGetter=$parse(trackByExp),trackByIdFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)}):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);valueIdentifier=match[3]||match[1],keyIdentifier=match[2];var lastBlockMap={};$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,arrayLength,childScope,key,value,trackById,collectionKeys,block,previousNode=$element[0],nextBlockMap={},nextBlockOrder=[];if(isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdFn||trackByIdArrayFn;else{trackByIdFn=trackByIdFn||trackByIdObjFn,collectionKeys=[];for(key in collection)collection.hasOwnProperty(key)&&"$"!=key.charAt(0)&&collectionKeys.push(key);collectionKeys.sort()}for(arrayLength=collectionKeys.length,length=nextBlockOrder.length=collectionKeys.length,index=0;length>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap.hasOwnProperty(trackById))block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap.hasOwnProperty(trackById))throw forEach(nextBlockOrder,function(block){block&&block.startNode&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}",expression,trackById);nextBlockOrder[index]={id:trackById},nextBlockMap[trackById]=!1}for(key in lastBlockMap)lastBlockMap.hasOwnProperty(key)&&(block=lastBlockMap[key],$animate.leave(block.elements),forEach(block.elements,function(element){element[NG_REMOVED]=!0}),block.scope.$destroy());for(index=0,length=collectionKeys.length;length>index;index++){if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.startNode){childScope=block.scope,nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);block.startNode==nextNode||$animate.move(block.elements,null,jqLite(previousNode)),previousNode=block.endNode}else childScope=$scope.$new();childScope[valueIdentifier]=value,keyIdentifier&&(childScope[keyIdentifier]=key),childScope.$index=index,childScope.$first=0===index,childScope.$last=index===arrayLength-1,childScope.$middle=!(childScope.$first||childScope.$last),childScope.$odd=!(childScope.$even=index%2==0),block.startNode||linker(childScope,function(clone){$animate.enter(clone,null,jqLite(previousNode)),previousNode=clone,block.scope=childScope,block.startNode=clone[0],block.elements=clone,block.endNode=clone[clone.length-1],nextBlockMap[block.id]=block})}lastBlockMap=nextBlockMap})}}}}],ngShowDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[toBoolean(value)?"removeClass":"addClass"](element,"ng-hide")})}}],ngHideDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[toBoolean(value)?"addClass":"removeClass"](element,"ng-hide")})}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var selectedTranscludes,selectedElements,watchExpr=attr.ngSwitch||attr.on,selectedScopes=[];scope.$watch(watchExpr,function(value){for(var i=0,ii=selectedScopes.length;ii>i;i++)selectedScopes[i].$destroy(),$animate.leave(selectedElements[i]);selectedElements=[],selectedScopes=[],(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&(scope.$eval(attr.change),forEach(selectedTranscludes,function(selectedTransclude){var selectedScope=scope.$new();selectedScopes.push(selectedScope),selectedTransclude.transclude(selectedScope,function(caseElement){var anchor=selectedTransclude.element;selectedElements.push(caseElement),$animate.enter(caseElement,anchor.parent(),anchor)})}))})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:500,require:"^ngSwitch",compile:function(element,attrs,transclude){return function(scope,element,attr,ctrl){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:transclude,element:element})}}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:500,require:"^ngSwitch",compile:function(element,attrs,transclude){return function(scope,element,attr,ctrl){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:transclude,element:element})}}}),ngTranscludeDirective=ngDirective({controller:["$transclude","$element","$scope",function($transclude,$element,$scope){$scope.$evalAsync(function(){$transclude(function(clone){$element.append(clone)})})}]}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsDirective=valueFn({terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w\d]*)|(?:\(\s*([\$\w][\$\w\d]*)\s*,\s*([\$\w][\$\w\d]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value){optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove())},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function Single(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function Multiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=copy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function Options(scope,selectElement,ctrl){function render(){var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionGroups={"":[]},optionGroupNames=[""],modelValue=ctrl.$modelValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,locals={},selectedSet=!1;if(multiple)if(trackFn&&isArray(modelValue)){selectedSet=new HashMap([]);for(var trackIndex=0;trackIndex<modelValue.length;trackIndex++)locals[valueName]=modelValue[trackIndex],selectedSet.put(trackFn(scope,locals),modelValue[trackIndex])}else selectedSet=new HashMap(modelValue);for(index=0;length=keys.length,length>index;index++){if(locals[valueName]=values[keyName?locals[keyName]=keys[index]:index],optionGroupName=groupByFn(scope,locals)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),multiple)selected=selectedSet.remove(trackFn?trackFn(scope,locals):valueFn(scope,locals))!=undefined;
else{if(trackFn){var modelCast={};modelCast[valueName]=modelValue,selected=trackFn(scope,modelCast)===trackFn(scope,locals)}else selected=modelValue===valueFn(scope,locals);selectedSet=selectedSet||selected}label=displayFn(scope,locals),label=label===undefined?"":label,optionGroup.push({id:trackFn?trackFn(scope,locals):keyName?keys[index]:index,label:label,selected:selected})}for(multiple||(nullOption||null===modelValue?optionGroups[""].unshift({id:"",label:"",selected:!selectedSet}):selectedSet||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&lastElement.text(existingOption.label=option.label),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&lastElement.prop("selected",existingOption.selected=option.selected)):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).attr("selected",option.selected).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)existingOptions.pop().element.remove()}for(;optionGroupsCache.length>groupIndex;)optionGroupsCache.pop()[0].element.remove()}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw minErr("ngOptions")("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,optionGroupsCache=[[{element:selectElement,label:""}]];nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.html(""),selectElement.on("change",function(){scope.$apply(function(){var optionGroup,key,value,optionElement,index,groupIndex,length,groupLength,collection=valuesFn(scope)||[],locals={};if(multiple){for(value=[],groupIndex=0,groupLength=optionGroupsCache.length;groupLength>groupIndex;groupIndex++)for(optionGroup=optionGroupsCache[groupIndex],index=1,length=optionGroup.length;length>index;index++)if((optionElement=optionGroup[index].element)[0].selected){if(key=optionElement.val(),keyName&&(locals[keyName]=key),trackFn)for(var trackIndex=0;trackIndex<collection.length&&(locals[valueName]=collection[trackIndex],trackFn(scope,locals)!=key);trackIndex++);else locals[valueName]=collection[key];value.push(valueFn(scope,locals))}}else if(key=selectElement.val(),"?"==key)value=undefined;else if(""==key)value=null;else if(trackFn){for(var trackIndex=0;trackIndex<collection.length;trackIndex++)if(locals[valueName]=collection[trackIndex],trackFn(scope,locals)==key){value=valueFn(scope,locals);break}}else locals[valueName]=collection[key],keyName&&(locals[keyName]=key),value=valueFn(scope,locals);ctrl.$setViewValue(value)})}),ctrl.$render=render,scope.$watch(render)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""==children[i].value){emptyOption=nullOption=children.eq(i);break}if(selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(attr.required||attr.ngRequired)){var requiredValidator=function(value){return ngModelCtrl.$setValidity("required",!attr.required||value&&value.length),value};ngModelCtrl.$parsers.push(requiredValidator),ngModelCtrl.$formatters.unshift(requiredValidator),attr.$observe("required",function(){requiredValidator(ngModelCtrl.$viewValue)})}optionsExp?Options(scope,element,ngModelCtrl):multiple?Multiple(scope,element,ngModelCtrl):Single(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound?element.prop("selected",!1):selectCtrl=nullSelectCtrl,interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),newVal!==oldVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal)}):selectCtrl.addOption(attr.value),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!0});bindJQuery(),publishExternalAPI(angular),jqLite(document).ready(function(){angularInit(document,bootstrap)})}(window,document),angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}</style>'),define("angular",function(global){return function(){var ret;return ret||global.angular}}(this)),define("filters/filters",["angular"],function(angular){var module=angular.module("app.filters",[]);return module}),function(window,angular,undefined){var $resourceMinErr=angular.$$minErr("$resource");angular.module("ngResource",["ng"]).factory("$resource",["$http","$parse","$q",function($http,$parse,$q){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=defaults||{},this.urlParams={}}function ResourceFactory(url,paramDefaults,actions){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?getter(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){copy(value||{},this)}var route=new Route(url);return actions=extend({},DEFAULT_ACTIONS,actions),forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=data instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){"params"!=key&&"isArray"!=key&&"interceptor"!=key&&(httpConfig[key]=copy(value))}),httpConfig.data=data,route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!=!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration. Expected response to contain an {0} but got an {1}",action.isArray?"array":"object",angular.isArray(data)?"array":"object");action.isArray?(value.length=0,forEach(data,function(item){value.push(new Resource(item))})):(copy(data,value),value.$promise=promise)}return value.$resolved=!0,(success||noop)(value,response.headers),response.resource=value,response},function(response){return value.$resolved=!0,(error||noop)(response),$q.reject(response)}).then(responseInterceptor,responseErrorInterceptor);return isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name](params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return ResourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var DEFAULT_ACTIONS={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}},noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction,getter=function(obj,path){return $parse(path)(obj)};return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),encodedVal+"$1")):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),url=url.replace(/\/+$/,""),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},ResourceFactory}])}(window,window.angular),define("ngResource",["angular"],function(global){return function(){var ret;return ret||global.$resource}}(this)),define("services/services",["angular","ngResource"],function(angular){var module=angular.module("app.services",["ngResource"]);return module}),define("directives/directives",["angular","filters/filters","services/services"],function(angular){var module=angular.module("app.directives",["app.filters","app.services"]);return module}),define("common/utils",[],function(){var module={},getThemePath=function(){return window.Global.themePath},getViewBasePath=function(){return getThemePath()+"/modules/html_editor/partials/"};module.getViewBasePath=getViewBasePath;var resolveTemplateUrl=function(templatePath){return getViewBasePath()+templatePath};return module.resolveTemplateUrl=resolveTemplateUrl,module.isBlank=function(input){return"undefined"==typeof input||null==input?!0:/^\s*$/.test(input)},module.camel2Snake=function(input,splitChar){module.isBlank(splitChar)&&(splitChar="-");var out=input.replace(/^\s*/,"");return out=out.replace(/^[a-z]|[^\s][A-Z]/g,function(str,offset){return 0==offset?str.toLowerCase():str.substr(0,1)+splitChar+str.substr(1).toLowerCase()})},module.newGuid=function(){for(var guid="",i=1;32>=i;i++){var n=Math.floor(16*Math.random()).toString(16);guid+=n,(8==i||12==i||16==i||20==i)&&(guid+="-")}return guid},module.getParameter=function(paras,url){for(var paraString=url.substring(url.indexOf("?")+1,url.length).split("&"),paraObj={},i=0;j=paraString[i];i++)paraObj[j.substring(0,j.indexOf("=")).toLowerCase()]=j.substring(j.indexOf("=")+1,j.length);var returnValue=paraObj[paras.toLowerCase()];return"undefined"==typeof returnValue?"":returnValue},module.formatXml=function(xml){var formatted="",reg1=/[\r|\n]+/g;xml=xml.replace(reg1,"");var reg=/(>)\s{0,}(<)(\/*)/g;xml=xml.replace(reg,"$1\r\n$2$3");var pad=0;return jQuery.each(xml.split("\r\n"),function(index,_node){var indent=0,node=_.str.trim(_node);node.match(/.+<\/\w[^>]*>$/)?indent=0:node.match(/^<\/\w/)?0!=pad&&(pad-=1):indent=node.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var padding="",i=0;pad>i;i++)padding+="  ";formatted+=padding+node+"\r\n",pad+=indent}),formatted},module.urls={urlParam:function(url,param){if(!url)return"";if(!param||param.length<1)return url+"";for(var _url=url.indexOf("?")>-1?url+"&":url+"?",i=0;i<param.length;++i)_url+=0==i?param[i].key+"="+encodeURIComponent(param[i].value):"&"+param[i].key+"="+encodeURIComponent(param[i].value);return _url},appendParam:function(url,paramName,paramVal){if(!paramName)return url+"";(null==paramVal||"undefined"==typeof paramVal)&&(paramVal="");var _url=url.indexOf("?")>0?url+"&":url+"?";return _url+=paramName+"="+encodeURIComponent(paramVal)}},module}),define("common/classLoader",[],function(){var classes={},module={};return module.classes=classes,module.register=function(moduleName,moduleConfig){classes[moduleName]=moduleConfig},module.getModule=function(moduleName){return classes[moduleName]},module.getAllModules=function(){var allModules=[];return $.each(classes,function(i,item){allModules.push(item)}),allModules},module}),function($){function scanTable($table){var m=[];$("tr",$table).each(function(y,row){$("td,th",row).each(function(x,cell){var tx,ty,$cell=$(cell),cspan=0|$cell.attr("colspan"),rspan=0|$cell.attr("rowspan");for(cspan=cspan?cspan:1,rspan=rspan?rspan:1;m[y]&&m[y][x];++x);for(tx=x;x+cspan>tx;++tx)for(ty=y;y+rspan>ty;++ty)m[ty]||(m[ty]=[]),m[ty][tx]=!0;var pos={top:y,left:x};$cell.data("cellPos",pos)})})}$.fn.cellPos=function(rescan){var $cell=this.first(),pos=$cell.data("cellPos");if(!pos||rescan){var $table=$cell.closest("table");scanTable($table)}return pos=$cell.data("cellPos")}}(jQuery),define("cellPos",function(){}),define("common/domUtils",["cellPos"],function(){var module={},$mainContainer=$("#edit-page-designer"),binWrapperClass="_i-wrapper",containerWrapperClass="i-layout-info",containerClass="i-column",isInMainContainer=function(position){var l=$mainContainer.offset().left,t=$mainContainer.offset().top,r=l+$mainContainer[0].scrollWidth,b=t+$mainContainer[0].scrollHeight;return position.x>l&&position.x<r&&position.y>t&&position.y<b?!0:void 0};module.isNotNeedFocus=function(el){var notNeed=!1;return module.isMainContainer(el)&&(notNeed=!0),el.closest(".tab-pane-placeholder").length>0&&(notNeed=!0),notNeed};{var getBinWrapper=(module.isMainContainer=function(el){return $(el).attr("id")==$mainContainer.attr("id")},module.getBinWrapper=function(el){var binWrapper=$(el).closest("."+binWrapperClass);return 0==binWrapper.length?null:binWrapper}),containerWrapperTag=(module.isBinWrapper=function(el){return $(el).hasClass(binWrapperClass)},["table","tr","ul","ol","tbody"]),isContainerWrapper=module.isContainerWrapper=function(el){var $el=$(el);if($el.hasClass(containerWrapperClass)||el.hasClass(binWrapperClass))return!0;var tagName=$el.prop("tagName").toLowerCase();return _.contains(containerWrapperTag,tagName)?!0:!1},containerItemTag=["td","th","li","caption"],isContainerItem=module.isContainerItem=function(el){var $el=$(el);if($el.hasClass(containerClass))return!0;var tagName=$el.prop("tagName").toLowerCase();return _.contains(containerItemTag,tagName)?!0:!1},unDraggableTag=["td","th","caption"],unDeleteTag=(module.canDraggable=function(el){var $el=$(el);if($el.hasClass("unDraggable"))return!1;var tagName=$el.prop("tagName").toLowerCase();return _.contains(unDraggableTag,tagName)?!1:!0},["td","th","caption"]),getTd=(module.canDelete=function(el){var $el=$(el),tagName=$el.prop("tagName").toLowerCase();return _.contains(unDeleteTag,tagName)?!1:!0},module.getTdIndex=function($td){return $td.cellPos().left},module.getTd=function($tr,tdIndex){var selectedTd=null;return $("td,th",$tr).each(function(){var $td=$(this),left=$td.cellPos(!0).left,colspan=$td.attr("colspan")?parseInt($td.attr("colspan")):1;return tdIndex>=left&&left+colspan-1>=tdIndex?(selectedTd=$td,!1):void 0}),null==selectedTd?null:{td:selectedTd,cellPos:$(selectedTd).cellPos(),colspan:$(selectedTd).attr("colspan")?parseInt($(selectedTd).attr("colspan")):1,rowspan:$(selectedTd).attr("rowspan")?parseInt($(selectedTd).attr("rowspan")):1}});module.removeTd=function($tr,tdIndex){var selectedTd=getTd($tr,tdIndex);null!=selectedTd&&(selectedTd.colspan>1?$(selectedTd.td).attr("colspan",selectedTd.colspan-1):$(selectedTd.td).remove())},module.insertTd=function($tr,tdIndex,$td){var selectedTd=getTd($tr,tdIndex);return null==selectedTd?null:void(tdIndex>=selectedTd.cellPos.left+selectedTd.colspan-1?$(selectedTd.td).after($td):$(selectedTd.td).attr("colspan",selectedTd.colspan+1))}}return module.focusFinder=function(){function find(event,$el){var newEl=getBinWrapper($el);if(null!=newEl)return newEl;var tag=$el.prop("tagName").toLowerCase();if($.isFunction(finder.tagFinder[tag])&&(newEl=finder.tagFinder[tag](event,$el)),null!=newEl)return newEl;var cssClass=$el.attr("class")||"";return $.each(cssClass.split("s+"),function(i,item){var cssName=item.toLowerCase();return $.isFunction(finder.cssFinder[cssName])&&(newEl=finder.cssFinder[cssName](event,$el)),null!=newEl?!1:void 0}),null==newEl&&(newEl=$el),newEl}var finder={tagFinder:{},cssFinder:{}};return finder.tagFinder.li=function(event,$el){return $el.closest("ul")},finder.tagFinder.td=function(event,$el){var l=$el.offset().left,t=$el.offset().top,r=l+event.target.offsetWidth,b=t+event.target.offsetHeight;return event.pageY>t+5&&event.pageY<b-5&&event.pageX>l+5&&event.pageX<r-5?void 0:$el.closest("table")},{find:find}}(),module.draggable=function(el,options){function createPlaceHolder(){var pl=$('<div id="i-bin-overlay" class="i-bin-overlay-horizontal i-bin-overlay-arrow " style="display: none; position: relative; left: auto; right: auto; float: none; margin: -1px 0px -1px -1px; top: 0px;"><div class="i-bin-overlay-nub1"></div><div class="i-bin-overlay-nub2"></div><div class="i-bin-overlay-arrow"></div></div>');placeHolder={pl:pl,curDropEl:null,visible:!1}}function destroyPlaceHolder(){placeHolder.pl.remove(),placeHolder=null}function movePlaceHolder(event,ui,options){var position={x:event.pageX-40,y:event.pageY+20};if(!isInMainContainer(position))return placeHolder.pl.hide(),void(placeHolder.visible=!1);var curDropEl=$(document.elementFromPoint(position.x-window.pageXOffset,position.y-window.pageYOffset));if("i-bin-overlay"===curDropEl.attr("id")||curDropEl.closest("#i-bin-overlay").length>0||0==curDropEl.length)return placeHolder.pl.hide(),void(placeHolder.visible=!1);var wrapper=(preDropEl.el==curDropEl?preDropEl.Wrapper:getBinWrapper(curDropEl))||curDropEl,dType=preDropEl.el==curDropEl?preDropEl.dType:getDirectionType(wrapper),direction=intersect(wrapper,position,dType);return"in"===placeHolder.direction&&"in"!==direction?(placeHolder.pl.hide(),void(placeHolder.visible=!1)):preDropEl.el==curDropEl&&preDropEl.direction==direction?(placeHolder.pl.hide(),void(placeHolder.visible=!1)):$.isFunction(options.refuse)&&options.refuse(event,ui,curDropEl,direction)?(placeHolder.pl.hide(),void(placeHolder.visible=!1)):(placeHolder.pl.show(),placeHolder.visible=!0,placeHolder.curDropEl=curDropEl,placeHolder.direction=direction,"top"==direction?wrapper.before(placeHolder.pl):"bottom"==direction?wrapper.after(placeHolder.pl):wrapper.append(placeHolder.pl),preDropEl.el=curDropEl,preDropEl.direction=direction,preDropEl.dType=dType,void(preDropEl.Wrapper=wrapper))}function intersect(dEl,position,dType){var val="in",t=dEl.offset().top,b=t+dEl[0].offsetHeight;return val="inner"==dType?"in":"outer"==dType?position.y<(t+b)/2?"top":"bottom":position.y<t+15?"top":position.y>b-15?"bottom":"in"}function getDirectionType(dEl){var type="all";return type=isContainerWrapper(dEl)?"outer":isContainerItem(dEl)?"inner":"all"}var placeHolder={},preDropEl={},exOptions=$.extend({},options,{zIndex:1e4,handle:".i-titlebar-move",opacity:.35,appendTo:"div#myHelperHolder",revert:!0,cursorAt:{top:-10,left:120},helper:function(){var html="<div class='editFocus'> <div class='editFocusStdChrome'>		<div class='editFocusFrame editFocusFrameLEFT'  style='height: 28px; left: -6px; top: -6px; '></div>		<div class='editFocusFrame editFocusFrameRIGHT' style='height: 28px; left: 242px; top: -6px; '></div>		<div class='editFocusFrame editFocusFrameTOP'  style='width: 250px; left: -6px; top: -6px; '></div>		<div class='editFocusFrame editFocusFrameBOTTOM' style='width: 250px;left: -6px; top: 22px; '></div>	</div>	<div class='i-titlebar i-titlebar-active active' style='left: 120px;'>		<div class='i-titlebar-wrap'>		<div class='i-titlebar-padding'></div>			<a class='i-titlebar-move i-titlebar-button ' data-tooltip='Drag to Move'><span class='icon'></span></a>			<div class='i-titlebar-tooltip'>				<span class='icon'></span>Drag above, below or to the sides of any	module.			</div>		</div>	</div></div>";return html},start:function(event,ui){createPlaceHolder(),$.isFunction(options.start)&&options.start(event,ui,placeHolder)},drag:function(event,ui){movePlaceHolder(event,ui,options),$.isFunction(options.drag)&&options.drag(event,ui,placeHolder),$(this).draggable("option","revert",!placeHolder.visible)},stop:function(event,ui){ui.item=$(this),placeHolder.visible&&$.isFunction(options.accept)&&options.accept(event,ui,placeHolder),$.isFunction(options.stop)&&options.stop(event,ui,placeHolder),destroyPlaceHolder()}});$(el).draggable(exOptions),module.defaultRefuse=function(event,ui,placeholder,newAddItemDom){var parentTag,$parent,embeds={li:"ul",th:"tr",td:"tr"},curDropEl=placeholder.curDropEl,direction=placeholder.direction;$parent="in"==direction?curDropEl:curDropEl.parent(),parentTag=$parent.prop("tagName").toLowerCase();var childName=newAddItemDom.prop("tagName").toLowerCase();return embeds[childName]&&embeds[childName]!=parentTag?!0:!1}},module}),function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.5.2";var A=j.each=j.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(E);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(E);return r},j.find=j.detect=function(n,t,r){var e;return O(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var O=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?-1!=n.indexOf(t):O(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,function(n){return n[t]})},j.where=function(n,t,r){return j.isEmpty(t)?r?void 0:[]:j[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},j.findWhere=function(n,t){return j.where(n,t,!0)},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&j.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>e.computed&&(e={value:n,computed:a})}),e.value},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&j.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return arguments.length<2||r?n[j.random(n.length-1)]:j.shuffle(n).slice(0,Math.max(0,t))};var k=function(n){return j.isFunction(n)?n:function(t){return t[n]}};j.sortBy=function(n,t,r){var e=k(t);return j.pluck(j.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={},i=null==r?j.identity:k(r);return A(t,function(r,a){var o=i.call(e,r,a,t);n(u,o,r)}),u}};j.groupBy=F(function(n,t,r){(j.has(n,t)?n[t]:n[t]=[]).push(r)}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=null==r?j.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.indexOf(t,n)>=0})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:new Date,a=null,i=n.apply(e,u)};return function(){var l=new Date;o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u)):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o;return function(){i=this,u=arguments,a=new Date;var c=function(){var l=new Date-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u)))},l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u)),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=w||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]
}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)void 0===n[r]&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return void 0===n},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=j.invert(I.escape);var T={escape:new RegExp("["+j.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(I.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(T[n],function(t){return I[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(){}),!function(root,String){var nativeTrim=String.prototype.trim,nativeTrimRight=String.prototype.trimRight,nativeTrimLeft=String.prototype.trimLeft,parseNumber=function(source){return 1*source||0},strRepeat=function(str,qty){if(1>qty)return"";for(var result="";qty>0;)1&qty&&(result+=str),qty>>=1,str+=str;return result},slice=[].slice,defaultToWhiteSpace=function(characters){return null==characters?"\\s":characters.source?characters.source:"["+_s.escapeRegExp(characters)+"]"},escapeChars={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},reversedEscapeChars={};for(var key in escapeChars)reversedEscapeChars[escapeChars[key]]=key;reversedEscapeChars["'"]="#39";var sprintf=function(){function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}var str_repeat=strRepeat,str_format=function(){return str_format.cache.hasOwnProperty(arguments[0])||(str_format.cache[arguments[0]]=str_format.parse(arguments[0])),str_format.format.call(null,str_format.cache[arguments[0]],arguments)};return str_format.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,cursor=1,tree_length=parse_tree.length,node_type="",output=[];for(i=0;tree_length>i;i++)if(node_type=get_type(parse_tree[i]),"string"===node_type)output.push(parse_tree[i]);else if("array"===node_type){if(match=parse_tree[i],match[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf('[_.sprintf] property "%s" does not exist',match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if(/[^s]/.test(match[8])&&"number"!=get_type(arg))throw new Error(sprintf("[_.sprintf] expecting number but found %s",get_type(arg)));switch(match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":arg=parseInt(arg,10);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg=Math.abs(arg);break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}arg=/[def]/.test(match[8])&&match[3]&&arg>=0?"+"+arg:arg,pad_character=match[4]?"0"==match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-String(arg).length,pad=match[6]?str_repeat(pad_character,pad_length):"",output.push(match[5]?arg+pad:pad+arg)}return output.join("")},str_format.cache={},str_format.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=/^[^\x25]+/.exec(_fmt)))parse_tree.push(match[0]);else if(null!==(match=/^\x25{2}/.exec(_fmt)))parse_tree.push("%");else{if(null===(match=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(_fmt)))throw new Error("[_.sprintf] huh?");if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=/^([a-z_][a-z_\d]*)/i.exec(replacement_field)))throw new Error("[_.sprintf] huh?");for(field_list.push(field_match[1]);""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=/^\.([a-z_][a-z_\d]*)/i.exec(replacement_field)))field_list.push(field_match[1]);else{if(null===(field_match=/^\[(\d+)\]/.exec(replacement_field)))throw new Error("[_.sprintf] huh?");field_list.push(field_match[1])}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree.push(match)}_fmt=_fmt.substring(match[0].length)}return parse_tree},str_format}(),_s={VERSION:"2.3.0",isBlank:function(str){return null==str&&(str=""),/^\s*$/.test(str)},stripTags:function(str){return null==str?"":String(str).replace(/<\/?[^>]+>/g,"")},capitalize:function(str){return str=null==str?"":String(str),str.charAt(0).toUpperCase()+str.slice(1)},chop:function(str,step){return null==str?[]:(str=String(str),step=~~step,step>0?str.match(new RegExp(".{1,"+step+"}","g")):[str])},clean:function(str){return _s.strip(str).replace(/\s+/g," ")},count:function(str,substr){if(null==str||null==substr)return 0;str=String(str),substr=String(substr);for(var count=0,pos=0,length=substr.length;;){if(pos=str.indexOf(substr,pos),-1===pos)break;count++,pos+=length}return count},chars:function(str){return null==str?[]:String(str).split("")},swapCase:function(str){return null==str?"":String(str).replace(/\S/g,function(c){return c===c.toUpperCase()?c.toLowerCase():c.toUpperCase()})},escapeHTML:function(str){return null==str?"":String(str).replace(/[&<>"']/g,function(m){return"&"+reversedEscapeChars[m]+";"})},unescapeHTML:function(str){return null==str?"":String(str).replace(/\&([^;]+);/g,function(entity,entityCode){var match;return entityCode in escapeChars?escapeChars[entityCode]:(match=entityCode.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(match[1],16)):(match=entityCode.match(/^#(\d+)$/))?String.fromCharCode(~~match[1]):entity})},escapeRegExp:function(str){return null==str?"":String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(str,i,howmany,substr){var arr=_s.chars(str);return arr.splice(~~i,~~howmany,substr),arr.join("")},insert:function(str,i,substr){return _s.splice(str,i,0,substr)},include:function(str,needle){return""===needle?!0:null==str?!1:-1!==String(str).indexOf(needle)},join:function(){var args=slice.call(arguments),separator=args.shift();return null==separator&&(separator=""),args.join(separator)},lines:function(str){return null==str?[]:String(str).split("\n")},reverse:function(str){return _s.chars(str).reverse().join("")},startsWith:function(str,starts){return""===starts?!0:null==str||null==starts?!1:(str=String(str),starts=String(starts),str.length>=starts.length&&str.slice(0,starts.length)===starts)},endsWith:function(str,ends){return""===ends?!0:null==str||null==ends?!1:(str=String(str),ends=String(ends),str.length>=ends.length&&str.slice(str.length-ends.length)===ends)},succ:function(str){return null==str?"":(str=String(str),str.slice(0,-1)+String.fromCharCode(str.charCodeAt(str.length-1)+1))},titleize:function(str){return null==str?"":String(str).replace(/(?:^|\s)\S/g,function(c){return c.toUpperCase()})},camelize:function(str){return _s.trim(str).replace(/[-_\s]+(.)?/g,function(match,c){return c?c.toUpperCase():""})},underscored:function(str){return _s.trim(str).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(str){return _s.trim(str).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(str){return _s.titleize(String(str).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(str){return _s.capitalize(_s.underscored(str).replace(/_id$/,"").replace(/_/g," "))},trim:function(str,characters){return null==str?"":!characters&&nativeTrim?nativeTrim.call(str):(characters=defaultToWhiteSpace(characters),String(str).replace(new RegExp("^"+characters+"+|"+characters+"+$","g"),""))},ltrim:function(str,characters){return null==str?"":!characters&&nativeTrimLeft?nativeTrimLeft.call(str):(characters=defaultToWhiteSpace(characters),String(str).replace(new RegExp("^"+characters+"+"),""))},rtrim:function(str,characters){return null==str?"":!characters&&nativeTrimRight?nativeTrimRight.call(str):(characters=defaultToWhiteSpace(characters),String(str).replace(new RegExp(characters+"+$"),""))},truncate:function(str,length,truncateStr){return null==str?"":(str=String(str),truncateStr=truncateStr||"...",length=~~length,str.length>length?str.slice(0,length)+truncateStr:str)},prune:function(str,length,pruneStr){if(null==str)return"";if(str=String(str),length=~~length,pruneStr=null!=pruneStr?String(pruneStr):"...",str.length<=length)return str;var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?"A":" "},template=str.slice(0,length+1).replace(/.(?=\W*\w*$)/g,tmpl);return template=template.slice(template.length-2).match(/\w\w/)?template.replace(/\s*\S+$/,""):_s.rtrim(template.slice(0,template.length-1)),(template+pruneStr).length>str.length?str:str.slice(0,template.length)+pruneStr},words:function(str,delimiter){return _s.isBlank(str)?[]:_s.trim(str,delimiter).split(delimiter||/\s+/)},pad:function(str,length,padStr,type){str=null==str?"":String(str),length=~~length;var padlen=0;switch(padStr?padStr.length>1&&(padStr=padStr.charAt(0)):padStr=" ",type){case"right":return padlen=length-str.length,str+strRepeat(padStr,padlen);case"both":return padlen=length-str.length,strRepeat(padStr,Math.ceil(padlen/2))+str+strRepeat(padStr,Math.floor(padlen/2));default:return padlen=length-str.length,strRepeat(padStr,padlen)+str}},lpad:function(str,length,padStr){return _s.pad(str,length,padStr)},rpad:function(str,length,padStr){return _s.pad(str,length,padStr,"right")},lrpad:function(str,length,padStr){return _s.pad(str,length,padStr,"both")},sprintf:sprintf,vsprintf:function(fmt,argv){return argv.unshift(fmt),sprintf.apply(null,argv)},toNumber:function(str,decimals){return str?(str=_s.trim(str),str.match(/^-?\d+(?:\.\d+)?$/)?parseNumber(parseNumber(str).toFixed(~~decimals)):0/0):0},numberFormat:function(number,dec,dsep,tsep){if(isNaN(number)||null==number)return"";number=number.toFixed(~~dec),tsep="string"==typeof tsep?tsep:",";var parts=number.split("."),fnums=parts[0],decimals=parts[1]?(dsep||".")+parts[1]:"";return fnums.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+tsep)+decimals},strRight:function(str,sep){if(null==str)return"";str=String(str),sep=null!=sep?String(sep):sep;var pos=sep?str.indexOf(sep):-1;return~pos?str.slice(pos+sep.length,str.length):str},strRightBack:function(str,sep){if(null==str)return"";str=String(str),sep=null!=sep?String(sep):sep;var pos=sep?str.lastIndexOf(sep):-1;return~pos?str.slice(pos+sep.length,str.length):str},strLeft:function(str,sep){if(null==str)return"";str=String(str),sep=null!=sep?String(sep):sep;var pos=sep?str.indexOf(sep):-1;return~pos?str.slice(0,pos):str},strLeftBack:function(str,sep){if(null==str)return"";str+="",sep=null!=sep?""+sep:sep;var pos=str.lastIndexOf(sep);return~pos?str.slice(0,pos):str},toSentence:function(array,separator,lastSeparator,serial){separator=separator||", ",lastSeparator=lastSeparator||" and ";var a=array.slice(),lastMember=a.pop();return array.length>2&&serial&&(lastSeparator=_s.rtrim(separator)+lastSeparator),a.length?a.join(separator)+lastSeparator+lastMember:lastMember},toSentenceSerial:function(){var args=slice.call(arguments);return args[3]=!0,_s.toSentence.apply(_s,args)},slugify:function(str){if(null==str)return"";var from="ąàáäâãåæćęèéëêìíïîłńòóöôõøśùúüûñçżź",to="aaaaaaaaceeeeeiiiilnoooooosuuuunczz",regex=new RegExp(defaultToWhiteSpace(from),"g");return str=String(str).toLowerCase().replace(regex,function(c){var index=from.indexOf(c);return to.charAt(index)||"-"}),_s.dasherize(str.replace(/[^\w\s-]/g,""))},surround:function(str,wrapper){return[wrapper,str,wrapper].join("")},quote:function(str){return _s.surround(str,'"')},exports:function(){var result={};for(var prop in this)this.hasOwnProperty(prop)&&!prop.match(/^(?:include|contains|reverse)$/)&&(result[prop]=this[prop]);return result},repeat:function(str,qty,separator){if(null==str)return"";if(qty=~~qty,null==separator)return strRepeat(String(str),qty);for(var repeat=[];qty>0;repeat[--qty]=str);return repeat.join(separator)},naturalCmp:function(str1,str2){if(str1==str2)return 0;if(!str1)return-1;if(!str2)return 1;for(var cmpRegex=/(\.\d+)|(\d+)|(\D+)/g,tokens1=String(str1).toLowerCase().match(cmpRegex),tokens2=String(str2).toLowerCase().match(cmpRegex),count=Math.min(tokens1.length,tokens2.length),i=0;count>i;i++){var a=tokens1[i],b=tokens2[i];if(a!==b){var num1=parseInt(a,10);if(!isNaN(num1)){var num2=parseInt(b,10);if(!isNaN(num2)&&num1-num2)return num1-num2}return b>a?-1:1}}return tokens1.length===tokens2.length?tokens1.length-tokens2.length:str2>str1?-1:1},levenshtein:function(str1,str2){if(null==str1&&null==str2)return 0;if(null==str1)return String(str2).length;if(null==str2)return String(str1).length;str1=String(str1),str2=String(str2);for(var prev,value,current=[],i=0;i<=str2.length;i++)for(var j=0;j<=str1.length;j++)value=i&&j?str1.charAt(j-1)===str2.charAt(i-1)?prev:Math.min(current[j],current[j-1],prev)+1:i+j,prev=current[j],current[j]=value;return current.pop()}};_s.strip=_s.trim,_s.lstrip=_s.ltrim,_s.rstrip=_s.rtrim,_s.center=_s.lrpad,_s.rjust=_s.lpad,_s.ljust=_s.rpad,_s.contains=_s.include,_s.q=_s.quote,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=_s),exports._s=_s),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return _s}),root._=root._||{},root._.string=root._.str=_s}(this,String),define("usStrings",["underscore"],function(global){return function(){var ret;return ret||global.usStrings}}(this)),define("common/eventBase",["usStrings"],function(){var EventBase=Class.extend({allListeners:null,init:function(){},getListener:function(type){return type=type.toLowerCase(),null==this.allListeners&&(this.allListeners={}),null==this.allListeners[type]&&(this.allListeners[type]=[]),this.allListeners[type]},removeItem:function(array,item){for(var i=0,l=array.length;l>i;i++)array[i]===item&&(array.splice(i,1),i--)},on:function(types,listener){types=_.str.trim(types).split(" ");for(var ti,i=0;ti=types[i++];)this.getListener(ti).push(listener)},off:function(types,listener){types=_.str.trim(types).split(" ");for(var ti,i=0;ti=types[i++];)this.removeItem(this.getListener(ti),listener)},trigger:function(){var types=arguments[0],args=[];$.each(arguments,function(i,item){0!=i&&args.push(item)}),types=_.str.trim(types).split(" ");for(var ti,i=0;ti=types[i++];){var r,t,k,listeners=this.getListener(ti);if(listeners)for(k=listeners.length;k--;)if(listeners[k]){if(t=listeners[k].apply(this,args),t===!0)return t;void 0!==t&&(r=t)}(t=this["on"+ti.toLowerCase()])&&(r=t.apply(this,args))}return r}});return EventBase}),define("services/appPd",["services/services","common/eventBase","common/utils"],function(serviceModule,EventBase,utils){var PD=EventBase.extend({paletteItemAddClass:"i-palette-item",containerAddClass:"i-container",layoutAddClass:"row-fluid",columnAddClass:"i-column",$scope:null,focus:null,init:function(){this._super(),this.$scope=null,this.bin={},this.bin.binModuleBaseOptions={canDrag:!0,canDelete:!0,canSetting:!0,getInitData:function(tElement,tAttrs){var $attr={};for(var key in tAttrs)if(tAttrs.hasOwnProperty(key)){if("pdBin"==key||"binId"==key||_.str.startsWith(key,"ng")||_.str.startsWith(key,"$"))continue;$attr[key]=tAttrs[key]}var data=$.extend($attr,{editable:!1});return data},actived:function($scope){$scope.data.editable=!0},disActived:function($scope){$scope.data.editable=!1},getCompiledHtml:function($compile,$scope,$ui,sidebarItem){return $compile(sidebarItem.compileHtml)($scope)}},this.bin.binModuleItemUniqueOptions=$.extend({},this.bin.binModuleBaseOptions,{paletteItemPostProcess:function($el){$el.on("enableDrag",function(){$el.draggable("enable")}),$el.on("disableDrag",function(){$el.draggable("disable")})}}),this.draggableOptions={refuse:function(event,ui,curDropEl){return $(curDropEl).closest(".tab-pane-placeholder").length>0?!0:!1}}},setScope:function(scope){this.$scope=scope},setFocus:function(focus){this.focus=focus,this.trigger("focusChanged",focus)},getFocus:function(){return this.focus},refreshFocus:function(){var me=this;null!=this.focus&&window.setTimeout(function(){me.focus.frameScope.$apply(function(){me.focus.frameScope.refresh(),me.trigger("focusRefreshed",me.focus)})},100)},close:function(val){var iframeId=this.$scope.iframeId;return!utils.isBlank(iframeId)&&window.parent.Page?void window.parent.Page.closeIframe(iframeId,val):(window.returnValue=val,void window.close())}});return window.pd||(window.pd=new PD),serviceModule.factory("appConfig",["$compile","$rootScope",function(){return window.pd}]),window.pd}),define("directives/pdContainer",["angular","directives/directives","common/utils","common/classLoader","common/domUtils","services/appPd"],function(angular,directiveModule,utils,classLoader,domUtils,appConfig){var directive=directiveModule.directive("pdContainer",function(){var directiveDefinition={priority:0,transclude:!1,restrict:"A",link:function($scope,iElement){var $el=$(iElement);$el.addClass(appConfig.containerAddClass),$el.on("click",function(event){var curEl=$(event.target),elType="html",focusEl=null;domUtils.isNotNeedFocus(curEl)?focusEl=null:(focusEl=domUtils.focusFinder.find(event,curEl),domUtils.isBinWrapper(focusEl)&&(elType="bin")),$scope.$apply(function(){$scope.$emit("focusChanged.angular",{el:focusEl,type:elType})})})}};return directiveDefinition});return directive}),define("services/sidebarItems",["angular","services/services","common/utils","common/classLoader"],function(angular,serviceModule,utils,classLoader){var service={},items=[{name:"layouts",html:"布局控件",icon:"icon-text-width",href:"javascript://",active:!1,items:[]},{name:"controls",html:"基本控件",icon:"icon-desktop",href:"javascript://",active:!1,items:[]},{name:"fields",html:"实体字段",icon:"icon-edit",href:"javascript://",active:!0,items:[]},{name:"relations",html:"实体关系",icon:"icon-tag",href:"javascript://",active:!1,items:[]},{name:"templates",html:"表单分组",icon:"icon-dashboard",href:"javascript://",active:!1,items:[]}];service.items=items;{var flatItems={};service.getItems=function(){return items}}service.getItemInFlat=function(itemName){return utils.isBlank(itemName)?null:flatItems[itemName]};var getItem=service.getItem=function(itemName){if(utils.isBlank(itemName))return null;itemName=itemName.toLowerCase();var selectedItem=null;return $.each(items,function(i,item){return item.name.toLowerCase()==itemName?(selectedItem=item,!1):void 0}),selectedItem},addItem=service.addItem=function(parentName,item){var parent=getItem(parentName);utils.isBlank(parent)||(utils.isBlank(parent.items)&&(parent.items=[]),parent.items.push(item))},createItem=service.createItem=function(parentName,instance){var item=instance||{};item.html=instance.paletteItemHtml,item.href=instance.href,item.icon=instance.icon,item.refuse=instance.refuse,item.items=[],addItem(parentName,item),flatItems[item.name]=item};return serviceModule.factory("sidebarItems",["$resource",function(){function init(){var allModules=classLoader.classes;$.each(allModules,function(i,module){if(module.getSidebarItems){var items=module.getSidebarItems();$.isArray(items)?$.each(items,function(i,item){createItem(item.parentName,item)}):$.isPlainObject(items)&&createItem(items.parentName,items)}})}return init(),service}]),service}),define("services/binManager",["angular","services/services","common/utils","services/sidebarItems","common/classLoader"],function(angular,serviceModule,utils,sidebarItems,classLoader){function notify(eventName,bin){if(!utils.isBlank(bin)&&!utils.isBlank(bin.module)){var binModule=bin.module;!utils.isBlank(binModule[eventName])&&$.isFunction(binModule[eventName])&&binModule[eventName].call(binModule,bin)}}{var service={bins:[],currentBin:null},createBin=service.createBin=function(iElement,suppliedId){var defaultBin={selected:!1,actived:!1,element:iElement,id:suppliedId||utils.newGuid()};return defaultBin},disActiveBin=(service.dropBin=function(bin){var dBin=findBin(bin.id);utils.isBlank(dBin)||service.bins.splice($.inArray(dBin,service.bins),1)},service.activeBin=function(bin){utils.isBlank(bin)||bin==service.currentBin||(null!=service.currentBin&&disActiveBin(),service.currentBin=bin,bin.actived=!0,bin.selected=!0,notify("actived",bin))},service.disActiveBin=function(){var bin=getActivedBin();utils.isBlank(bin)||(bin.actived=!1,bin.selected=!1,service.currentBin=null,notify("disActived",bin))}),getActivedBin=service.getActivedBin=function(){return service.currentBin},addBin=service.addBin=function(bin){var existsBin=findBin(bin.id);utils.isBlank(existsBin)&&service.bins.push(bin)},findBin=service.findBin=function(binId){var selected=null;return $.each(service.bins,function(i,item){return binId==item.id?(selected=item,!1):void 0}),selected};service.clear=function(){service.bins=[],service.currentBin=null}}return service.notifyBinBeforeDelete=function(bin){bin&&bin.item&&(bin.item.$el&&bin.item.unique&&bin.item.$el.trigger("enableDrag"),$.isFunction(bin.item.beforeDelete)&&bin.item.beforeDelete(bin))},service.wrapBinWithCommonLink=function($scope,$element){var binId="_"+utils.newGuid();$scope.id=binId;var wrapper=$("<div class='_i-wrapper _i-bin-wrapper-only' bin-id="+binId+"></div>");if($element.wrap(wrapper),$scope.wrapperElement=$element.parent(),$.isFunction($scope.module.getItemName)){var itemName=$scope.module.getItemName($element),item=sidebarItems.getItemInFlat(itemName);$scope.item=item,$scope.$watch("item.$el",function(){item&&item.unique&&item.$el&&item.$el.trigger("disableDrag")})}},service.registerBin=function(directiveName,$scope,$element){var module=classLoader.getModule(directiveName);$scope.module=module;var bin=createBin($element,$scope.id);$.extend($scope,bin),addBin($scope)},serviceModule.factory("binManager",function(){return service}),service}),define("services/editorManager",["angular","services/services","common/utils"],function(angular,serviceModule){{var service={editor:null};service.createEditor=function(editorName,bin){var editor={name:editorName,bin:bin};return service.editor=editor,editor},service.destroyEditor=function(){service.editor=null}}return serviceModule.factory("editorManager",function(){return service}),service}),define("directives/pdBin",["angular","directives/directives","common/classLoader","common/utils","services/binManager","services/editorManager"],function(angular,directiveModule,classLoader,utils){var directiveName="pdBin",directive=directiveModule.directive(directiveName,["sidebarItems",function(sidebarItems){var directiveDef={},params={priority:0,replace:!0,transclude:!1,restrict:"A",scope:!0},moduleInitDataMap={},currentModuleMap={};return directiveDef=$.extend(!0,{},params),directiveDef.template=function(tElement,tAttrs){var moduleName=tAttrs[directiveName];utils.isBlank(moduleName)&&(moduleName="pdHtml");var currentModule=classLoader.getModule(moduleName);if(!utils.isBlank(currentModule)){var binId="_"+utils.newGuid(),wrapper=$("<div class='_i-wrapper' bin-id="+binId+"></div>");tElement.removeAttr("pd-bin"),tElement.attr(_.str.dasherize(moduleName),"");var moduleInitData=currentModule.getInitData(tElement,tAttrs);return moduleInitDataMap[binId]=moduleInitData,currentModuleMap[binId]=currentModule,wrapper.append(tElement.clone()),wrapper[0].outerHTML}},directiveDef.compile=function(){return{pre:function(scope,iElement,iAttrs){scope.data=moduleInitDataMap[iAttrs.binId],scope.module=currentModuleMap[iAttrs.binId]},post:function(scope,iElement){if($(iElement).hover(function(){scope.selected||scope.$apply(function(){scope.selected=!0})},function(){scope.actived||scope.$apply(function(){scope.selected=!1})}),$.isFunction(scope.module.getItemName)){var itemName=scope.module.getItemName(iElement),item=sidebarItems.getItemInFlat(itemName);scope.item=item,scope.$watch("item.$el",function(){item&&item.unique&&item.$el&&item.$el.trigger("disableDrag")})}}}},directiveDef.controller=["$scope","$element","$attrs","binManager","editorManager",function($scope,$element,$attrs,binManager){function active(){var preBin=binManager.getActivedBin();(utils.isBlank(preBin)||preBin.id!=$scope.id)&&(binManager.activeBin($scope),$scope.$emit("actived.angular",$scope))}return $scope.init=function(){var bin=binManager.createBin($element,$attrs.binId);$.extend($scope,bin),binManager.addBin($scope)},$scope.init(),{active:active}}],directiveDef}]);return directive}),define("directives/pdPaletteItem",["angular","directives/directives","common/classLoader","common/utils","common/domUtils","services/appPd"],function(angular,directiveModule,classLoader,utils,domUtils,appConfig){var directiveName="pdPaletteItem",directive=directiveModule.directive(directiveName,["sidebarItems","$compile",function(sidebarItems,$compile){var directiveDefinition={priority:0,replace:!1,transclude:!1,restrict:"A",link:function(scope,iElement,iAttrs){var $el=$(iElement);$el.addClass(appConfig.paletteItemAddClass);var itemName=iAttrs[directiveName],item=sidebarItems.getItemInFlat(itemName),module=classLoader.getModule(item.moduleName);utils.isBlank(module)||(domUtils.draggable($el,{start:function(){},refuse:function(event,ui,curDropEl,direction){var refuse=!1;return $.isFunction(item.refuse)&&(refuse=item.refuse(event,ui,curDropEl,direction),$(event.target).data("refuse",item.refuse)),refuse?!0:appConfig.draggableOptions.refuse(event,ui,curDropEl,direction)},stop:function(event,ui,placeholder){if(placeholder.visible){var $el=$(ui.item),itemName=$el.attr("pd-palette-item"),item=null;if(itemName){if(item=sidebarItems.getItemInFlat(itemName),!item)return;var itemModule=classLoader.getModule(item.moduleName);scope.$apply(function(){var childScope=scope.$new(),newAddItemDom=$(itemModule.getCompiledHtml($compile,childScope,$el,item));placeholder.pl.after(newAddItemDom),$(newAddItemDom).data("refuse",$(event.target).data("refuse")),$.isFunction(item.dropPostProcess)&&item.dropPostProcess(newAddItemDom,item)})}}}}),module.paletteItemPostProcess&&$.isFunction(module.paletteItemPostProcess)&&module.paletteItemPostProcess($el),item.$el=$el)}};return directiveDefinition}]);return directive}),define("controllers/controllers",["angular","filters/filters","services/services","directives/directives","directives/pdContainer","directives/pdBin","directives/pdPaletteItem"],function(angular){var module=angular.module("app.controllers",["app.filters","app.services","app.directives"]);return module}),define("services/metauiTemplate",["angular","services/services"],function(angular,serviceModule){var metauiTempateService=serviceModule.factory("MetauiTemplate",function($resource){var url=Global.contextPath+"/html_editor/metauitemplate/:id",postUrl=Global.contextPath+"/html_editor/layout_form";"1"==Global.publish&&(postUrl=Global.contextPath+"/html_editor/layout_form?publish=1");var MetauiTemplate=$resource(url,{},{save:{method:"POST",url:postUrl}});return MetauiTemplate});return metauiTempateService}),define("services/sourceManager",["angular","services/services","services/binManager"],function(angular,serviceModule){var sourceManager={};return serviceModule.factory("sourceManager",["binManager",function(binManager){function cloneDesignerSourceDom(){var cloneDom=$("#edit-page-designer").clone(),wrapperClass="._i-wrapper";return cloneDom.find(wrapperClass).children().each(function(){var wrapper=$(this).closest(wrapperClass),binId=wrapper.attr("bin-id"),isWrapperOnly=wrapper.hasClass("_i-bin-wrapper-only");if(!binId)return void wrapper.remove();var sourceCompileHtml=null,pdBin=wrapper.attr("pd-bin"),bin=binManager.findBin(binId),$append=null;if(bin){var item=bin.item;if(null==item)return void wrapper.remove();sourceCompileHtml=item.sourceCompileHtml
}if(sourceCompileHtml&&""!=sourceCompileHtml?_.str.include(sourceCompileHtml,"{{")?($append=$($.templates(sourceCompileHtml).render({data:bin.data})),isWrapperOnly||$append.attr("pd-bin",pdBin),$append.removeClass(/^ng/)):$append=$(sourceCompileHtml):isWrapperOnly||($append=$("<div></div>").attr("pd-bin",pdBin)),bin.element)for(var sourceDom=$(sourceCompileHtml),attrs=bin.element[0].attributes,i=0;i<attrs.length;i++){var attr=attrs[i];angular.isObject(attr.value)||sourceDom.attr(attr.name)||0==attr.value.indexOf("_")||$append.attr(attr.name,attr.value)}wrapper.after($append),wrapper.remove()}),cloneDom}function sourcePreprocess(cloneDom){cloneDom.find("[bin-id],[layout-id]").each(function(i,ele){var self=$(ele),id=self.attr("bin-id");if(id&&""!=id||(id=self.attr("layout-id")),id){var bin=binManager.findBin(id);bin&&bin.item&&$.isFunction(bin.item.sourcePreprocess)&&bin.item.sourcePreprocess(self)}})}return sourceManager.getMainPageDesignerSource=function(){var cloneDom=cloneDesignerSourceDom();return sourcePreprocess(cloneDom),binManager.clear(),cloneDom.html()},sourceManager.getToSavedTemplate=function(){var cloneDom=cloneDesignerSourceDom();sourcePreprocess(cloneDom),cloneDom.find("[contenteditable]").removeAttr("contenteditable");var scriptContent=window.pd.$scope.designer.scriptContent;if(scriptContent&&""!=scriptContent){var $domScript=$("<script th:inline='javascript'></script>");if(1!=cloneDom.children().length){var $newChildren=$("<div th:id='${viewId}'></div>").append(cloneDom.children());cloneDom.empty(),cloneDom.append($newChildren)}cloneDom.children().append($domScript),$domScript.text(scriptContent)}var originTemplate=cloneDom.html(),tagSelfClosingRE=/(<\s*(area|base|br|col|command|embed|hr|img|input|keygen|link|param|source|track|wbr)\s*(([\w\-:]+)=(".*?"|'.*?'|[^\s>]*))*[^\/>]*)>/gi;return originTemplate=originTemplate.replace(tagSelfClosingRE,"$1/>")},sourceManager}]),sourceManager}),define("services/toolbarService",["angular","services/services"],function(angular,serviceModule){var toolbarService={};return toolbarService.removeAll=function(){window.pd.trigger("removeTools")},serviceModule.factory("toolbarService",[function(){return toolbarService}]),toolbarService}),define("controllers/navbarController",["angular","controllers/controllers","services/sourceManager","common/utils","services/toolbarService"],function(angular,ctrlModule,sm,utils){var navbarController=ctrlModule.controller("navbarController",["$scope","$compile","sourceManager","toolbarService","MetauiTemplate",function($scope,$compile,sourceManager,toolbarService,MetauiTemplate){function saveLayout(callback){var newFormTemplate=sourceManager.getToSavedTemplate();$scope.formLayout.template=newFormTemplate,$scope.formLayout.configData=null;var layout=new MetauiTemplate($scope.formLayout);layout.$save(function(newLayout){newLayout&&($scope.formLayout.id=newLayout.id,$scope.formLayout.version=newLayout.version,$scope.formLayout.status=newLayout.status,Global.formId=newLayout.id,$.isFunction(callback)&&callback(newLayout))})}$scope.sourceBtnClick=function(){if($scope.ui.editSource=!$scope.ui.editSource,$scope.ui.editSource)$scope.ui.editPage=!1,$scope.ui.entityDesign=!1,toolbarService.removeAll(),$scope.designer.designerSourceContent=utils.formatXml(sourceManager.getMainPageDesignerSource());else{$scope.ui.editPage=!0;var content=$scope.designer.designerSourceContent,newScope=$scope.$new();$("#edit-page-designer").html($compile(content)(newScope))}},$scope.scriptBtnClick=function(){var $element=$("#scripteditor");$("#scriptModal").off("shown"),$("#scriptModal").on("shown",function(){var aceEditor=$element.data("ace");aceEditor&&!$element.is(":hidden")&&(aceEditor.setReadOnly(!1),aceEditor.setValue(aceEditor.getValue(),-1),aceEditor.gotoLine(1))})},$scope.frameworkDesignBtnClick=function(){saveLayout(function(){if($scope.ui.entityDesign=!$scope.ui.entityDesign,$scope.ui.entityDesign){$scope.uiEntityDesignTitle="退出架构设计",$scope.ui.editSource=!1,$scope.ui.editPage=!1;var entityName=Global.entityName,url=Global.contextPath+"/html_editor/"+entityName+"/entityConfig?_inframe=1";$("#frameworkDesignIframe").attr("src",url)}else window.location.reload(!0)})},$scope.copyBtnClick=function(){var newFormTemplate=sourceManager.getToSavedTemplate(),$element=$("#full-source-code-textarea");$("#fullSourceModal").off("shown"),$("#fullSourceModal").on("shown",function(){$element.text(newFormTemplate)})},$scope.saveBtnClick=function(){saveLayout(function(newLayout){window.pd.close(newLayout)})},$scope.previewBtnClick=function(){saveLayout(function(newLayout){var previewId=newLayout.id,url=Global.contextPath+"/entities/"+Global.entityName+"/preview?_inframe=1&id="+previewId;$("#previewFormModalIframe").attr("src",url),$("#previewFormModal").modal()})}}]);return navbarController}),define("directives/pdNavListToggle",["angular","directives/directives"],function(angular,directiveModule){directiveModule.directive("pdNavListToggle",[function(){return function($scope,elm){elm.click(function($event){var f=$($event.target).closest("a");if(f&&0!=f.length){if(f.hasClass("dropdown-toggle")){var d=f.next().get(0);if(!$(d).is(":visible")){var c=$(d.parentNode).closest("ul");if($scope.menuMini&&c.hasClass("nav-list"))return;c.find("> .open > .submenu").each(function(){this==d||$(this.parentNode).hasClass("active")||$(this).slideUp(200).parent().removeClass("open")})}return $scope.menuMini&&$(d.parentNode.parentNode).hasClass("nav-list")?!1:void $(d).slideToggle(200).parent().toggleClass("open")}if($scope.menuMini&&f.get(0).parentNode.parentNode==this){var h=f.find(".menu-text").get(0);if(event.target!=h&&!$.contains(h,g.target))return!1}}})}}])}),define("controllers/sidebarController",["angular","controllers/controllers","services/sidebarItems","directives/pdNavListToggle"],function(angular,ctrlModule){var sidebarController=ctrlModule.controller("sideBarController",["$scope","$sce","sidebarItems",function($scope,$sce,sidebarItems){$scope.data="sidebar",$scope.workflow=Global.workflow,$scope.menuMini=!1,$scope.items=sidebarItems.getItems(),$scope.trustSnippet=function(snippet){return $sce.trustAsHtml(snippet)},$scope.collapse=function(){$scope.menuMini=!$scope.menuMini,window.pd.refreshFocus()}}]);return sidebarController}),define("services/scriptService",["angular","services/services"],function(angular,serviceModule){var scriptService={},scriptStack=[];return scriptService.addScriptByDom=function(scope,iElement){var $el=$(iElement),$scripts=$el.find("#script"),scripts="";$scripts.length>0&&($scripts.each(function(){scripts+=$(this).text()}),scriptService.addScript(scope,scripts),$scripts.remove())},scriptService.addScript=function(scope,script){var scriptItem={};script&&(scriptItem[scope.layoutId]=!0,scriptItem.script=script,scriptStack.push({base:scope.designer.scriptContent}),scriptStack.push(scriptItem),scope.designer.scriptContent+=script)},scriptService.removeScript=function(scope){for(var j,_item,i=0,len=scriptStack.length,scripts=null;len>i;++i)if(scriptStack[i][scope.layoutId]){for(scripts=scriptStack[i-1].base,j=i+2;len>j;j+=2)_item=scriptStack[j],scripts+=_item.script;scriptStack.splice(i-1,2);break}scope.designer.scriptContent=scripts},serviceModule.factory("scriptService",[function(){return scriptService}]),scriptService}),define("services/layoutService",["angular","services/services","common/utils","common/classLoader","services/sidebarItems","services/binManager","services/scriptService"],function(angular,serviceModule,utils,classLoader,sidebarItems,binManager){function defaultRefuse(event,ui,placeholder){return"form"===placeholder.prop("tagName").toLowerCase()?!1:!0}var layoutService={},pdLayoutDdirectiveName="pdLayout";return layoutService.registerLayoutBin=function(directiveName,scope,iElement){var layoutId=utils.newGuid();scope.layoutId=layoutId,iElement.attr("layout-id",layoutId);var currentModule=classLoader.getModule(directiveName);scope.module=currentModule;var itemName=scope.module.getItemName(iElement);scope.item=sidebarItems.getItemInFlat(itemName);var layoutScope=binManager.createBin(iElement,layoutId);$.extend(scope,layoutScope),binManager.addBin(scope)},layoutService.getPdLayoutSidebarItems=function(){return layoutService.pdLayoutSidebarItems},layoutService.baseFormTemplates={wftwo:"form/template-workflow-withheader-4col.html",wfthree:"form/template-workflow-withheader-6col.html",popup:"form/template-popup.html",tab:"form/template-tab.html"},layoutService.pdLayoutSidebarItems=[{parentName:"layouts",name:pdLayoutDdirectiveName,moduleName:pdLayoutDdirectiveName,paletteItemHtml:'布局:<input value="6 6" type="text" class="input-mini sidebar-input i-layout-info"/><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div pd-layout=''></div>"},{parentName:"templates",name:"form_section2",moduleName:pdLayoutDdirectiveName,paletteItemHtml:'2列分组<span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div pd-layout='form_section2'></div>",templatePath:"form/form_group2cols.html",refuse:defaultRefuse},{parentName:"templates",name:"template_form_section_withheader_col6",moduleName:pdLayoutDdirectiveName,paletteItemHtml:'3列分组<span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div pd-layout='template_form_section_withheader_col6'></div>",templatePath:"form/form_group3cols.html",refuse:defaultRefuse}],serviceModule.factory("layoutService",[function(){return layoutService}]),layoutService}),define("services/templates",["angular","services/services","services/appPd","common/utils"],function(angular,serviceModule,appConfig,utils){var templates={layout:function(layoutInfo){if(layoutInfo){layoutInfo=_.str.trim(layoutInfo," ");var t="",n=layoutInfo.split(" ",12);return $.each(n,function(n,r){t+='<div class="span'+r+' i-column"></div>'}),t}},table:function(tableLayoutInfo){var row,col,table="<tbody>";if(tableLayoutInfo){row=tableLayoutInfo.row||4,col=tableLayoutInfo.col||4;for(var i=0;row>i;++i){table+="<tr>";for(var j=0;col>j;++j)table+="<td class='i-column'>",table+="</td>";table+="</tr>"}}return table+="</tbody>"},tabContent:function(contendDivId,useUrl){var content="<div id='"+contendDivId+"' class='hide tab-pane'>";return useUrl&&(content="<div id='"+contendDivId+"' class='hide tab-pane-placeholder tab-pane form-horizontal'>",content+='<div class="control-group"><label class="control-label">访问地址：</label> <div class="controls">  <input type="text" name="href" required="required" style="width:80%;"/>  <br/> <span class="label badge-important">可用~代表应用上下文</span> </div>  </div>'),content+="</div>"}};return serviceModule.factory("templates",["$templateCache",function($templateCache){return templates.tmpl=function(templateUrl){templateUrl||alert("template url must not be null"),_.str.startsWith(templateUrl,"/")||(templateUrl=utils.resolveTemplateUrl(templateUrl));var templateContent=null;return $templateCache.get(templateUrl)?$templateCache.get(templateUrl):($.ajax({url:templateUrl,async:!1,type:"get",dataType:"text",contentType:"text/plain",success:function(data){templateContent=data,$templateCache.put(templateUrl,templateContent)}}),templateContent)},templates}]),templates}),define("controllers/pageController",["angular","controllers/controllers","common/utils","services/appPd","services/metauiTemplate","controllers/navbarController","controllers/sidebarController","services/layoutService","services/templates","services/editorManager","services/binManager"],function(angular,ctrlModule,utils){var pageController=ctrlModule.controller("pageController",["$scope","MetauiTemplate","editorManager","binManager","$compile","templates","layoutService",function($scope,MetauiTemplate,editorManager,binManager,$compile,templates,layoutService){function init(){$scope.workflow=Global.workflow,$scope.uiEntityDesignTitle="架构设计",$scope.pageDesignerTitle="表单设计器",$scope.ui={editSource:!1,editPage:!0,entityDesign:!1},$scope.focus={el:null,type:"html"},$scope.designer={designerSourceContent:"",scriptContent:""},window.pd.setScope($scope),MetauiTemplate.get({id:Global.formId},function(formLayout){$scope.formLayout=formLayout||{},$scope.formInfo=formLayout.entityName+":"+formLayout.name,$("#edit-page-designer").html($compile($scope.formLayout.configData)($scope.$new())),$scope.designer.scriptContent=$("#script").text(),$("#script").remove()}),$scope.switchTemplate=function(type){var path=layoutService.baseFormTemplates[type];if(path){var layoutTemplate=templates.tmpl(path),containedLayouts=$("#edit-page-designer").find("[layout-id]"),containedBins=$("#edit-page-designer").find("[bin-id]");containedLayouts.each(function(i,ele){var bin=binManager.findBin($(ele).attr("layout-id"));binManager.notifyBinBeforeDelete(bin)}),containedBins.each(function(i,ele){var bin=binManager.findBin($(ele).attr("bin-id"));binManager.notifyBinBeforeDelete(bin)}),$("#edit-page-designer").html($compile(layoutTemplate)($scope.$new())),$scope.designer.scriptContent=$("#script").text(),$("#script").remove()}else alert("未找到对应的模板，无法切换");$("#templateSwitchModal").modal("hide")},$scope.$on("focusChanged.angular",function(event,focus){$scope.focus.el!=focus.el&&activeFocus(focus)}),$scope.$on("domDeleted.angular",function(){clearFocus()}),initIframeInfo(),window.pd.on("removeTools",function(){clearFocus()})}function activeFocus(focus){if($scope.focus=focus,"bin"==focus.type||$(focus.el).attr("layout-id")){var bin=focus.el.scope();binManager.activeBin(bin)}}function clearFocus(){$scope.focus={el:null,type:"html"}}function initIframeInfo(){self!=top&&($scope.iframeId=utils.getParameter("_iframe_id",window.location.href))}init()}]);return pageController}),define("app",["angular","filters/filters","services/services","directives/directives","controllers/controllers","controllers/pageController"],function(angular){var app=angular.module("app",["app.filters","app.services","app.directives","app.controllers","ngAnimate","ngSanitize"]);return app.config(function($compileProvider,$httpProvider){$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|chrome-extension|javascript):/),$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",$httpProvider.interceptors.push(function(){return{responseError:function(rejection){alert(rejection.data||"request error")}}})}),app}),function(window,angular){angular.module("ngAnimate",["ng"]).config(["$provide","$animateProvider",function($provide,$animateProvider){function suffixClasses(classes,suffix){var className="";return classes=angular.isArray(classes)?classes:classes.split(/\s+/),forEach(classes,function(klass,i){klass&&klass.length>0&&(className+=(i>0?" ":"")+klass+suffix)}),className}var noop=angular.noop,forEach=angular.forEach,selectors=$animateProvider.$$selectors,NG_ANIMATE_STATE="$$ngAnimateState",rootAnimateState={running:!0};$provide.decorator("$animate",["$delegate","$injector","$sniffer","$rootElement","$timeout",function($delegate,$injector,$sniffer,$rootElement,$timeout){function lookup(name){if(name){var matches=[],flagMap={},classes=name.substr(1).split(".");classes.push("");for(var i=0;i<classes.length;i++){var klass=classes[i],selectorFactoryName=selectors[klass];selectorFactoryName&&!flagMap[klass]&&(matches.push($injector.get(selectorFactoryName)),flagMap[klass]=!0)}return matches}}function performAnimation(event,className,element,parent,after,onComplete){function cancelAnimations(animations){var isCancelledFlag=!0;forEach(animations,function(animation){(animation.endFn||noop)(isCancelledFlag)})}function progress(index){animations[index].done=!0,(animations[index].endFn||noop)();for(var i=0;i<animations.length;i++)if(!animations[i].done)return;done()}function done(){done.hasBeenRun||(done.hasBeenRun=!0,element.removeClass(className),element.removeData(NG_ANIMATE_STATE),(onComplete||noop)())}var classes=(element.attr("class")||"")+" "+className,animationLookup=(" "+classes).replace(/\s+/g,"."),animations=[];forEach(lookup(animationLookup),function(animation){animations.push({start:animation[event]})}),parent||(parent=after?after.parent():element.parent());var disabledAnimation={running:!0};if((parent.inheritedData(NG_ANIMATE_STATE)||disabledAnimation).running)return void $timeout(onComplete||noop,0,!1);var ngAnimateState=element.data(NG_ANIMATE_STATE)||{};ngAnimateState.running&&(cancelAnimations(ngAnimateState.animations),ngAnimateState.done()),element.data(NG_ANIMATE_STATE,{running:!0,animations:animations,done:done});var baseClassName=className;"addClass"==event?className=suffixClasses(className,"-add"):"removeClass"==event&&(className=suffixClasses(className,"-remove")),element.addClass(className),forEach(animations,function(animation,index){var fn=function(){progress(index)};animation.start?animation.endFn="addClass"==event||"removeClass"==event?animation.start(element,baseClassName,fn):animation.start(element,fn):fn()})}return $rootElement.data(NG_ANIMATE_STATE,rootAnimateState),{enter:function(element,parent,after,done){$delegate.enter(element,parent,after),performAnimation("enter","ng-enter",element,parent,after,done)},leave:function(element,done){performAnimation("leave","ng-leave",element,null,null,function(){$delegate.leave(element,done)})},move:function(element,parent,after,done){$delegate.move(element,parent,after),performAnimation("move","ng-move",element,null,null,done)},addClass:function(element,className,done){performAnimation("addClass",className,element,null,null,function(){$delegate.addClass(element,className,done)})},removeClass:function(element,className,done){performAnimation("removeClass",className,element,null,null,function(){$delegate.removeClass(element,className,done)})},enabled:function(value){return arguments.length&&(rootAnimateState.running=!value),!rootAnimateState.running}}}]),$animateProvider.register("",["$window","$sniffer","$timeout",function($window,$sniffer,$timeout){function animate(element,className,done){function parseMaxTime(str){var total=0,values=angular.isString(str)?str.split(/\s*,\s*/):[];return forEach(values,function(value){total=Math.max(parseFloat(value)||0,total)}),total}function startAnimation(){var duration=0;forEach(className.split(" "),function(klass,i){activeClassName+=(i>0?" ":"")+klass+"-active"}),element.addClass(activeClassName);var w3cAnimationProp="animation",w3cTransitionProp="transition",vendorAnimationProp=$sniffer.vendorPrefix+"Animation",vendorTransitionProp=$sniffer.vendorPrefix+"Transition",durationKey="Duration",delayKey="Delay",animationIterationCountKey="IterationCount",ELEMENT_NODE=1;forEach(element,function(element){if(element.nodeType==ELEMENT_NODE){var elementStyles=$window.getComputedStyle(element)||{},transitionDelay=Math.max(parseMaxTime(elementStyles[w3cTransitionProp+delayKey]),parseMaxTime(elementStyles[vendorTransitionProp+delayKey])),animationDelay=Math.max(parseMaxTime(elementStyles[w3cAnimationProp+delayKey]),parseMaxTime(elementStyles[vendorAnimationProp+delayKey])),transitionDuration=Math.max(parseMaxTime(elementStyles[w3cTransitionProp+durationKey]),parseMaxTime(elementStyles[vendorTransitionProp+durationKey])),animationDuration=Math.max(parseMaxTime(elementStyles[w3cAnimationProp+durationKey]),parseMaxTime(elementStyles[vendorAnimationProp+durationKey]));animationDuration>0&&(animationDuration*=Math.max(parseInt(elementStyles[w3cAnimationProp+animationIterationCountKey])||0,parseInt(elementStyles[vendorAnimationProp+animationIterationCountKey])||0,1)),duration=Math.max(animationDelay+animationDuration,transitionDelay+transitionDuration,duration)}}),$timeout(done,1e3*duration,!1)}function onEnd(cancelled){element.removeClass(activeClassName),cancelled&&done()}if($sniffer.transitions||$sniffer.animations){var activeClassName="";return $timeout(startAnimation,1,!1),onEnd}done()}var forEach=(angular.noop,angular.forEach);return{enter:function(element,done){return animate(element,"ng-enter",done)},leave:function(element,done){return animate(element,"ng-leave",done)},move:function(element,done){return animate(element,"ng-move",done)},addClass:function(element,className,done){return animate(element,suffixClasses(className,"-add"),done)},removeClass:function(element,className,done){return animate(element,suffixClasses(className,"-remove"),done)}}}])}])}(window,window.angular),define("ngAnimate",["angular"],function(global){return function(){var ret;return ret||global.ngAnimate}}(this)),function(window,angular){function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}var index,chars,match,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(chars=!0,stack.last()&&specialElements[stack.last()])html=html.replace(new RegExp("(.*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last());else if(0===html.indexOf("<!--")?(index=html.indexOf("-->"),index>=0&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag),chars=!1)),chars){index=html.indexOf("<");var text=0>index?html:html.substring(0,index);html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text))}if(html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){return hiddenPre.innerHTML=value.replace(/</g,"&lt;"),hiddenPre.innerText||hiddenPre.textContent||""}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||1!=validElements[tag]||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key);1!=validAttrs[lkey]||uriAttrs[lkey]===!0&&!value.match(URI_REGEXP)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||1!=validElements[tag]||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),$sanitize=function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf)),buf.join("")},START_TAG_REGEXP=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,END_TAG_REGEXP=/^<\s*\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\s*\//,COMMENT_REGEXP=/<!--(.*?)-->/g,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,URI_REGEXP=/^((ftp|https?):\/\/|mailto:|tel:|#)/i,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap"),validAttrs=angular.extend({},uriAttrs,makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,span,start,summary,target,title,type,valign,value,vspace,width")),hiddenPre=document.createElement("pre");angular.module("ngSanitize",[]).value("$sanitize",$sanitize),angular.module("ngSanitize").filter("linky",function(){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s\.\;\,\(\)\{\}\<\>]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){if(!text)return text;var match,url,i,raw=text,html=[],writer=htmlSanitizeWriter(html),properties={};for(angular.isDefined(target)&&(properties.target=target);match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]==match[3]&&(url="mailto:"+url),i=match.index,writer.chars(raw.substr(0,i)),properties.href=url,writer.start("a",properties),writer.chars(match[0].replace(MAILTO_REGEXP,"")),writer.end("a"),raw=raw.substring(i+match[0].length);return writer.chars(raw),html.join("")}})}(window,window.angular),define("ngSanitize",["angular"],function(global){return function(){var ret;return ret||global.ngSanitize}}(this)),define("directives/uiAce",["angular","directives/directives","common/utils"],function(angular,directiveModule){var directiveName="uiAce";directiveModule.directive(directiveName,function(){var directiveDef={restrict:"A",scope:{aceValue:"="},controller:function($scope,$element){$scope.$watch("aceValue",function(value){$element.data("ace")&&$element.data("ace").getValue()!==value&&$element.data("ace").setValue(value,-1)})},link:function(scope,ele,attrs){var options,opts,aceEditor;options={theme:"ace/theme/eclipse",mode:"ace/mode/html"},opts=angular.extend({},options,scope.$eval(attrs[directiveName]));var domId=attrs.id;if(!domId)throw new Error("uiAce can only be applied to an element has id attribute");aceEditor=ace.edit(domId),aceEditor.setTheme(opts.theme),aceEditor.getSession().setMode(opts.mode),aceEditor.setShowPrintMargin(!1),aceEditor.navigateTo(0,0),aceEditor.updateSelectionMarkers(),aceEditor.on("change",function(){setTimeout(function(){scope.$apply(function(){scope.aceValue=aceEditor.getValue()})},10)}),$(ele).data("ace",aceEditor)}};return directiveDef})}),define("directives/pdFocusFrame",["angular","directives/directives","common/utils","common/domUtils","services/appPd","services/binManager"],function(angular,directiveModule,utils,domUtils,appConfig){var directive=directiveModule.directive("pdFocusFrame",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("focus-frame.html"),replace:!0,transclude:!1,restrict:"A",link:function($scope,iElement,iAttrs){domUtils.draggable(iElement,{start:function(){$scope.$apply(function(){$scope.style.display="none"})},refuse:function(event,ui,curDropEl,direction){var refuseFun=$($scope.focus.el).data("refuse"),refuse=!1;return $.isFunction(refuseFun)&&(refuse=refuseFun(event,ui,curDropEl,direction)),refuse?!0:appConfig.draggableOptions.refuse(event,ui,curDropEl,direction)},stop:function(event,ui,placeholder){if(!placeholder.visible)return void $scope.$apply(function(){$scope.style.display="block"});var newAddItemDom=$scope.focus.el;domUtils.defaultRefuse(event,ui,placeholder,newAddItemDom)||(placeholder.pl.after(newAddItemDom),window.setTimeout(function(){$scope.$apply(function(){$scope.refresh()})},50))}}),$scope.$watch(iAttrs.pdFocusFrame,function(value,oldValue){window.pd.setFocus({frameScope:$scope,frame:iElement,current:$scope.focus,pre:oldValue}),$scope.render()})},controller:["$scope","$element","$attrs","binManager",function($scope,$element,$attrs,binManager){$scope.init=function(){$scope.style={position:"absolute",display:"none",left:0,top:0,opacity:1},$scope.frameLeftStyle={height:0,left:-6,top:-6,cursor:"auto"},$scope.frameRightStyle={height:0,left:-6,top:-6,cursor:"auto"},$scope.frameTopStyle={width:0,left:-6,top:-6,cursor:"auto"},$scope.frameBottomStyle={left:-6,top:-6,width:0,cursor:"auto"},$scope.titlebarStyle={left:0},$scope.titlebar={canSetting:!1,canDelete:!0,canDrag:!0},$scope.canResize=!1,$scope.type="html"},$scope.setting=function(){binManager.findBin($scope.id)},$scope.render=function(){$scope.init();var focus=$scope.focus;if(!utils.isBlank(focus)&&!utils.isBlank(focus.el)){var $el=$(focus.el);$scope.titlebarStyle.display="block",$scope.frameLeftStyle.height=$scope.frameRightStyle.height=$el.outerHeight()+8,$scope.frameRightStyle.left=$scope.frameLeftStyle.left+$el.outerWidth()+6,$scope.frameTopStyle.width=$scope.frameBottomStyle.width=$el.outerWidth()+8,$scope.frameBottomStyle.top=$scope.frameTopStyle.top+$el.outerHeight()+8,$scope.titlebarStyle.left=$scope.frameTopStyle.width/2-15,$scope.style.left=$el.offset().left,$scope.style.top=$el.offset().top,$scope.style.display="block",$scope.titlebar.canDrag=domUtils.canDraggable($el),$scope.titlebar.canDelete=domUtils.canDelete($el);var leftRightDistance=$scope.frameRightStyle.left-$scope.frameLeftStyle.left,buttonsWidthSum=0;if($(".i-titlebar>.i-titlebar-wrap>a.i-titlebar-button").each(function(i,toolBtn){buttonsWidthSum+=$(toolBtn).width()}),buttonsWidthSum>leftRightDistance){var addDistance=buttonsWidthSum-leftRightDistance;$scope.frameRightStyle.left+=addDistance,$scope.frameTopStyle.width+=addDistance,$scope.frameBottomStyle.width+=addDistance,$scope.titlebarStyle.left+=addDistance/2}}},$scope.refresh=function(){$scope.render()},$scope.del=function(){if(null!=$scope.focus){if("bin"==$scope.focus.type){var binId=$($scope.focus.el).attr("bin-id"),bin=binManager.findBin(binId);binManager.notifyBinBeforeDelete(bin),binManager.dropBin(bin),bin.wrapperElement&&bin.wrapperElement.remove(),bin.element.remove(),bin.$destroy()}else{var layoutId=$scope.focus.el.attr("layout-id");layoutId&&""!=layoutId&&binManager.notifyBinBeforeDelete(binManager.findBin(layoutId));var containedLayouts=$scope.focus.el.find("[layout-id]"),containedBins=$scope.focus.el.find("[bin-id]");containedLayouts.each(function(i,ele){var bin=binManager.findBin($(ele).attr("layout-id"));binManager.notifyBinBeforeDelete(bin)}),containedBins.each(function(i,ele){var bin=binManager.findBin($(ele).attr("bin-id"));binManager.notifyBinBeforeDelete(bin)}),"FORM"===$scope.focus.el[0].nodeName?$scope.focus.el.parent().remove():$($scope.focus.el).remove()}$scope.$emit("domDeleted.angular")}},$scope.init()}]};return directiveDefinition});return directive}),define("directives/toolbar-editors/pdTitleEditor",["angular","directives/directives","common/utils"],function(angular,directiveModule,utils){var directive=directiveModule.directive("pdTitleEditor",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/title-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$element","$attrs",function($scope){$scope.labelClass=function(className){$scope.bin.data.labelClass=className
}}]};return directiveDefinition});return directive}),define("directives/toolbar-editors/htmleditor/editor",["common/eventBase","services/appPd"],function(EventBase){var Editor=EventBase.extend({items:null,options:null,focusEl:null,isEnabled:!0,init:function(opts){this._super(),this.setOpt(opts)},setOpt:function(key,val){var obj={};_.isString(key)?obj[key]=val:obj=key,null==this.options&&(this.options={}),$.extend(this.options,obj)},register:function(cmdClass){var me=this,instance=new cmdClass(me);return this.getAllItem()[instance.cmdName.toLowerCase()]=instance,instance},addItem:function(cmdName,item){this.getAllItem()[cmdName.toLowerCase()]=item},getItem:function(cmdName){return this.getAllItem()[cmdName.toLowerCase()]},getAllItem:function(){return null==this.items&&(this.items={}),this.items},selectionChange:function(focusEl){var me=this;me.focusEl=focusEl,me.trigger("focusChanged",focusEl,!0)},_callCmdFn:function(fnName,args){var cmd,cmdFn,cmdName=args[0].toLowerCase();return cmd=this.items[cmdName],cmdFn=cmd&&cmd[fnName],cmd&&cmdFn||"queryCommandState"!=fnName?cmdFn?cmdFn.apply(cmd,_.without(args,args[0])):void 0:0},execCommand:function(cmdName){cmdName=cmdName.toLowerCase();var result,me=this,cmd=me.items[cmdName];return cmd&&cmd.execCommand?(cmd.notNeedUndo||me.__hasEnterExecCommand?(result=this._callCmdFn("execCommand",arguments),!me._ignoreContentChange&&me.trigger("contentchange")):(me.__hasEnterExecCommand=!0,-1!=me.queryCommandState.apply(me,arguments)&&(me.trigger("beforeexeccommand",cmdName),result=this._callCmdFn("execCommand",arguments),!me._ignoreContentChange&&me.trigger("contentchange"),me.trigger("afterexeccommand",cmdName)),me.__hasEnterExecCommand=!1),!me._ignoreContentChange&&me._selectionChange(),result):null},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)}}),instance=new Editor;return instance}),define("directives/toolbar-editors/pdHtmleditorItem",["angular","directives/directives","common/utils","directives/toolbar-editors/htmleditor/editor"],function(angular,directiveModule){var directive=directiveModule.directive("pdHtmleditorItem",function(){var directiveDefinition={priority:0,replace:!1,transclude:!1,restrict:"A",scope:!0,controller:["$scope","$element","$attrs",function($scope,$element,$attrs){function init(){var cmdName=$attrs.pdHtmleditorItem,htmlEditor=$scope.htmlEditor,toolbarItem=htmlEditor.getItem(cmdName);"undefined"!=typeof toolbarItem&&(toolbarItem.itemDom=$element,$scope.item=toolbarItem,$scope.$watch("item.styleValue",function(value,oldValue){value!=oldValue&&$scope.item.onClick()}),$scope.$watch("item.state",function(value){-1==value?$element.hide():$element.show()}))}init()}]};return directiveDefinition});return directive}),define("directives/toolbar-editors/pdHtmleditor",["angular","directives/directives","common/utils","directives/toolbar-editors/htmleditor/editor","directives/toolbar-editors/pdHtmleditorItem"],function(angular,directiveModule,utils,editor){var directive=directiveModule.directive("pdHtmleditor",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/html-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$element","$attrs",function($scope){function init(){$scope.htmlEditor=editor,editor.selectionChange($($scope.focus.current.el[0])),$($scope.focus.current.el).attr("contenteditable",!0),$scope.$on("$destroy",function(){$($scope.focus.current.el).removeAttr("contenteditable")})}init()}]};return directiveDefinition});return directive}),define("directives/toolbar-editors/metaRelationEditor",["angular","directives/directives","common/utils"],function(angular,directiveModule,utils){var directive=directiveModule.directive("metaRelationEditor",["$http",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/metarelation-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$element","$attrs","relationService",function($scope,$element,$attrs,relationService){$scope.relationLinks=relationService.relationLinks,$scope.labelClass=function(className){$scope.bin.data.labelClass=className},$scope.setupRelation=function(){$("#relationConfigModal").find(":checkbox").prop("checked",!0);var excludeRelations=$scope.bin.data.excludeRelationNames;if("string"==typeof excludeRelations)for(var excludes=excludeRelations.split(","),i=0;i<excludes.length;++i)$("#relationConfigModal [value="+excludes[i]+"]").prop("checked",!1);window.setTimeout(function(){$(".modal-backdrop").appendTo("#breadcrumbs")},500)},$scope.saveSetupRelation=function(){for(var excludeRelations=$("#relationConfigModal").find("input:not(:checked)"),excludes=[],i=0;i<excludeRelations.length;++i)excludes.push($(excludeRelations[i]).val());$scope.bin.data.excludeRelationNames=excludes.join(",")}}],link:function(){}};return directiveDefinition}]);return directive}),define("directives/toolbar-editors/uiTabEditor",["angular","directives/directives","common/utils"],function(angular,directiveModule,utils){var directiveName="uiTabEditor",directive=directiveModule.directive(directiveName,["$http",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/ui-tab-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$element","$attrs",function($scope){var tabElement=$scope.bin.element;$scope.isBottomTab=tabElement.hasClass("tabs-bottom");var tabsMap=$scope.bin.tabsMap;$scope.setupEditTab=function(){var tabsData=[];$.each(tabsMap,function(contentDivId,tab){var $aNew=tab.a,text=$aNew.text(),href=$aNew.attr("href");tabsData.push({text:text,add:!0,href:href,tabId:tab.contentDiv.attr("id")})}),$("#accordion-edit-tab").html($("#editTabTemplate").render(tabsData)),$("#editTabModal").on("click",".remove-tab",function(e){if(e.preventDefault(),1===$("#accordion-edit-tab").find(".accordion-group").length)return alert("The last tab is not allowed to delete!"),void $(this).attr("disabled","disabled");var $curAccordion=$(this).closest(".accordion-group"),tabId=$curAccordion.attr("data-tabId"),tab=tabsMap[tabId];tab&&(tab.a.parent().remove(),tab.contentDiv.remove(),$curAccordion.remove()),delete tabsMap[tabId]})},$scope.setupAddTab=function(){$("#add-tab-form").find("input[type=text]").val(""),$("#add-tab-form").find("[value=yes]").prop("checked",!0),$("#add-tab-form").find("[name=useUrl]").click(function(){var checkedValue=$("#add-tab-form").find("[name=useUrl]:checked").val();"yes"===checkedValue?$("#add-tab-form").find(".use-url").show():$("#add-tab-form").find(".use-url").hide().val("")})},$scope.saveSetupAddTab=function(){var currentElement=tabElement,$currentEditTabUl=currentElement.children("ul");if($currentEditTabUl&&1===$currentEditTabUl.length){var contendDivId,navLi,tab,$tabForm=$("#add-tab-form"),text=$tabForm.find("[name=text]").val(),url=$tabForm.find("[name=url]").val(),useUrl=$("#add-tab-form").find("[name=useUrl]:checked").val(),isUseUrl=!1;if("yes"===useUrl){if(!text||!url)return!1;isUseUrl=!0,contendDivId="#"+url,tab=[{text:text,href:url,useUrl:!0}]}else contendDivId=utils.newGuid(),tab=[{text:text,href:"#"+contendDivId}];navLi=$($("#addTabTemplate").render(tab)),$scope.bin.addNewTab(tabElement,contendDivId,navLi,isUseUrl)}}}],link:function(){}};return directiveDefinition}]);return directive}),define("directives/toolbar-editors/form/uiFormToolbarEditor",["angular","directives/directives","common/utils"],function(angular,directiveModule,utils){var directive=directiveModule.directive("uiFormToolbarEditor",["$http",function($http){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/form/ui-form-toolbar-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$element","$attrs",function($scope){$scope.operations=[];var url=Global.contextPath+"/html_editor/"+Global.entityName+"/operation/";$http.get(url).success(function(opts){opts&&($scope.operations=opts)}),$scope.setupOperation=function(){var currentElement=$scope.bin.element,$currentFormToolbar=currentElement.children("ul"),existsButtons=$currentFormToolbar.find("li.form-toolbar-button"),$toolbarModelBody=$("#toolbarConfigModal .modal-body");$toolbarModelBody.find("input:checked").removeProp("checked");for(var i=0;i<existsButtons.length;++i){var dataFunc=$(existsButtons[i]).attr("data-func"),$currentInput=$toolbarModelBody.find("input[value='"+dataFunc+"']");$currentInput.prop("checked",!0),$currentInput.parent().insertBefore($toolbarModelBody.find(".checkbox:eq("+i+")"))}},$scope.saveSetupOperation=function(){for(var currentElement=$scope.bin.element,$currentFormToolbar=currentElement.children("ul"),$toolbarModelBody=$("#toolbarConfigModal .modal-body"),addButtons=$toolbarModelBody.find("input:checked"),datas=[],i=0;i<addButtons.length;++i){var $button=$(addButtons[i]),mainFunc=$button.val(),displayName=$button.attr("data-displayName"),icon=$button.attr("data-icon");datas.push({mainFunc:mainFunc,displayName:displayName,icon:icon})}$currentFormToolbar&&($currentFormToolbar.find(".form-toolbar-button").remove(),$currentFormToolbar.append($("#addToolbarButtonTemplate").render(datas)))}}],link:function(scope,iElement){$(iElement).find("#toolbarConfigModal .modal-body").sortable({opacity:.35,items:".checkbox",connectWith:"#toolbarConfigModal .modal-body",stop:function(){}})}};return directiveDefinition}]);return directive}),define("services/slaveTableService",["angular","services/services"],function(angular,serviceModule){var slaveTableService={getColumns:function(entityName){var columns=[];return $.ajax({url:Global.contextPath+"/metadata/field/query_paged?entity="+entityName,async:!1,type:"post",dataType:"json",contentType:"application/json",success:function(data){data.rows&&$.isArray(data.rows)&&(columns=data.rows)}}),columns}};return serviceModule.factory("slaveTableService",[function(){return slaveTableService}]),slaveTableService}),define("directives/toolbar-editors/metaSlaveTableEditor",["angular","directives/directives","common/utils","services/slaveTableService"],function(angular,directiveModule,utils){var directive=directiveModule.directive("metaSlaveTableEditor",["$http",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/metaslavetable-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$http","slaveTableService",function($scope,$http,slaveTableService){if($.isArray($scope.bin.data.fields))$scope.fields=$scope.bin.data.fields;else{for(var fields=slaveTableService.getColumns($scope.bin.data.entityname),gridCols=$scope.bin.data.gridCols,fieldsClone=[],i=0;i<gridCols.length;i++)fieldsClone.push(gridCols[i]);for(var i=0;i<fields.length;i++){for(var exist=!1,j=0;j<fieldsClone.length;j++)if(fields[i].name==fieldsClone[j].name||"id"==fields[i].name){exist=!0;break}exist||fieldsClone.push({name:fields[i].name,displayName:fields[i].displayName})}$scope.fields=fieldsClone}$scope.setFields=function(){$("#slaveTableFields").find(":checkbox").prop("checked",!0);for(var gridCols=$scope.bin.data.gridCols,nochecked=[],i=0;i<$scope.fields.length;i++){for(var exist=!1,j=0;j<gridCols.length;j++)if($scope.fields[i].name==gridCols[j].name){exist=!0;break}exist||nochecked.push({name:$scope.fields[i].name,displayName:$scope.fields[i].displayName})}$scope.bin.data.nochecked=nochecked;for(var i=0;i<nochecked.length;++i)$("#slaveTableFields [value="+nochecked[i].name+"]").prop("checked",!1);$("#sortable").sortable(),window.setTimeout(function(){$(".modal-backdrop").appendTo("#breadcrumbs")},500)},$scope.saveFieldsSet=function(){for(var checkboxfields=$("#slaveTableFields").find(":checkbox"),checkedFields=$("#slaveTableFields").find(":checked"),nocheckedFields=$("#slaveTableFields").find("input:not(:checked)"),fields=[],gridCols=[],nochecked=[],columns=[],i=0;i<checkboxfields.length;i++)fields.push({name:checkboxfields[i].value,displayName:checkboxfields[i].dataset.displayname,index:checkboxfields[i].dataset.index});for(var i=0;i<checkedFields.length;i++)gridCols.push({name:checkedFields[i].value,displayName:checkedFields[i].dataset.displayname,index:checkedFields[i].dataset.index}),columns.push(checkedFields[i].value);for(var i=0;i<nocheckedFields.length;i++)nochecked.push({name:nocheckedFields[i].value,displayName:nocheckedFields[i].dataset.displayname,index:nocheckedFields[i].dataset.index});var url=Global.contextPath+"/html_editor/"+Global.entityName+"/slavetable/"+$scope.bin.data.entityname+"/columnorder";$.post(url,{columns:columns.join(",")},function(){},"json"),$scope.bin.data.fields=fields,$scope.bin.data.gridCols=gridCols,$scope.bin.data.nochecked=nochecked}}],link:function(){}};return directiveDefinition}]);return directive}),define("directives/toolbar-editors/pdSpecsEditor",["angular","directives/directives","common/utils"],function(angular,directiveModule,utils){var directive=directiveModule.directive("pdSpecsEditor",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/specs-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$element","$attrs",function($scope){$scope.labelClass=function(className){$scope.bin.data.labelClass=className},$scope.toggleHr=function(){$scope.bin.$emit("toggleHr")},$scope.toggleH4=function(){$scope.bin.$emit("toggleH4")}}]};return directiveDefinition});return directive}),define("directives/toolbar-editors/metaFieldEditor",["angular","directives/directives","common/utils"],function(angular,directiveModule,utils){var directive=directiveModule.directive("metaFieldEditor",function(){var directiveDefinition={priority:0,templateUrl:utils.resolveTemplateUrl("toolbar-editors/metafield-editor.html"),replace:!0,transclude:!1,restrict:"A",controller:["$scope","$element","$attrs",function($scope){var modalObj=$("#configValidatorModal"),fieldBin=$scope.bin,currentField=fieldBin.data.metaField,fieldElement=fieldBin.element.find("[meta\\:field='"+currentField+"']"),fieldElementWrapper=fieldElement.parent("._i-wrapper");modalObj.off("shown"),modalObj.on("shown",function(){$(modalObj).find(":input").val(null),$(modalObj).find(":checkbox,:radio").prop("checked",!1);var validator=fieldElement.attr("data-validator"),targetFields=[];$("form",".page-content").find("[meta\\:field]").not("._i-wrapper").each(function(i,field){var name=$(field).attr("meta:field");name!=currentField&&targetFields.push(name)});var $funcSelect=$("[name='validator-func-param-fieldname']",modalObj),items="<option value=''>--选择目标字段--</option>";if($.each(targetFields,function(i,name){items+="<option value='"+name+"'>"+name+"</option>"}),$funcSelect.html(items),validator){var rules=[],ruleOptions=validator.match(/\[[^\]]+(\]\]|\])/g);ruleOptions&&$.each(ruleOptions,function(index){validator=validator.replace(this,"##"+index)}),validator=validator.split(","),$.each(validator,function(){var ruleAndOption=this.split("##");rules.push(ruleAndOption&&2==ruleAndOption.length?{name:$.trim(ruleAndOption[0]),options:ruleOptions[ruleAndOption[1]].replace(/^\[|\]$/g,"").split(",")}:{name:$.trim(ruleAndOption[0]),options:[]})}),$.each(rules,function(i,rule){var name=rule.name,params=[];rule.options.length>1&&(params=rule.options.slice(1)),"required"==name&&$("[name='validator-required']",modalObj).prop("checked",!0),"func"==name&&($("[name='validator-func-name']",modalObj).val(rule.options[0]),$("[name='validator-func-param-fieldname']",modalObj).val(rule.options[1]))})}}),$(".saveBtn",modalObj).off("click"),$(".saveBtn",modalObj).on("click",function(){var validator=[],ok=!0,required=$("[name='validator-required']",modalObj).is(":checked");if(required&&validator.push("required"),$(".func-con",modalObj).each(function(i,t){var func=$(t).find(".func-name").val();if(func){var paramDoms=$(t).find(".func-param");if(0==paramDoms.length)validator.push("func["+func+"]");else{var funcParams=[func],funStr="";funStr+="func[",paramDoms.each(function(i,t){var param=$(t).val();return param?void funcParams.push(param):(alert("验证函数"+func+"所需参数为空，请选择"),ok=!1,!1)}),ok&&(funStr+=funcParams.join(",")),funStr+="]",validator.push(funStr)}}}),ok){if(0==validator.length)fieldElement.removeAttr("data-validator"),fieldElementWrapper.removeAttr("data-validator");else{var vs=validator.join(",");fieldElement.attr("data-validator",vs),fieldElementWrapper.attr("data-validator",vs)}modalObj.modal("hide")}}),$scope.configValidator=function(){modalObj.modal("show")}}]};return directiveDefinition});return directive}),define("directives/toolbar-editors/pdEditor",["angular","directives/directives","services/appPd","common/utils","services/binManager","services/editorManager","directives/toolbar-editors/pdTitleEditor","directives/toolbar-editors/pdHtmleditor","directives/toolbar-editors/metaRelationEditor","directives/toolbar-editors/uiTabEditor","directives/toolbar-editors/form/uiFormToolbarEditor","directives/toolbar-editors/metaSlaveTableEditor","directives/toolbar-editors/pdSpecsEditor","directives/toolbar-editors/metaFieldEditor"],function(angular,directiveModule,pd){var directiveName="pdEditor",directive=directiveModule.directive(directiveName,["$compile","$animate","$timeout","binManager",function($compile,$animate,$timeout,binManager){var directiveDef={},params={transclude:"element",priority:1e3,terminal:!0,restrict:"A"};return directiveDef=$.extend(!0,{},params),directiveDef.compile=function(tElement,tAttrs,transclusion){return function($scope,$element){var currentScope,currentElement,cleanupLastEditor=function(){currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&(currentElement.remove(),currentElement=null)},getEditor=function(focus){var editor={name:null,params:null};if(null==focus.el)return editor;if("bin"==focus.type||$(focus.el).attr("layout-id")){var binId=$(focus.el).attr("bin-id")||$(focus.el).attr("layout-id"),bin=binManager.findBin(binId);editor.name=bin.module.editorName,editor.bin=bin,!editor.name&&bin.item&&(editor.name=bin.item.editorName),editor.params=bin}else editor.name="pdHtmleditor";return editor};pd.on("focusChanged",function(focusInfo){cleanupLastEditor();var editor=getEditor(focusInfo.current),newScope=$scope.$new();transclusion(newScope,function(clone){if(currentScope=newScope,currentScope.bin=editor.bin,currentScope.focus=focusInfo,currentElement=clone,null!=editor.name){var editorNames=_.str.words(editor.name,","),editorsHtml="";$.each(editorNames,function(i,name){editorsHtml+="<div "+_.str.dasherize(name)+"></div>"}),currentElement.html(editorsHtml)}$element.after(currentElement),currentElement.show(),$compile(currentElement.contents())(currentScope)})})}},directiveDef}]);return directive}),define("directives/pdLayout",["angular","directives/directives","common/utils","common/classLoader","services/sidebarItems","services/appPd","services/layoutService","services/binManager"],function(angular,directiveModule,utils,classLoader,sidebarItems,appConfig,layoutService){{var directiveName="pdLayout",extendAttrs={name:directiveName,directiveDef:null,getSidebarItems:function(){return layoutService.getPdLayoutSidebarItems()},getItemName:function(iElement){var name=iElement.attr(_.str.dasherize(directiveName));return name&&""!=name?name:directiveName},getCompiledHtml:function($compile,$scope,$ui,sidebarItem){return directiveName==sidebarItem.name&&($scope.layoutInfo=$ui.find(".i-layout-info").val()),$compile(sidebarItem.compileHtml)($scope)},paletteItemPostProcess:function($el){$el.on("keyup",".i-layout-info",function(e){var n=$(this).val().split(" ",12),e=0,disable=!1;$.each(n,function(n,r){return""==r&&(r=0),$.isNumeric(r)?void(e+=parseInt(r)):(disable=!0,!1)}),$el.draggable(12!=e||disable?"disable":"enable")})}};directiveModule.directive(directiveName,["$compile","appConfig","templates","binManager",function($compile,appConfig,templates){var directiveDefinition={name:directiveName,priority:0,replace:!0,scope:!0,transclude:!1,restrict:"A",template:function(iElement,iAttrs){var $el=$(iElement),layoutName=iAttrs[directiveName],isElementEmpty=iElement.children().length>0?!1:!0;if(isElementEmpty){var layoutTemplate=null,templatePath=null;if(layoutName&&""!=layoutName){var item=sidebarItems.getItemInFlat(layoutName);if(item.templatePath)return templatePath=item.templatePath,layoutTemplate=templates.tmpl(templatePath)}}for(var key in iAttrs)iAttrs.hasOwnProperty(key)&&$el.removeAttr(iAttrs.$attr[key]);return $el[0].outerHTML},compile:function(){return{pre:function(scope,iElement){layoutService.registerLayoutBin(directiveName,scope,iElement)},post:function(scope,iElement,iAttrs,controller){var layoutInfo=null,layoutTemplate=null,$el=$(iElement);scope.layoutInfo&&($el.addClass(appConfig.layoutAddClass),layoutInfo=scope.layoutInfo,layoutTemplate=templates.layout(layoutInfo),$el.append(layoutTemplate)),$.isFunction(scope.item.postLinkCallback)&&scope.item.postLinkCallback(scope,iElement,iAttrs,controller)}}}};return extendAttrs.directiveDef=directiveDefinition,directiveDefinition}])}return classLoader.register(directiveName,extendAttrs),extendAttrs}),define("directives/pdTable",["angular","directives/directives","common/utils","common/classLoader","services/sidebarItems","services/appPd"],function(angular,directiveModule,utils,classLoader){{var directiveName="pdTable",extendAttrs={name:directiveName,directiveDef:null,getSidebarItems:function(){return{parentName:"layouts",name:directiveName,moduleName:directiveName,paletteItemHtml:'表格:<input value="4" type="text" class="i-table-row sidebar-input" title="行" style="width:15px" />*<input value="4" type="text" class="i-table-col sidebar-input" title="列" style="width:15px" /><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<table pd-table='' class='table form-table'></table>"}},getItemName:function(){return directiveName},getCompiledHtml:function($compile,$scope,$ui,sidebarItem){return $scope.tableLayoutInfo={row:$ui.find(".i-table-row").val()||"4",col:$ui.find(".i-table-col").val()||"4"},$compile(sidebarItem.compileHtml)($scope)},paletteItemPostProcess:function($el){$el.on("keyup","input",function(){var v=$(this).val();$el.draggable($.isNumeric(v)?"enable":"disable")})}};directiveModule.directive(directiveName,function($compile,appConfig,templates){var directiveDefinition={name:directiveName,priority:0,replace:!1,transclude:!1,restrict:"A",link:function(scope,iElement){var $el=$(iElement),tableLayoutInfo=scope.tableLayoutInfo,layoutTemplate=null;tableLayoutInfo&&""!=tableLayoutInfo&&(layoutTemplate=templates.table(tableLayoutInfo),$el.append(layoutTemplate))}};return extendAttrs.directiveDef=directiveDefinition,directiveDefinition})}return classLoader.register(directiveName,extendAttrs),extendAttrs}),define("directives/pdBinBase",["common/eventBase","services/appPd","common/classLoader"],function(EventBase,pd,classLoader){return EventBase.extend({name:null,editorName:null,directiveDef:null,baseOptions:pd.bin.binModuleBaseOptions,init:function(directiveName){var me=this;this._super(),this.name=directiveName,classLoader.register(directiveName,me)},getItemName:function(){return this.name},getInitData:function(tElement,tAttrs){var data={};return $.isFunction(this.baseOptions.getInitData)&&(data=this.baseOptions.getInitData(tElement,tAttrs)),data.innerHtml=tElement.html(),data},getSidebarItems:function(){},getCompiledHtml:function($compile,$scope,$ui,sidebarItem){var html=$compile(sidebarItem.compileHtml)($scope);return html}})}),define("directives/pdTitle",["angular","directives/directives","directives/pdBinBase","common/utils"],function(angular,directiveModule,BinBase,utils){{var directiveName="pdTitle",PdTitle=BinBase.extend({editorName:"pdTitleEditor",getSidebarItems:function(){return{parentName:"controls",name:this.name,moduleName:this.name,paletteItemHtml:'<div>标注或徽标或简短说明</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<span pd-bin='pdTitle'>Title</span>",sourceCompileHtml:"<span class='label {{:data.labelClass}}'>{{:data.innerHtml}}</span>"}},directiveDef:{priority:0,replace:!0,transclude:!1,restrict:"A",templateUrl:utils.resolveTemplateUrl("title/template.html"),name:this.name,link:function(scope,iElement){iElement.on("blur",function(){scope.$apply(function(){scope.data.innerHtml=iElement.html()})})},controller:function($scope){var initClass=$scope.data.class;_.str.startsWith(initClass,"label ")&&(initClass=_.str.strRight(initClass," ")),$scope.data.labelClass=initClass||$scope.data.labelClass||"label-info",$scope.data=$scope.data||{},$scope.data.editable=!0}}}),pdTitle=new PdTitle(directiveName);directiveModule.directive(pdTitle.name,function(){return pdTitle.directiveDef})}return pdTitle}),define("directives/pdHtml",["angular","directives/directives","common/classLoader","common/utils"],function(angular,directiveModule,classLoader){var directiveName="pdHtml",directiveDef={priority:0,replace:!0,transclude:!1,restrict:"A",dragHelper:"clone"},directive=directiveModule.directive(directiveName,function(){return directiveDef.link=function(){},directiveDef});return classLoader.register(directiveName,directiveDef),directive}),define("directives/metaField",["angular","directives/directives","services/appPd","common/classLoader","common/utils"],function(angular,directiveModule,appConfig,classLoader,utils){var directiveName="pdMetaField",extendAttrs=$.extend({},appConfig.bin.binModuleItemUniqueOptions,{name:directiveName,editorName:"metaFieldEditor",getSidebarItems:function(){var items=[];return $.ajax({url:Global.contextPath+"/html_editor/"+Global.entityName+"/metafield/",async:!1,type:"get",dataType:"json",contentType:"application/json",success:function(data){data||console&&console.log("MetaEntity ["+Global.entityName+"] not exists!"),data&&$.isArray(data)&&$.each(data,function(i,item){var compileHtml=null,sourceCompileHtml=null;"1"==item.type?(compileHtml="<div pd-bin='"+directiveName+"' meta:ref='"+item.dataField+"' placeholder='"+item.label+"'/>",sourceCompileHtml="<input meta:ref='{{:data.metaRef}}'/>"):(compileHtml="<div pd-bin='"+directiveName+"' meta:field='"+item.dataField+"' placeholder='"+item.label+"'/>",sourceCompileHtml="<input meta:field='{{:data.metaField}}'/>"),items.push({unique:!0,parentName:"fields",name:item.dataField,field:item,moduleName:directiveName,paletteItemHtml:'<div class="i-field" data-field-display-name="'+item.label+'" data-field-name="'+item.dataField+'">'+item.label+'</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:compileHtml,sourceCompileHtml:sourceCompileHtml,dropPostProcess:function(newAddItemDom){var $fieldInput=$(newAddItemDom),label=$fieldInput.attr("placeholder"),$thisTd=$fieldInput.parent(),fieldSelector="[pd-bin=pdMetaField]";if(1==$thisTd.length){var $parentLabel=$thisTd.prev("th").find("label");if(0==$parentLabel.length)return void $thisTd.prev("th").append("<label contenteditable='true'>"+label+"</label>");$parentLabel.text()===label&&$parentLabel.text($thisTd.find(fieldSelector).length>0?$($thisTd.find(fieldSelector)[0]).attr("placeholder"):""),0===$thisTd.find(fieldSelector).index($fieldInput)&&$parentLabel.text(label)}}})})}}),items},getItemName:function(iElement){var ele=$(iElement).find("["+_.str.dasherize(directiveName)+"]");0===ele.length&&(ele=$(iElement));var name=ele.attr("meta:field");return name||(name=ele.attr("meta:ref")),name},directiveDef:null});return directiveModule.directive(directiveName,["$http","binManager","sidebarItems",function($http,binManager,sidebarItems){var directiveDef={priority:0,replace:!0,transclude:!1,restrict:"A",templateUrl:utils.resolveTemplateUrl("metafield/template.html"),name:directiveName};return directiveDef.link=function(scope,iElement){var itemName,item;$.isFunction(scope.module.getItemName)&&!iElement.attr("placeholder")&&(itemName=scope.module.getItemName(iElement),item=sidebarItems.getItemInFlat(itemName),item?iElement.attr("placeholder",item.field.label):console&&console.log("Field ["+itemName+"] not exists!"))},directiveDef.controller=function($scope){$scope.data=$scope.data||{}},extendAttrs.directiveDef=directiveDef,directiveDef}]),classLoader.register(directiveName,extendAttrs),extendAttrs}),define("services/relationService",["angular","services/services"],function(angular,serviceModule){var relationService={relationLinks:[]};return $.ajax({url:Global.contextPath+"/html_editor/"+Global.entityName+"/relationlink/",async:!1,type:"get",dataType:"json",contentType:"application/json",success:function(data){data&&$.isArray(data)&&(relationService.relationLinks=data)}}),serviceModule.factory("relationService",[function(){return relationService}]),relationService}),define("directives/metaRelation",["angular","directives/directives","services/appPd","common/classLoader","common/utils","services/relationService"],function(angular,directiveModule,appConfig,classLoader,utils,relationService){var directiveName="pdMetaRelation",extendAttrs=$.extend({},appConfig.bin.binModuleItemUniqueOptions,{name:directiveName,editorName:"metaRelationEditor",getSidebarItems:function(){return{parentName:"relations",name:directiveName,unique:!0,moduleName:directiveName,paletteItemHtml:'<div>自动关系</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div pd-bin='pdMetaRelation'></div>",sourceCompileHtml:"<meta:relation {{if data.model}}model='{{:data.model}}' {{else}}view-container='{{:data.viewContainer}}' {{/if}}exclude-relation-names='{{:data.excludeRelationNames}}'>{{:data.innerHtml}}</meta:relation>"}},getItemName:function(){return directiveName},getInitData:function(tElement,tAttrs){var data=appConfig.bin.binModuleItemUniqueOptions.getInitData(tElement,tAttrs);return data.innerHtml=tElement.html(),data},directiveDef:null});return directiveModule.directive(directiveName,["$http","binManager",function(){var directiveDef={priority:0,replace:!0,restrict:"A",templateUrl:utils.resolveTemplateUrl("metarelation/template.html"),name:directiveName};return directiveDef.link=function(){},directiveDef.controller=function($scope,$element,$attrs){$scope.data=$scope.data||{},$scope.data.excludeRelationNames=$scope.data.excludeRelationNames||"",$scope.data.relationLinks=relationService.relationLinks,$scope.data.inTab=$attrs.hasOwnProperty("model")?!0:!1,$scope.disabled=function(name){var excludeNames=_.str.words($scope.data.excludeRelationNames,","),disabled=!1;return $.each(excludeNames,function(i,v){var value=_.str.trim(v);return value==name?(disabled=!0,!1):void 0}),disabled},$scope.$watch("data.excludeRelationNames",function(newV){var excludeNames=_.str.words(newV,","),disabledClass="i-disabled";$element.find("li").removeClass(disabledClass),$.each(excludeNames,function(i,v){var value=_.str.trim(v);$element.find("li[name="+value+"]").addClass(disabledClass)})})},extendAttrs.directiveDef=directiveDef,directiveDef}]),classLoader.register(directiveName,extendAttrs),extendAttrs}),define("directives/metaFields",["angular","directives/directives","services/appPd","common/classLoader","common/utils"],function(angular,directiveModule,appConfig,classLoader,utils){var directiveName="pdMetaFields",extendAttrs=$.extend({},appConfig.bin.binModuleItemUniqueOptions,{name:directiveName,getSidebarItems:function(){return{parentName:"fields",name:directiveName,unique:!0,moduleName:directiveName,paletteItemHtml:'<div>自动字段</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div pd-bin='pdMetaFields'></div>",sourceCompileHtml:"<meta:fields colNum='{{:data.colNum}}' title='{{:data.title}}'></meta:fields>"}},getItemName:function(){return directiveName},directiveDef:null});return directiveModule.directive(directiveName,["$http","binManager",function(){var directiveDef={priority:0,replace:!0,transclude:!1,restrict:"A",templateUrl:utils.resolveTemplateUrl("metafields/template.html"),name:directiveName};return directiveDef.link=function(){},directiveDef.controller=function($scope){$scope.data=$scope.data||{},$scope.data.colNum=2,$scope.data.title="扩展属性"
},extendAttrs.directiveDef=directiveDef,directiveDef}]),classLoader.register(directiveName,extendAttrs),extendAttrs}),define("directives/metaGrid",["angular","directives/directives","services/appPd","common/classLoader","common/utils","services/relationService"],function(angular,directiveModule,appConfig,classLoader,utils,relationService){var directiveName="pdMetaGrid",extendAttrs=$.extend({},appConfig.bin.binModuleItemUniqueOptions,{name:directiveName,getSidebarItems:function(){var items=[],relationLinks=relationService.relationLinks;return $.each(relationLinks,function(i,item){var compileHtml=null,sourceCompileHtml=null,gridId=item.targetEntityName+"_"+item.relationName,attrs=" entityname='"+item.targetEntityName+"' relation='::"+item.relationName+"' relationdisplayname='"+item.relationDisplayName+"' sourceentity='"+item.sourceEntityName+"' th:attr='ref-"+item.reftoFieldName+'=${entity["'+item.refFieldName+"\"]}' grid-id='"+gridId+"' ",attrsTmpl=" entityname='{{:data.entityname}}' data-relation='{{:data.relation}}' data-sourceentity='{{:data.sourceentity}}' th:attr='{{:data.thAttr}}' relationdisplayname='{{:data.relationdisplayname}}' grid-id='{{:data.gridId}}' ";compileHtml="<div pd-bin='"+directiveName+"'"+attrs+" view='associate'/>",sourceCompileHtml="<meta:grid th:if=\"${action=='EDIT'}\" "+attrsTmpl+"></meta:grid>",items.push({unique:!0,parentName:"relations",name:gridId,moduleName:directiveName,paletteItemHtml:"<div>"+item.relationDisplayName+'</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:compileHtml,sourceCompileHtml:sourceCompileHtml})}),items},getItemName:function(iElement){var ele=$(iElement).find("[grid-id]"),name=ele.attr("grid-id");return name},directiveDef:null});return directiveModule.directive(directiveName,["$http","binManager",function($http){var directiveDef={priority:0,replace:!0,transclude:!1,restrict:"A",templateUrl:utils.resolveTemplateUrl("metagrid/template.html"),name:directiveName};return directiveDef.link=function(){},directiveDef.controller=function($scope){$scope.data=$scope.data||{},$scope.data.gridCols=[];var url=Global.contextPath+"/html_editor/"+Global.entityName+"/relation/"+$scope.data.entityname+"/grid";$http.get(url).success(function(cols){cols&&$.isArray(cols)&&($scope.data.gridCols=cols)})},extendAttrs.directiveDef=directiveDef,directiveDef}]),classLoader.register(directiveName,extendAttrs),extendAttrs}),define("directives/pdLabel",["angular","directives/directives","common/utils","common/classLoader","services/appPd"],function(angular,directiveModule,utils,classLoader,appConfig){{var directiveName="pdLabel",pdLabel=$.extend({},appConfig.bin.binModuleBaseOptions,{name:directiveName,getSidebarItems:function(){return{parentName:"controls",name:directiveName,moduleName:directiveName,paletteItemHtml:'<div>Label</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div pd-label=''>Label</div>",sourceCompileHtml:"<div>{{:data.innerHtml}}</div>"}},directiveDef:{priority:0,replace:!0,transclude:!1,restrict:"A",templateUrl:utils.resolveTemplateUrl("controls/label.html"),name:directiveName,link:function(scope,iElement){iElement.on("blur",function(){scope.$apply(function(){scope.data.innerHtml=iElement.html()})}),iElement.removeAttr("pd-label")},controller:function($scope){$scope.data={},$scope.data.editable=!0,$scope.data.innerHtml="输入label名称"}}});directiveModule.directive(directiveName,function(){return pdLabel.directiveDef})}return classLoader.register(directiveName,pdLabel),pdLabel}),define("directives/uiTab",["angular","directives/directives","common/utils","common/classLoader","services/sidebarItems","services/appPd","services/layoutService","services/templates","services/binManager"],function(angular,directiveModule,utils,classLoader,sidebarItems,appConfig,layoutService){pd.on("focusChanged",function(focusInfo){var ele=$(focusInfo.current);ele.closest("ul").parent("[ui-tab]").length>0&&(focusInfo.frameScope.titlebar={canSetting:!1,canDelete:!1,canDrag:!1})});{var directiveName="uiTab",extendAttrs={name:directiveName,directiveDef:null,getSidebarItems:function(){return{parentName:null,name:directiveName,moduleName:directiveName,paletteItemHtml:'ui-tab<span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div ui-tab></div>",sourcePreprocess:function(element){$(element).removeClass("tabbable tabs-below"),$(element).children("ul").removeClass("nav nav-tabs"),$(element).find(".tab-pane-placeholder").remove()},editorName:"uiTabEditor",postLinkCallback:function(scope,iElement){scope.isBottomTab?(iElement.addClass("tabbable tabs-below"),iElement.children("ul").addClass("nav nav-tabs")):(iElement.addClass("tabbable"),iElement.children("ul").addClass("nav nav-tabs"))}}},getItemName:function(){return directiveName},getCompiledHtml:function($compile,$scope,$ui,sidebarItem){return $compile(sidebarItem.compileHtml)($scope)},paletteItemPostProcess:function(){}};directiveModule.directive(directiveName,["$compile","appConfig","templates","binManager",function($compile,appConfig,templates){var directiveDefinition={name:directiveName,priority:0,scope:!0,restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element){$scope.isBottomTab=$element.hasClass("tabs-bottom")}],compile:function(){return{pre:function(scope,iElement){layoutService.registerLayoutBin(directiveName,scope,iElement)},post:function(scope,iElement,iAttrs,controller){$.isFunction(scope.item.postLinkCallback)&&scope.item.postLinkCallback(scope,iElement,iAttrs,controller);var tabUl=iElement.children("ul"),tabsMap={};scope.addNewTab=function(tabElement,contendDivId,navLi,isUseUrl,useHref){var a=$(navLi).children("a"),aTab=a.data("cid",contendDivId),contentDiv=$(templates.tabContent(contendDivId,isUseUrl));contentDiv.find("input").blur(function(){var href=$(this).val();href&&(a.attr("href",href),useHref||a.attr("th:href","${themes.resolveAppPath('"+href+"')}"))}),tabUl.append(navLi),scope.isBottomTab?$(tabElement).prepend(contentDiv):$(tabElement).append(contentDiv);var tab={a:aTab,contentDiv:contentDiv};tabsMap[contendDivId]=tab},0!==tabUl.length&&(tabUl.find("li>a").each(function(){var a=$(this),href=a.attr("th:href"),useRef=!1;href||(href=a.attr("href"),useRef=!0);var contentDiv=null,contendDivId=href,tab=null;_.str.startsWith(href,"'#")||_.str.startsWith(href,'"#')?(contendDivId=_.str.splice(href,1,1),iElement.children().each(function(){var thId=$(this).attr("th:id");return contendDivId==thId?(contentDiv=$(this),!1):void 0}),a.data("cid",contendDivId),tab={a:a,contentDiv:contentDiv},tabsMap[contendDivId]=tab):_.str.startsWith(href,"#")&&iElement.find(href).length>0?(contendDivId=_.str.splice(href,0,1),contentDiv=iElement.find("#"+contendDivId),a.data("cid",contendDivId),tab={a:a,contentDiv:contentDiv},tabsMap[contendDivId]=tab):(contendDivId=utils.newGuid(),scope.addNewTab(iElement,contendDivId,a.closest("li"),!0,useRef))}),scope.tabsMap=tabsMap,tabUl.on("click","li>a",function(e){e.preventDefault();var a=$(this);if(!(a.closest("._i-wrapper").length>0)){$.each(tabsMap,function(i,tab){tab.contentDiv.hide(),tab.a.parent("li").removeClass("active")});var $contentDiv=tabsMap[a.data("cid")]&&tabsMap[a.data("cid")].contentDiv;if($contentDiv){$contentDiv.show();var href=a.attr("href");$contentDiv.find("[name=href]").val(href),a.parent("li").addClass("active")}}}),tabUl.find("li>a:first").trigger("click"))}}}};return extendAttrs.directiveDef=directiveDefinition,directiveDefinition}])}return classLoader.register(directiveName,extendAttrs),extendAttrs}),define("directives/uiFormToolbar",["angular","directives/directives","common/utils","common/classLoader","services/sidebarItems","services/appPd","services/layoutService","services/templates","services/binManager"],function(angular,directiveModule,utils,classLoader,sidebarItems,appConfig,layoutService){{var directiveName="uiFormToolbar",extendAttrs={name:directiveName,directiveDef:null,getSidebarItems:function(){return{parentName:null,name:directiveName,moduleName:directiveName,paletteItemHtml:'ui-form-toolbar<span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div ui-form-toolbar></div>",sourcePreprocess:function(){},editorName:"uiFormToolbarEditor"}},getItemName:function(){return directiveName},getCompiledHtml:function($compile,$scope,$ui,sidebarItem){return $compile(sidebarItem.compileHtml)($scope)},paletteItemPostProcess:function(){}};directiveModule.directive(directiveName,["$compile","appConfig","templates","binManager",function(){var directiveDefinition={name:directiveName,priority:0,scope:!0,restrict:"A",compile:function(){return{pre:function(scope,iElement){layoutService.registerLayoutBin(directiveName,scope,iElement)},post:function(){}}}};return extendAttrs.directiveDef=directiveDefinition,directiveDefinition}])}return classLoader.register(directiveName,extendAttrs),extendAttrs}),define("directives/metaSlaveTable",["angular","directives/directives","directives/pdBinBase","common/utils","services/relationService"],function(angular,directiveModule,BinBase,utils,relationService){var directiveName="pdMetaSlaveTable",ExtendAttrs=BinBase.extend({editorName:"metaSlaveTableEditor",paletteItemPostProcess:function($el){$el.on("enableDrag",function(){$el.draggable("enable")}),$el.on("disableDrag",function(){$el.draggable("disable")})},getSidebarItems:function(){var items=[],relationLinks=relationService.relationLinks;return $.each(relationLinks,function(i,item){var compileHtml=null,sourceCompileHtml=null,gridId=item.targetEntityName+"_"+item.relationName+"_slave",attrs="pd-bin='"+directiveName+"' grid-id='"+gridId+"' entityname='"+item.targetEntityName+"'";compileHtml="<div "+attrs+" view='associate'/>",sourceCompileHtml="<meta:slave-table "+attrs+' data-options="{{:data.options}}"></meta:slave-table>',items.push({unique:!0,parentName:"relations",name:gridId,moduleName:directiveName,paletteItemHtml:"<div>"+item.relationDisplayName+'从表</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:compileHtml,sourceCompileHtml:sourceCompileHtml})}),items},getItemName:function(iElement){var ele=$(iElement).find("[grid-id]"),name=ele.attr("grid-id");return name},directiveDef:{priority:0,replace:!0,transclude:!1,restrict:"A",templateUrl:utils.resolveTemplateUrl("slavetable/template.html"),name:this.name,link:function(){},controller:function($scope,$element,$attrs,$transclude,$http){$scope.data=$scope.data||{},$scope.data.options=$scope.data.options||"{addTitle:'添加配置',delTitle:'删除',copyTitle:'复制'}",$scope.data.gridCols=[];var url=Global.contextPath+"/html_editor/"+Global.entityName+"/relation/"+$scope.data.entityname+"/grid";$http.get(url).success(function(cols){cols&&$.isArray(cols)&&($scope.data.gridCols=cols)})}}}),extendAttrs=new ExtendAttrs(directiveName);return directiveModule.directive(directiveName,["$http","binManager",function(){return extendAttrs.directiveDef}]),extendAttrs}),define("directives/pdSpecs",["angular","directives/directives","common/utils","common/classLoader","services/appPd","directives/pdBinBase"],function(angular,directiveModule,utils,classLoader,appConfig,BinBase){{var directiveName="pdSpecs",hrBtnText={show:"显示下划线",hide:"隐藏下划线"},h4BtnText={show:"显示标题",hide:"隐藏标题"},classHeader=".spec-header",classDesc=".spec-description",PdSpecs=BinBase.extend({name:directiveName,editorName:"pdSpecsEditor",getItemName:function(){return directiveName},getSidebarItems:function(){return{parentName:"controls",name:directiveName,moduleName:directiveName,paletteItemHtml:'<div>提醒或较长说明</div><span class="i-titlebar-move label"><i class="icon-move"></i>拖动</span>',compileHtml:"<div pd-bin='pdSpecs'><h4 contentEditable='true' class='spec-header' style='display:none;'>请填写标题</h4><hr style='display:none;'/><div class='spec-description' contentEditable='true'>请填写详细说明文字<div></div>",sourceCompileHtml:"<div class='alert {{:data.labelClass}}'>{{:data.innerHtml}}</div>"}},directiveDef:{priority:0,replace:!0,transclude:!1,restrict:"A",templateUrl:utils.resolveTemplateUrl("controls/specs.html"),name:directiveName,link:function(scope,iElement){$(iElement).find(classHeader).on("blur",function(){scope.$apply(function(){scope.data.head=$(iElement).find(classHeader).html(),scope.data.innerHtml=iElement.html()})}),$(iElement).find(classDesc).on("blur",function(){scope.$apply(function(){scope.data.body=$(iElement).find(classDesc).html(),scope.data.innerHtml=iElement.html()})}),scope.$on("toggleHr",function(){scope.data.hrHide=!scope.data.hrHide,scope.data.hrHide?(scope.data.hrBtnText=hrBtnText.show,scope.data.hrStyle={display:"none"}):(scope.data.hrBtnText=hrBtnText.hide,scope.data.hrStyle={display:"block"}),setTimeout(function(){scope.data.innerHtml=iElement.html()},20)}),scope.$on("toggleH4",function(){scope.data.h4Hide=!scope.data.h4Hide,scope.data.h4Hide?(scope.data.h4BtnText=h4BtnText.show,scope.data.h4Style={display:"none"}):(scope.data.h4BtnText=h4BtnText.hide,scope.data.h4Style={display:"block"}),setTimeout(function(){scope.data.innerHtml=iElement.html()},20)}),iElement.removeAttr("pd-specs")},controller:function($scope){$scope.data=$scope.data||{};var initClass=$scope.data.class;_.str.startsWith(initClass,"alert ")&&(initClass=_.str.strRight(initClass," ")),$scope.data.labelClass=initClass||$scope.data.labelClass||"alert-gray",$scope.data.editable=!0;var innerHtml=$scope.data.innerHtml,$wrapper=$("<div>"+innerHtml+"</div>");$scope.data.head=$wrapper.find(classHeader).html(),$scope.data.body=$wrapper.find(classDesc).html();var hrDom=$wrapper.find("hr:eq(0)"),h4Dom=$wrapper.find(classHeader);$scope.data.hrHide=0==hrDom.length?!0:"none"==hrDom.css("display")?!0:!1,$scope.data.h4Hide=0==h4Dom.length?!0:"none"==h4Dom.css("display")?!0:!1,$scope.data.hrHide?($scope.data.hrBtnText=hrBtnText.show,$scope.data.hrStyle={display:"none"}):($scope.data.hrBtnText=hrBtnText.hide,$scope.data.hrStyle={display:"block"}),$scope.data.h4Hide?($scope.data.h4BtnText=h4BtnText.show,$scope.data.h4Style={display:"none"}):($scope.data.h4BtnText=h4BtnText.hide,$scope.data.h4Style={display:"block"})}}}),pdSpecs=new PdSpecs(directiveName);directiveModule.directive(pdSpecs.name,function(){return pdSpecs.directiveDef})}return classLoader.register(directiveName,pdSpecs),pdSpecs}),define("plugins/focusTable",["services/appPd","common/domUtils"],function(pd,domUtils){function addToolBar($scope,iElement){var html="<div class='i-table-titlebar' style='display:none'><div class='i-resize-column active'>	<div class='i-resize-handle'></div>	<div class='i-table-resize-display'></div></div><div class='i-table-titlerow' >	<div class='i-table-move' title='Move Row'></div>	<div class='i-table-delete' title='Delete Row'></div>	<div class='i-table-rowghost' title='rowghost'></div></div><div class='i-table-titlecol'>	<div class='i-table-move' title='Move Column'></div>	<div class='i-table-delete' title='Delete Column'></div>	<div class='i-table-colghost' title='rowghost'></div></div></div>";iElement.append(html)}function selected($scope,iElement,focus){var $table=$(focus.el),rowSize=$("tr",$table).length,colSize=$("tr:eq(0)",$table).children().length,$curTd=null,isDragging=!1,placeHolder=null;$("td,th",$table).off("mouseover").off("mouseout").mouseover(function(){if(!(isDragging||1>=rowSize&&1>=colSize)){var $td=$(this);$curTd=$td,$(".i-titlebar",iElement).hide(),$(".i-table-titlebar",iElement).show(),$td.index()<colSize-1?$(".i-resize-column",iElement).css({left:$td.offset().left-$scope.style.left+$td.outerWidth()-1,top:0,height:$table.outerHeight(),display:"block"}):$(".i-resize-column",iElement).hide(),rowSize>1?($(".i-table-titlerow",iElement).css({top:$td.offset().top-$scope.style.top+12}),$(".i-table-titlerow .i-table-delete",iElement).css({left:$table.width()})):$(".i-table-titlerow",iElement).hide(),colSize>1?$(".i-table-titlecol",iElement).css({left:$td.offset().left-$scope.style.left+$td.width()/2}):$(".i-table-titlecol",iElement).hide()}}).mouseout(function(){isDragging||$(".i-titlebar",iElement).show()}),$(".i-table-titlerow .i-table-delete",iElement).off("click").click(function(){$curTd.parent().remove(),$scope.$apply(function(){$scope.refresh(),$(".i-table-titlebar",iElement).hide()})}),$(".i-table-titlerow",iElement).draggable({axis:"y",handle:".i-table-move",containment:$table,start:function(){isDragging=!0;var rowghost=$(".i-table-titlerow .i-table-rowghost",iElement);rowghost.css({width:$table.width()}),rowghost.show();var placeHolder=$curTd.parent();placeHolder.addClass("i-table-active")},drag:function(event){var prePl=placeHolder;$("tr",$table).each(function(){var $tr=$(this),trOffset=$tr.offset(),trHeight=$tr.height();return event.pageY>trOffset.top-trHeight/2&&event.pageY<trOffset.top+trHeight/2?(placeHolder=$tr,!1):void 0}),prePl!=placeHolder&&(null!=prePl&&prePl.removeClass("i-table-active"),placeHolder.addClass("i-table-active"))},stop:function(){isDragging=!1;var rowghost=$(".i-table-titlerow .i-table-rowghost",iElement);rowghost.css({width:"0px"}),rowghost.hide(),placeHolder.removeClass("i-table-active");var $dragTr=$curTd.parent();placeHolder!=$dragTr&&placeHolder.after($dragTr)}}),$(".i-table-titlecol .i-table-delete",iElement).off("click").click(function(){if(null!=$curTd){var tdIndex=domUtils.getTdIndex($curTd);$("tr",$table).each(function(){var $tr=$(this);domUtils.removeTd($tr,tdIndex)}),$scope.$apply(function(){$scope.refresh()})}}),$(".i-table-titlecol",iElement).draggable({axis:"x",handle:".i-table-move",containment:$table,start:function(){isDragging=!0;var colghost=$(".i-table-titlecol .i-table-colghost",iElement);colghost.css({height:$table.height()}),colghost.show();var placeHolder=$curTd;placeHolder.addClass("i-table-active"),$(".i-titlebar",iElement).hide()},drag:function(event){var prePl=placeHolder;$("tr:eq(0)",$table).children().each(function(i,item){var $td=$(item),tdOffset=$td.offset(),tdWidth=$td.width();return event.pageX>tdOffset.left-5&&event.pageX<tdOffset.left+tdWidth?(placeHolder=$td,!1):void 0}),prePl!=placeHolder&&(null!=prePl&&prePl.removeClass("i-table-active"),placeHolder.addClass("i-table-active"))},stop:function(){isDragging=!1,$(".i-titlebar",iElement).show();var colghost=$(".i-table-titlecol .i-table-colghost",iElement);if(colghost.css({height:"0px"}),colghost.hide(),placeHolder.removeClass("i-table-active"),placeHolder!=$curTd){var plTdIndex=placeHolder.index(),selectTdIndex=$curTd.index();$("tr",$table).each(function(){var plTd=$(this).children()[plTdIndex],selectTd=$(this).children()[selectTdIndex];$(plTd).after(selectTd)})}}}),$(".i-resize-column",iElement).draggable({axis:"x",handle:".i-resize-handle",containment:$table,start:function(){isDragging=!0},stop:function(event,ui){isDragging=!1;var selectTdIndex=$curTd.index(),tdInFirstTr=$($("tr:eq(0)",$table).children()[selectTdIndex]),xDistance=ui.position.left-ui.originalPosition.left;tdInFirstTr.css({width:tdInFirstTr.width()+xDistance})}})}function disSelected($scope,iElement,oldFocus){var $table=$(oldFocus.el);$("td,th",$table).off("mouseover").off("mouseout"),$(".i-table-titlebar",iElement).remove()}function canHandle(focus){if(null==focus||null==focus.el)return!1;var type=focus.type;return"bin"!=focus.type&&"container"!=focus.type&&(type=$(focus.el).prop("tagName").toLowerCase()),"table"==type?!0:!1}pd.on("focusChanged",function(focusInfo){canHandle(focusInfo.pre)&&disSelected(focusInfo.frameScope,focusInfo.frame,focusInfo.pre),canHandle(focusInfo.current)&&(addToolBar(focusInfo.frameScope,focusInfo.frame),selected(focusInfo.frameScope,focusInfo.frame,focusInfo.current))}),pd.on("focusRefreshed",function(focusInfo){canHandle(focusInfo.current)&&selected(focusInfo.frameScope,focusInfo.frame,focusInfo.current)})}),define("directives/toolbar-editors/htmleditor/stateful",["common/eventBase"],function(EventBase){var eState={disabled:-1,enabled:0,checked:1},Stateful=EventBase.extend({state:0,stateClass:"",init:function(){this._super()},hasState:function(st){return this.state==st},setState:function(st){this.state=st,this.stateClass=this.state==eState.checked?"btn-inverse":this.state==eState.disabled?"btn-disabled":""},isChecked:function(){return this.hasState(eState.checked)},setChecked:function(checked){this.isDisabled()||(checked?this.isChecked()||this.setState(eState.checked):this.setState(eState.enabled))},isDisabled:function(){return this.hasState(eState.disabled)},setDisabled:function(disabled){disabled?this.isDisabled()||this.setState(eState.disabled):this.setState(eState.enabled)}});return Stateful}),define("directives/toolbar-editors/htmleditor/itembase",["services/appPd","common/utils","directives/toolbar-editors/htmleditor/stateful"],function(pd,utils,Stateful){var Button=Stateful.extend({id:utils.newGuid(),editor:null,cmdName:null,styleName:"",styleValue:null,label:"",showIcon:!0,showText:!0,itemDom:null,init:function(editor){this._super(),this.editor=editor,this.onFocusChanged()},setValue:function(val){this.styleValue=val},onClick:function(){this.execCommand(),this.editor.trigger("focusChanged",this.editor.focusEl,!0),pd&&pd.refreshFocus()},onFocusChanged:function(){var me=this;me.editor.on("focusChanged",function(){var state=me.queryCommandState();me.setState(state)})},execCommand:function(val){var me=this,$el=me.getFocusEl();return null==$el?null:void(1==this.queryCommandState()?$el.css(me.cmdName,""):$el.css(me.cmdName,val))},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var state=null==$el.css(me.cmdName)?0:1;return state},queryCommandValue:function(cmdName){var me=this,$el=me.getFocusEl();return null==$el?null:(cmdName||(cmdName=me.cmdName),$el.css(cmdName))},getFocusEl:function(){var el=this.editor.focusEl;return null!=el?$(el):null},getDom:function(){return this.itemDom}});return Button}),define("plugins/htmleditor/singleItem",["common/utils","directives/toolbar-editors/htmleditor/itembase"],function(utils,ItemBase){var Button=ItemBase.extend({uiName:"dropdown",init:function(editor){this._super(editor)},execCommand:function(){var me=this,$el=me.getFocusEl();return null==$el?null:void(1==this.queryCommandState()?$el.css(me.styleName,""):$el.css(me.styleName,me.styleValue||me.cmdName))},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var state=$el.css(me.styleName)==(me.styleValue||me.cmdName)?1:0;return state},queryCommandValue:function(){var me=this,$el=me.getFocusEl();return null==$el?null:$el.css(me.styleName)}});return Button}),define("plugins/htmleditor/singleItems",["common/utils","plugins/htmleditor/singleItem","directives/toolbar-editors/htmleditor/editor"],function(utils,SingleItem,editor){var baseStyleItems=[{label:"首行缩进",cmdName:"indent",styleName:"textIndent",styleValue:"2em"},{label:"字体加粗",cmdName:"bold",styleName:"fontWeight",styleValue:"bold"},{label:"斜体",cmdName:"italic",styleName:"fontStyle",styleValue:"italic"},{label:"贯穿线",cmdName:"lineThrough",styleName:"textDecoration",styleValue:"line-through"},{label:"下划线",cmdName:"underline",styleName:"textDecoration",styleValue:"underline"},{label:"左对齐",cmdName:"left",styleName:"textAlign",styleValue:"left"},{label:"居中对齐",cmdName:"center",styleName:"textAlign",styleValue:"center"},{label:"右对齐",cmdName:"right",styleName:"textAlign",styleValue:"right"},{label:"两端对齐",cmdName:"justify",styleName:"textAlign",styleValue:"justify"}];$.each(baseStyleItems,function(index,style){var Item=SingleItem.extend(style);editor.register(Item)})}),define("plugins/htmleditor/listItem",["common/utils","directives/toolbar-editors/htmleditor/itembase"],function(utils,ItemBase){var Button=ItemBase.extend({uiName:"button",valueList:null,init:function(editor){this._super(editor)},getValueText:function(){if(null==this.styleValue)return"";var values=this.styleValue.split(",");return values[0]},execCommand:function(){var me=this,$el=me.getFocusEl();return null==$el?null:void $el.css(me.styleName,me.styleValue||me.cmdName)},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var state=0;return state},queryCommandValue:function(){var me=this,$el=me.getFocusEl();return null==$el?null:$el.css(me.styleName)}});return Button}),define("plugins/htmleditor/listItems",["common/utils","plugins/htmleditor/listItem","directives/toolbar-editors/htmleditor/editor"],function(utils,ListItem,editor){var baseListItems=[{label:"字体名称",cmdName:"fontFamily",styleName:"fontFamily",valueList:["宋体,SimSun","微软雅黑,Microsoft YaHei","楷体,楷体_GB2312, SimKai","黑体, SimHei","隶书, SimLi","andale mono","arial, helvetica,sans-serif","arial black,avant garde","impact,chicago","times new roman"]},{label:"字体尺寸",cmdName:"fontSize",styleName:"fontSize",valueList:["10px","11px","12px","14px","16px","18px","20px","24px","36px"]},{label:"字体颜色",cmdName:"color",styleName:"color",valueList:["#ac725e","#d06b64","#f83a22","#fa573c","#ff7537","#ffad46","#42d692","#16a765","#7bd148","#b3dc6c","#fbe983","#fad165","#92e1c0","#9fe1e7","#9fc6e7","#4986e7","#9a9cff","#b99aff","#c2c2c2","#cabdbf","#cca6ac","#f691b2","#cd74e6","#a47ae2","#444444"]},{label:"行距",cmdName:"lineHeight",styleName:"lineHeight",valueList:["50%","100%","150%","175%","200%","250%","300%"]}];$.each(baseListItems,function(index,style){var Item=ListItem.extend(style);editor.register(Item)})}),define("plugins/htmleditor/tableItems",["services/appPd","common/utils","common/domUtils","directives/toolbar-editors/htmleditor/itembase","directives/toolbar-editors/htmleditor/editor"],function(pd,utils,domUtils,ItemBase,editor){function getTdAttrForInt($el,attrName,defaultValue){var attrValue=$el.attr(attrName)?parseInt($el.attr(attrName)):defaultValue;return attrValue}editor.register(ItemBase.extend({label:"添加列",cmdName:"addColumn",uiName:"column-button",execCommand:function(){var me=this,$el=me.getFocusEl(),tagName=$el.prop("tagName").toLowerCase();"td"==tagName||"th"==tagName?(this.addColumnAfterTd($el),$el.cellPos(!0)):this.addColumnAfterTable($el)},addColumnAfterTd:function($td){var cloneTd=$td.clone().empty(),tdIndex=domUtils.getTdIndex($td);$("tr",$td.closest("table")).each(function(){var $tr=$(this);domUtils.insertTd($tr,tdIndex,cloneTd.clone())})},addColumnAfterTable:function($table){$("tr",$table).append("<td></td>")},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var tagName=$el.prop("tagName").toLowerCase();return"table"==tagName||"td"==tagName||"th"==tagName?0:-1},queryCommandValue:function(){return""}})),editor.register(ItemBase.extend({label:"向下添加行",cmdName:"addRow",uiName:"row-button",execCommand:function(){var me=this,$el=me.getFocusEl(),tagName=$el.prop("tagName").toLowerCase();"td"==tagName||"th"==tagName?(this.addRowAfterTd($el),$el.cellPos(!0)):this.addRowAfterTable($el)},addRowAfterTd:function($td){var cloneTr=$td.parent().clone();$("td,th",cloneTr).empty(),$td.parent().after(cloneTr)},addRowAfterTable:function($table){var lastTr=$("tr:last-child",$table),cloneTr=lastTr.clone();$("td,th",cloneTr).empty(),lastTr.after(cloneTr)},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var tagName=$el.prop("tagName").toLowerCase();return"table"==tagName||"td"==tagName||"th"==tagName?0:-1},queryCommandValue:function(){return""}})),editor.register(ItemBase.extend({label:"向上添加行",cmdName:"addRowUp",uiName:"row-button-up",execCommand:function(){var me=this,$el=me.getFocusEl(),tagName=$el.prop("tagName").toLowerCase();"td"==tagName||"th"==tagName?(this.addRowBeforeTd($el),$el.cellPos(!0)):this.addRowBeforeTable($el)},addRowBeforeTd:function($td){var cloneTr=$td.parent().clone();$("td,th",cloneTr).empty(),$td.parent().before(cloneTr)},addRowBeforeTable:function($table){var firstTr=$("tr:first-child",$table),cloneTr=firstTr.clone();$("td,th",cloneTr).empty(),firstTr.before(cloneTr)},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var tagName=$el.prop("tagName").toLowerCase();return"table"==tagName||"td"==tagName||"th"==tagName?0:-1},queryCommandValue:function(){return""}})),editor.register(ItemBase.extend({label:"向左合并列",cmdName:"mergeLeft",uiName:"merge-left-button",execCommand:function(){var me=this,$el=me.getFocusEl(),colspan=getTdAttrForInt($el,"colspan",1),prevTd=this.getPrevTd($el);null!=prevTd&&($el.attr("colspan",colspan+prevTd.colspan),prevTd.td.remove())},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var tagName=$el.prop("tagName").toLowerCase();if("td"==tagName||"th"==tagName){var prevTd=this.getPrevTd($el);return null==prevTd?-1:0}return-1},queryCommandValue:function(){return""},getPrevTd:function($td){var rowspan=getTdAttrForInt($td,"rowspan",1),prevTd=(getTdAttrForInt($td,"colspan",1),domUtils.getTd($td.parent(),$td.cellPos(!0).left-1));return null==prevTd?null:prevTd.rowspan!=rowspan||prevTd.cellPos.top!=$td.cellPos().top?null:prevTd}})),editor.register(ItemBase.extend({label:"向右合并列",cmdName:"mergeRight",uiName:"merge-right-button",execCommand:function(){var me=this,$el=me.getFocusEl(),colspan=getTdAttrForInt($el,"colspan",1),nextTd=this.getNextTd($el);null!=nextTd&&($el.attr("colspan",colspan+nextTd.colspan),nextTd.td.remove())},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var tagName=$el.prop("tagName").toLowerCase();if("td"==tagName||"th"==tagName){var nextTd=this.getNextTd($el);return null==nextTd?-1:0}return-1},queryCommandValue:function(){return""},getNextTd:function($td){var rowspan=getTdAttrForInt($td,"rowspan",1),colspan=getTdAttrForInt($td,"colspan",1),nextTd=domUtils.getTd($td.parent(),$td.cellPos(!0).left+colspan);return null==nextTd?null:nextTd.rowspan!=rowspan||nextTd.cellPos.top!=$td.cellPos().top?null:nextTd}})),editor.register(ItemBase.extend({label:"向下合并行",cmdName:"mergeDown",uiName:"merge-down-button",execCommand:function(){var me=this,$el=me.getFocusEl(),rowspan=getTdAttrForInt($el,"rowspan",1),nextTd=this.getNextTd($el);null!=nextTd&&($el.attr("rowspan",rowspan+getTdAttrForInt($(nextTd.td),"rowspan",1)),$(nextTd.td).remove())},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var tagName=$el.prop("tagName").toLowerCase();if("td"==tagName||"th"==tagName){var nextTd=this.getNextTd($el);return null==nextTd?-1:0}return-1},queryCommandValue:function(){return""},getNextTd:function($td){for(var rowspan=getTdAttrForInt($td,"rowspan",1),colspan=getTdAttrForInt($td,"colspan",1),nextTr=$td.parent(),i=0;rowspan>i;i++)nextTr=nextTr.next();var nextTd=domUtils.getTd(nextTr,$td.cellPos().left);return null==nextTd?null:nextTd.cellPos.left!=$td.cellPos().left||nextTd.colspan!=colspan?null:nextTd}})),editor.register(ItemBase.extend({label:"拆分单元格",cmdName:"splitCells",uiName:"split-cells-button",execCommand:function(){var me=this,$el=me.getFocusEl(),left=$el.cellPos().left,rowspan=getTdAttrForInt($el,"rowspan",1),colspan=getTdAttrForInt($el,"colspan",1);$el.removeAttr("rowspan").removeAttr("colspan");for(var cloneTd=$el.clone().empty(),emptyTd=cloneTd.clone(),i=1;colspan>i;i++)cloneTd.is("th")?($el.after("<td></td>"),emptyTd.after("<td></td>")):($el.after(cloneTd.clone()),emptyTd.after(cloneTd.clone()));for(var $curTr=$el.parent().next(),row=1;rowspan>row;row++){var selectedTd=null;$("td,th",$curTr).each(function(){var $td=$(this);return $td.cellPos().left<left&&$td.next().length>0&&$td.next().cellPos().left>left?(selectedTd=$td,!1):void 0}),null!=selectedTd?selectedTd.after(emptyTd.clone()):$curTr.prepend(emptyTd.clone()),$curTr=$curTr.next()}},queryCommandState:function(){var me=this,$el=me.getFocusEl();if(null==$el)return-1;var tagName=$el.prop("tagName").toLowerCase();if("td"==tagName||"th"==tagName){var rowspan=getTdAttrForInt($el,"rowspan",1),colspan=getTdAttrForInt($el,"colspan",1);return 1==rowspan&&1==colspan?-1:0}return-1},queryCommandValue:function(){return""}}))}),function(){var heRequire=require.config({paths:{underscore:"lib/underscore-min",usStrings:"lib/underscore-string",angular:"lib/angular",ngResource:"lib/angular-resource",ngAnimate:"lib/angular-animate",ngSanitize:"lib/angular-sanitize",cellPos:"lib/jquery.cellpos"},shim:{usStrings:{exports:"usStrings",deps:["underscore"]},angular:{exports:"angular"},ngResource:{exports:"$resource",deps:["angular"]},ngAnimate:{exports:"ngAnimate",deps:["angular"]},ngSanitize:{exports:"ngSanitize",deps:["angular"]}}});
window.pd=null,define("main",["angular","app","ngAnimate","ngSanitize","usStrings","directives/uiAce","directives/pdFocusFrame","directives/toolbar-editors/pdEditor","directives/pdLayout","directives/pdTable","directives/pdTitle","directives/pdHtml","directives/metaField","directives/metaRelation","directives/metaFields","directives/metaGrid","directives/pdLabel","directives/uiTab","directives/uiFormToolbar","directives/metaSlaveTable","directives/pdSpecs","plugins/focusTable","plugins/htmleditor/singleItems","plugins/htmleditor/listItems","plugins/htmleditor/tableItems"],function(angular,module){angular.bootstrap(document,[module.name]),window.pd.trigger("ready")}),heRequire(["main"])}();